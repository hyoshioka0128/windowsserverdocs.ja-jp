---
title: schtasks
description: 'Windows コマンドに関するトピック * * * *- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 2e713203-3dd8-491b-b9e1-9423618dc7e8
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: fdda956a5da9ec50e44002cd8ab38373396d5713
ms.sourcegitcommit: 0e3c2473a54f915d35687d30d1b4b1ac2bae4068
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/09/2019
ms.locfileid: "68914641"
---
# <a name="schtasks"></a>schtasks



定期的にまたは特定の時刻に実行するには、コマンドとプログラムをスケジュールします。 追加しタスクのスケジュールから削除して、開始しオンデマンドでのタスクを停止してが表示されますおよびスケジュールされたタスクを変更します。

コマンドの構文を表示するには、次のコマンドのいずれかをクリックします。
-   [schtasks 作成](#BKMK_create)
-   [schtasks の変更](#BKMK_change)
-   [schtasks 実行](#BKMK_run)
-   [schtasks 終了](#BKMK_end)
-   [schtasks 削除](#BKMK_delete)
-   [schtasks クエリ](#BKMK_query)

## <a name="remarks"></a>コメント

- **SchTasks.exe** と同じ操作を実行 **タスク** で **コントロール パネルの** します。 まとめてと同じ意味では、これらのツールを使用できます。
- **Schtasks** 置き換えます **At.exe**, 、以前のバージョンの Windows に付属のツールです。 **At.exe** 含まれていますが、Windows Server 2003 ファミリ **schtasks** は、推奨されるコマンド ライン タスク ツールをスケジュールします。
- 内のパラメーター、 **schtasks** コマンドは、任意の順序で使用できます。 入力 **schtasks** せず、すべてのパラメーターがクエリを実行します。
- アクセス許可 **schtasks**  
  -   コマンドを実行するアクセス許可が必要です。 任意のユーザーがローカル コンピューター上でタスクのスケジュールを設定し、表示し、スケジュールされたタスクを変更することができます。 Administrators グループのメンバーは、スケジュールを設定、表示、および、ローカル コンピューター上のすべてのタスクを変更することができます。
  -   スケジュールを設定、表示、またはリモート コンピューター上でタスクを変更するには、リモート コンピューターの Administrators グループのメンバーであるし、使用する必要があります、 **/u** パラメーターをリモート コンピューターの管理者の資格情報を提供します。
  -   使用することができます、 **/u** 内のパラメーター、 **/create** または **変更/** ローカルおよびリモート コンピューターが同じドメインまたはローカル コンピューターがリモート コンピューターのドメインが信頼しているドメインにするときにのみ操作します。 それ以外の場合、リモート コンピューターは、指定したユーザー アカウントを認証できないし、アカウントが Administrators グループのメンバーであることを確認できません。
  -   タスクを実行する権限が必要です。 必要なアクセス許可は、タスクによって異なります。 ローカル コンピューターの現在のユーザーのアクセス許可を持つまたはによって指定されたユーザーのアクセス許可を持つ既定では、タスクを実行、 **/u** パラメーターを 1 つが含まれる場合。 別のユーザー アカウントのアクセス許可を持つ、またはシステム権限を持つタスクを実行するには、 **/ru** パラメーター。
- スケジュールされたタスクが実行されたことを確認またはスケジュールされたタスクが実行されなかった原因を調べるには、タスク スケジューラ サービスのトランザクション ログを参照してください *SystemRoot*\SchedLgU.txt します。 このログ レコードに試行された、サービスを使用するすべてのツールによって開始され実行を含む **タスク** と **SchTasks.exe**します。
- まれに、タスクのファイルが破損します。 破損したタスクは実行されません。 破損したタスクの操作を実行しようとすると **SchTasks.exe** 次のエラー メッセージが表示されます。  
  ```
  ERROR: The data is invalid.
  ```  
  破損したタスクを回復することはできません。 タスクのスケジュール、システムの機能を復元するには使用 **SchTasks.exe** または **タスク** をシステムからタスクを削除し、それらのスケジュールを変更します。

## <a name="BKMK_create"></a>schtasks 作成

タスクをスケジュールします。

**Schtasks** スケジュールの種類ごとに異なるパラメーターの組み合わせを使用します。 タスクを作成するための構文の組み合わせを参照するか、特定のスケジュールの種類でタスクを作成するための構文を表示するには、次のオプションのいずれかをクリックします。
-   [結合された構文とパラメーターの説明](#BKMK_syntax)
-   [N 分ごとに実行するタスクをスケジュールするには](#BKMK_minutes)
-   [N 時間ごとに実行するタスクをスケジュールするには](#BKMK_hours)
-   [N 日ごとに実行するタスクをスケジュールするには](#BKMK_days)
-   [N 週間ごとに実行するタスクをスケジュールするには](#BKMK_weeks)
-   [N か月ごとに実行するタスクをスケジュールするには](#BKMK_months)
-   [特定の曜日に実行されるタスクをスケジュールするには](#BKMK_spec_day)
-   [月の特定の週に実行されるタスクをスケジュールするには](#BKMK_spec_week)
-   [毎月特定の日付に実行されるタスクをスケジュールするには](#BKMK_spec_date)
-   [月の最終日に実行するタスクをスケジュールするには](#BKMK_last_day)
-   [1回実行するタスクをスケジュールするには](#BKMK_once)
-   [システムが起動するたびに実行されるタスクをスケジュールするには](#BKMK_startup)
-   [ユーザーがログオンしたときに実行されるタスクをスケジュールするには](#BKMK_logon)
-   [システムがアイドル状態のときに実行されるタスクをスケジュールするには](#BKMK_idle)
-   [今すぐ実行するタスクをスケジュールするには](#BKMK_now)
-   [別のアクセス許可で実行するタスクをスケジュールするには](#BKMK_diff_perms)
-   [システムのアクセス許可で実行するタスクをスケジュールするには](#BKMK_sys_perms)
-   [複数のプログラムを実行するタスクをスケジュールするには](#BKMK_multi_progs)
-   [リモートコンピューターで実行されるタスクをスケジュールするには](#BKMK_remote)

### <a name="BKMK_syntax"></a>結合された構文とパラメーターの説明

#### <a name="syntax"></a>構文

```
schtasks /create /sc <ScheduleType> /tn <TaskName> /tr <TaskRun> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]] [/ru {[<Domain>\]<User> | System}] [/rp <Password>] [/mo <Modifier>] [/d <Day>[,<Day>...] | *] [/m <Month>[,<Month>...]] [/i <IdleTime>] [/st <StartTime>] [/ri <Interval>] [{/et <EndTime> | /du <Duration>} [/k]] [/sd <StartDate>] [/ed <EndDate>] [/it] [/z] [/f]
```

#### <a name="parameters"></a>パラメーター

##### <a name="sc-scheduletype"></a>/sc \<ScheduleType >

スケジュールの種類を指定します。 有効な値は分、1 時間ごと、毎日、毎週、月単位、ONIDLE、1 回、ONSTART、ログオン時にトリガーします。

|スケジュールの種類|説明|
|-------------|-----------|
|分、時間単位、日、週、月単位|スケジュールの時間単位を指定します。|
|1 回|タスクは、指定した日付と時刻に 1 回実行されます。|
|ONSTART|タスクは、システムが起動するたびに実行されます。 開始日を指定したり、次回のシステムが起動されたときにタスクを実行することができます。|
|ログオン時にトリガー|(すべてのユーザー) のユーザーがログオンするたびに、タスクが実行されます。 日付を指定したり、次に、ユーザーがログオンしたときにタスクを実行することができます。|
|ONIDLE|タスクは、指定した期間、システムがアイドル状態のときに実行されます。 日付を指定したり、次回のシステムがアイドル状態のタスクを実行できます。|

##### <a name="tn-taskname"></a>/tn \<TaskName >

タスクの名前を指定します。 システム上の各タスクは、一意の名前が必要です。 名前では、ファイル名の規則に従う必要があり、領域を 238 文字を超えてはいけません。 スペースが含まれる名前を囲む引用符を使用します。

##### <a name="tr-taskrun"></a>/tr \<TaskRun >

プログラムまたはタスクを実行するコマンドを指定します。 実行可能ファイル、スクリプト ファイルまたはバッチ ファイルの完全修飾パスとファイル名を入力します。 パス名は 262 文字を超えない必要があります。 パスを省略した場合 **schtasks** で、ファイルがあると想定しています、 *SystemRoot*\System32 ディレクトリ。

##### <a name="s-computer"></a>/s \<コンピューター >

指定したリモート コンピューター上でタスクをスケジュールします。 名前または (または円記号なし)、リモート コンピューターの IP アドレスを入力します。 既定はローカル コンピュータです。 **/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。

##### <a name="u-domainuser"></a>/u [\<ドメイン >\]<User>

指定したユーザー アカウントのアクセス許可を持つには、このコマンドを実行します。 既定では、ローカル コンピューターの現在のユーザーのアクセス許可です。 **/U** と **/p** パラメーターは、リモート コンピューター上でタスクをスケジュール設定にのみ有効です ( **/s**)。

指定したアカウントのアクセス許可は、タスクをスケジュールして、タスクの実行に使用されます。 別のユーザーのアクセス許可でタスクを実行するには、 **/ru**パラメーターを使用します。

ユーザー アカウントは、リモート コンピューターの Administrators グループのメンバーである必要があります。 また、ローカル コンピューターでは、リモート コンピューターと同じドメインに存在する必要があります。 または、リモート コンピューターのドメインによって信頼されているドメインに存在する必要があります。

##### <a name="p-password"></a>/p \<パスワード >

指定されたユーザー アカウントのパスワードを提供、 **/u** パラメーター。 使用する場合、 **/u** パラメーターを省略すると、 **/p** パラメーターまたは password 引数 **schtasks** 、パスワードの入力を要求し、入力したテキストが不明になります。

**/U** と **/p** パラメーターは、リモート コンピューター上でタスクをスケジュール設定にのみ有効です ( **/s**)。

##### <a name="ru-domainuser--system"></a>/ru {[\<ドメイン >\] <User> |System

指定したユーザー アカウントのアクセス許可で、タスクを実行します。 既定では、タスクを実行またはによって指定されたユーザーのアクセス許可を持つ、ローカル コンピューターの現在のユーザーのアクセス許可を持つ、 **/u** パラメーターを 1 つが含まれる場合。 **/Ru** パラメーターは、ローカルまたはリモート コンピューター上でタスクをスケジュールする場合に有効です。


|       値        |                                                    説明                                                    |
|--------------------|-------------------------------------------------------------------------------------------------------------------|
| [\<ドメイン >\]<User> |                                       代替のユーザー アカウントを指定します。                                        |
|    システムまたは""    | ローカル システム アカウント、オペレーティング システムおよびシステム サービスによって使用される、高い特権を持つアカウントを指定します。 |

##### <a name="rp-password"></a>/rp \<パスワード >

指定されているユーザー アカウントのパスワードを提供、 **/ru** パラメーター。 ユーザー アカウントを指定する場合、このパラメーターを省略した場合 **SchTasks.exe** 、パスワードの入力を要求し、入力したテキストが不明になります。

使用しないでください、 **/rp** システム アカウントの資格情報で実行するタスクのパラメーター ( **/ru システム**)。 システム アカウントには、パスワードがないと **SchTasks.exe** 1 つのプロンプトが表示されません。

##### <a name="mo-modifier"></a>/mo \<修飾子 >

タスクのスケジュールの種類を実行する頻度を指定します。 このパラメーターは有効ですが、オプションですが、分、時間単位、日、週、および毎月スケジュールを設定します。 既定値は 1 です。

|スケジュールの種類|修飾子の値|説明|
|-------------|---------------|-----------|
|[MINUTE]|1 - 1439|タスクは N > \<分ごとに実行されます。|
|時間単位|1 - 23|タスクは N > \<時間ごとに実行されます。|
|毎日|1 - 365|このタスクは、 \<N > 日ごとに実行されます。|
|毎週|1 - 52|タスクは、N \<> 週ごとに実行されます。|
|1 回|なし|タスクが 1 回実行されます。|
|ONSTART|なし|タスクは、起動時に実行されます。|
|ログオン時にトリガー|なし|タスクを実行して、ユーザーが指定した場合、 **/u** パラメーター ログに記録します。|
|ONIDLE|なし|システムがアイドル状態で指定された時間を分単位の後に、タスクの実行、 **/i** ONIDLE で使用するに必要なパラメーターです。|
|月単位|1 - 12|タスクは、N \<> か月ごとに実行されます。|
|月単位|月末を指定します。|タスクは、月の最終日に実行されます。|
|月単位|最初に、次に、第 3、4 番目に、最終します。|を **/d**\<day > パラメーターと共に使用して、特定の週と日にタスクを実行します。 月の第 3 水曜日にします。|

##### <a name="d-dayday--"></a>/d 日 [, Day...] |*

月の週または 1 日 (または日) の 1 日 (または日) を指定します。 毎週や月単位のスケジュールでのみ有効です。


| スケジュールの種類 |              修飾子              |     日付の値 (/d)      |                                                                                                 説明                                                                                                 |
|---------------|------------------------------------|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    毎週     |               1 - 52               | 月曜 ~ SUN [、月曜 ~ SUN]。 |                                                                                                     \*                                                                                                      |
|    月単位    | 最初に、次に、第 3、4 番目に、最終します。 |        月曜 ~ SUN         |                                                                                   特定の週のスケジュールが必要です。                                                                                    |
|    月単位    |          なし または {1 ~ 12}          |          1 - 31          | 省略可能かつ有効なのは、修飾子を指定しない ( **/mo**) パラメーター (特定の日付のスケジュール) の場合、 \<または **/mo**が 1-12 ("毎月 N > 月数" スケジュール) の場合のみです。 既定では 1 日 1 (月の最初の日です)。 |

##### <a name="m-monthmonth"></a>/m 月 [,... か月]

1 か月またはスケジュールされたタスクを実行する年の月を指定します。 有効な値は、JAN-DEC と * (毎月) です。 **/M** パラメーターは月単位のスケジュールでのみ有効です。 月末を指定する修飾子を使用すると、そのことが必要です。 それ以外の場合は省略可能、既定値は * (毎月)。

##### <a name="i-idletime"></a>/i \<アイドル >

時間を分単位、コンピューターがアイドル状態、タスクが開始される前に指定します。 有効な値は、1 から 999 の整数です。 このパラメーターは、ONIDLE スケジュールでのみ有効ですし、それが必要です。

##### <a name="st-starttime"></a>/st \<StartTime >

タスクを開始する時刻を HH: MM > 24 時間形式で\<指定します (開始するたびに)。 既定値は、ローカル コンピューターの現在の時刻です。 **/St** パラメーターが有効では、1 分に 1 時間ごと、毎日、毎週、月単位、およびスケジュールします。 スケジュールの 2 回必要です。

##### <a name="ri-interval"></a>/ri \<Interval >

繰り返しの間隔を分単位で指定します。 これは、スケジュールの種類には適用されません。MINUTE、毎時、ONSTART、および ONIDLE。 有効な範囲は、1 ~ 599940 分 (599940 分 = 9999 時間) です。 /ET または/DU のいずれかが指定されている場合は、10 分後に繰り返し間隔が既定値です。

##### <a name="et-endtime"></a>/et \<EndTime >

分単位または時間単位のタスクスケジュールの終了時刻を HH \<: MM > 24 時間形式で指定します。 指定した終了時刻より後 **schtasks** を再開しませんタスク開始時刻になるまでです。 既定では、タスクのスケジュールの終了時刻はあるありません。 このパラメーターは、オプションであり、1 分または 1 時間ごとのスケジュールでのみ有効です。

例については、参照してください。
-   「」の「営業時間外に100分ごとに実行されるタスクをスケジュールするには」の「N > \<**分** **ごとに実行するタスクをスケジュールする**には」セクションを参照してください。

##### <a name="du-duration"></a>/du \<継続時間 >

HHHH: MM > 24 時間形式で\<、分または時間単位のスケジュールの最大長を指定します。 指定した時間が経過後 **schtasks** を再開しませんタスク開始時刻になるまでです。 既定では、タスクのスケジュール時間が指定されていない最大です。 このパラメーターは、オプションであり、1 分または 1 時間ごとのスケジュールでのみ有効です。

例については、参照してください。
-   "10 時間に3時間ごとに実行されるタスクをスケジュールするには、[N > \<**時間** **ごとに実行するタスクをスケジュールする**には] セクションを参照してください。

##### <a name="k"></a>/k

指定した時刻にタスクを実行するプログラムを停止 **/et** または **/du**します。 せず **/k**, 、**schtasks** プログラムが起動しない、もう一度で指定された時間に達すると **/et** または **/du**, がまだ実行されている場合、プログラムは停止しません。 このパラメーターは、オプションであり、1 分または 1 時間ごとのスケジュールでのみ有効です。

例については、参照してください。
-   「」の「営業時間外に100分ごとに実行されるタスクをスケジュールするには」の「N > \<**分** **ごとに実行するタスクをスケジュールする**には」セクションを参照してください。

##### <a name="sd-startdate"></a>/sd \<StartDate >

タスクのスケジュールが開始する日付を指定します。 既定値は、ローカル コンピューター上の現在の日付です。 **/Sd** の種類のスケジュールのすべてのパラメーターが有効であり、省略可能です。

形式 *StartDate* でローカル コンピューターの選択したロケールによって異なります **地域と言語のオプション** で **コントロール パネルの** します。 1 つだけの形式では、ロケールごとに有効です。

有効な日付形式は、次の表に一覧表示されます。 選択した形式に最も近い形式を使用して **短い形式** で **地域と言語のオプション** で **コントロール パネルの**  、ローカル コンピューター上です。


|       値       |                                        説明                                         |
|-------------------|--------------------------------------------------------------------------------------------|
| \<MM >/<DD>/<YYYY> | など、月の最初の形式を使用して **英語 (米国)** と **スペイン語 (パナマ)** します。 |
| \<DD >/<MM>/<YYYY> |       など、1 日から始まる形式を使用して **ブルガリア語** と **オランダ語 (オランダ)** します。        |
| \<YYYY >/<MM>/<DD> |          など、年が最初の形式を使用して **スウェーデン語** と **フランス語 (カナダ)** します。          |

/ed \<EndDate >

スケジュールを終了する日付を指定します。 このパラメーターはオプションです。 1 回、ONSTART、ログオン時にトリガー、または ONIDLE スケジュールでは有効ではありません。 既定では、スケジュールの終了日はあるありません。

形式 *EndDate* でローカル コンピューターの選択したロケールによって異なります **地域と言語のオプション** で **コントロール パネルの** します。 1 つだけの形式では、ロケールごとに有効です。

有効な日付形式は、次の表に一覧表示されます。 選択した形式に最も近い形式を使用して **短い形式** で **地域と言語のオプション** で **コントロール パネルの**  、ローカル コンピューター上です。


|       値       |                                        説明                                         |
|-------------------|--------------------------------------------------------------------------------------------|
| \<MM >/<DD>/<YYYY> | など、月の最初の形式を使用して **英語 (米国)** と **スペイン語 (パナマ)** します。 |
| \<DD >/<MM>/<YYYY> |       など、1 日から始まる形式を使用して **ブルガリア語** と **オランダ語 (オランダ)** します。        |
| \<YYYY >/<MM>/<DD> |          など、年が最初の形式を使用して **スウェーデン語** と **フランス語 (カナダ)** します。          |

##### <a name="it"></a>/it

タスクを実行するように指定される場合にのみ「実行」のユーザー (タスクを実行するユーザー アカウント) が、コンピューターにログオンします。 このパラメーターには、システムのアクセス許可で実行しているタスクへの影響はありません。

既定では、「実行」ユーザーは、タスクがスケジュールされているときに、ローカル コンピューターの現在のユーザーで指定されたアカウント、 **/u** パラメーターでは、1 つを使用します。 ただし、コマンドが含まれている場合、 **/ru** パラメーターで指定されたアカウントは、「実行」ユーザー、 **/ru** パラメーター。

例については、参照してください。
-   「 *N* **日ごと**に**実行するタスクをスケジュールする**には」の「ログオンしたときに70日おきに実行されるタスクをスケジュールするには」セクションを参照してください。
-   "特定のユーザーときにのみ、タスクの実行がログオンする"、 **を別のアクセス許可で実行するタスクをスケジュールする** セクションです。

##### <a name="z"></a>/z

スケジュールの終了時のタスクを削除するよう指定します。

##### <a name="f"></a>/f

タスクを作成し、指定したタスクが既に存在する場合に警告を抑制するように指定します。

##### <a name=""></a>/?

コマンド プロンプトにヘルプを表示します。

### <a name="BKMK_minutes"></a>N 分ごとに実行するタスクをスケジュールするには

#### <a name="minute-schedule-syntax"></a>分単位のスケジュールの構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc minute [/mo {1 - 1439}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [{/et <HH:MM> | /du <HHHH:MM>} [/k]] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

分単位のスケジュールで、 **/sc 分** パラメーターは必須です。 **/Mo** (修飾子) パラメーターを省略して、タスクのそれぞれの実行間隔を分単位の数を指定します。 既定値 **/mo** は 1 (1 分ごと)。 **/Et** (終了時刻) と **/du** (期間) パラメーターは省略可能ななしでも使用できる、 **/k** (タスクの終了) パラメーター。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-every-20-minutes"></a>20 分ごとに実行するタスクをスケジュールするのには

次のコマンドは、セキュリティ スクリプト Sec.vbs を 20 分ごとに実行をスケジュールします。 コマンドを使用して、 **/sc** 分単位のスケジュールを指定するパラメーター、および **/mo** 20 分の間隔を指定するパラメーターです。

コマンドに開始する日付または時刻が含まれていないため、タスクは、コマンドが完了し、システムが実行されているときに、その後、20 分ごとに実行した後、20 分を起動します。 セキュリティ スクリプトのソース ファイルがリモート コンピューターに格納されているが、タスクがスケジュールされており、ローカル コンピューターで実行されことに注意してください。
```
schtasks /create /sc minute /mo 20 /tn "Security Script" /tr \\central\data\scripts\sec.vbs
```

#### <a name="to-schedule-a-task-that-runs-every-100-minutes-during-non-business-hours"></a>非営業時間中に 100 分ごとに実行するタスクをスケジュールするのには

次のコマンドはスケジュール セキュリティ スクリプト Sec.vbs を午後 5時 00分の間で 100 分ごとに、ローカル コンピューターで実行するには 午前 7 時 59 1 日です。 コマンドを使用して、 **/sc** 分単位のスケジュールを指定するパラメーター、および **/mo** 100 分の間隔を指定するパラメーターです。 使用して、 **/st** と **/et** 開始時刻と日付ごとのスケジュールの終了時刻を指定するパラメーターです。 使用して、 **/k** 午前 7 時 59 分に実行されている場合は、スクリプトを停止するパラメーター せず **/k**, 、**schtasks** は午前 7 時 59 が午前 6 時 20 分に、インスタンスが開始した後、スクリプトを起動できません。 まだ実行中でないされなくなってしまいます。
```
schtasks /create /tn "Security Script" /tr sec.vbs /sc minute /mo 100 /st 17:00 /et 08:00 /k
```

### <a name="BKMK_hours"></a>N 時間ごとに実行するタスクをスケジュールするには

#### <a name="hourly-schedule-syntax"></a>時間単位のスケジュールの構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc hourly [/mo {1 - 23}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [{/et <HH:MM> | /du <HHHH:MM>} [/k]] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

時間単位のスケジュールで、 **/sc 毎時** パラメーターは必須です。 **/Mo** (修飾子) パラメーターを省略して、タスクのそれぞれの実行間隔の時間数を指定します。 既定値 **/mo** は 1 (1 時間ごと)。 **/K** (タスクの終了) パラメーターは省略可能といずれかと併用して **/et** (指定された時間に終了) または **/du** (指定した間隔後の終了)。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-every-five-hours"></a>5 時間ごとに実行するタスクをスケジュールするのには

次のコマンドは、2002 年 3 月の最初の日から 5 時間ごとに実行する MyApp プログラムをスケジュールします。 使用して、 **/mo** 間隔を指定するパラメーター、および **/sd** 開始日を指定するパラメーターです。 コマンドは、開始時刻を指定しないので、現在の時刻は開始時刻として使用されます。

使用するローカル コンピューターが設定されているため、 **英語 (ジンバブエ)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、開始日の形式は、年/月/日 (03/01/2002)。
```
schtasks /create /sc hourly /mo 5 /sd 03/01/2002 /tn "My App" /tr c:\apps\myapp.exe
```

#### <a name="to-schedule-a-task-that-runs-every-hour-at-five-minutes-past-the-hour"></a>5 分に 1 時間ごとに実行されるタスクのスケジュールを設定する

次のコマンドは、午前 5 分から 1 時間ごとに実行する MyApp プログラムをスケジュールします。 **/Mo** パラメーターを省略すると、コマンドに既定値 (1) 1 時間ごとは、時間単位のスケジュールを使用します。 このコマンドは、午前 12 時 05 分後に実行する場合、プログラムは、次の日までは実行されません。
```
schtasks /create /sc hourly /st 00:05 /tn "My App" /tr c:\apps\myapp.exe
```

#### <a name="to-schedule-a-task-that-runs-every-3-hours-for-10-hours"></a>10 時間 3 時間ごとに実行するタスクをスケジュールするのには

次のコマンドは、MyApp プログラムは 10 時間 3 時間ごとに実行するようにスケジュールします。

コマンドを使用して、 **/sc** 時間単位のスケジュールを指定するパラメーターと **/mo** パラメーターを 3 時間の間隔を指定します。 使用して、 **/st** 午前 0 時に、スケジュールの開始パラメーターと **/du** パラメーターを 10 時間後に、定期的なアイテムを終了します。 わずか数分のプログラムが実行されているため、 **/k** 、期限が切れるときに、実行中の場合は、プログラムを停止する、パラメーターが必要ではありません。
```
schtasks /create /tn "My App" /tr myapp.exe /sc hourly /mo 3 /st 00:00 /du 0010:00
```
この例では、タスクは、午前 3 時の午前 12時 00分に実行されます午前 6 時、午前 9:00。 タスクが午後 12 時 00 分で再び実行されない期間が 10 時間であるため、 代わりに、午前 12時 00分にもう一度開始します。 次の日。

### <a name="BKMK_days"></a>N 日ごとに実行するタスクをスケジュールするには

#### <a name="daily-schedule-syntax"></a>毎日のスケジュールの構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc daily [/mo {1 - 365}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

毎日のスケジュールで、 **/sc 毎日** パラメーターは必須です。 **/Mo** (修飾子) パラメーターを省略して、タスクのそれぞれの実行の間の日数を指定します。 既定値 **/mo** は 1 (毎日) です。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-every-day"></a>毎日実行されるタスクをスケジュールするには

次の例は、午前 8 時 00 分に 1 日 1 回、毎日を実行する MyApp プログラムをスケジュールします。 2002 年 12 月 31 日まで 省略しているので、 **/mo** パラメーター 1 の既定の間隔は毎日コマンドを実行するために使用します。

この例ではローカル コンピューターのシステム設定されているため、 **英語 (英国)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、終了日の形式は、DD/年/日 (2002/31/12)
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc daily /st 08:00 /ed 31/12/2002
```

#### <a name="to-schedule-a-task-that-runs-every-12-days"></a>12 日ごとに実行するタスクをスケジュールするのには

次の例は、午後 1 時 00 分 12 日ごとに実行する MyApp プログラムをスケジュールします。 (13:00)、2002 年 12 月 31 日に開始します。 コマンドを使用して、 **/mo** 2 日の間隔を指定するパラメーター、および **/sd** と **/st** 日付と時刻を指定するパラメーターです。

この例では、システム設定されているため、 **英語 (ジンバブエ)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、終了日の形式は、年/月/日 (2002/12/31)
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc daily /mo 12 /sd 12/31/2002 /st 13:00
```

#### <a name="to-schedule-a-task-that-runs-every-70-days-if-i-am-logged-on"></a>ログオンしている場合は、70 日ごとに実行されるタスクのスケジュールを設定する

次のコマンドでは、セキュリティ スクリプト Sec.vbs を 70 日おきに実行をスケジュールします。 このコマンドは、 **/mo** 70 日の間隔を指定するパラメーターです。 使用して、 **/it** パラメーターをタスクの実行アカウントを持つユーザーがコンピューターにログオンしている場合にのみ、タスクを実行するよう指定します。 ユーザー アカウントのアクセス許可を持つ、タスクで実行されるためは、ログオンしている場合にのみ、タスクは実行されます。
```
schtasks /create /tn "Security Script" /tr sec.vbs /sc daily /mo 70 /it
```

> [!NOTE]
> 対話型専用のタスクを識別するために ( **/it**) プロパティには、詳細なクエリを使用して **(/v クエリ/** )。 タスクの詳細なクエリ画面上で **/it**, 、 **ログオン モード** フィールドの値を持つ **対話型のみ**します。

### <a name="BKMK_weeks"></a>N 週間ごとに実行するタスクをスケジュールするには

#### <a name="weekly-schedule-syntax"></a>週単位スケジュールの構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc weekly [/mo {1 - 52}] [/d {<MON - SUN>[,MON - SUN...] | *}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

毎週のスケジュールで、 **/sc 毎週** パラメーターは必須です。 **/Mo** (修飾子) パラメーターを省略して、タスクのそれぞれの実行までの週の数を指定します。 既定値 **/mo** は 1 (毎週) です。

週単位のスケジュールには 、指定した曜日、またはすべての日 ( *) に実行するタスクをスケジュールするオプションの/d パラメーターもあります。既定値は、MON (月曜日です)。毎日 (* ) オプションは、毎日のタスクをスケジュール設定に相当します。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-every-six-weeks"></a>6 週間ごとに実行するタスクをスケジュールするのには

次のコマンドは、6 週間ごとに、リモート コンピューターで実行する MyApp プログラムをスケジュールします。 このコマンドは、 **/mo** 間隔を指定するパラメーターです。 コマンドを省略しているため、 **/d** パラメーター、毎週月曜日のタスクを実行します。

このコマンドを使用しても、 **/s** リモート コンピューターを指定するパラメーターと **/u** ユーザーの管理者アカウントのアクセス許可を持つコマンドを実行するパラメーターです。 **/P** パラメーターを省略すると、 **SchTasks.exe** 管理者アカウントのパスワードのユーザーに求めます。

また、コマンドをリモートで実行されているため、MyApp.exe へのパスなどのコマンドですべてのパスをリモート コンピューター上のパスを参照してください。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc weekly /mo 6 /s Server16 /u Admin01
```

#### <a name="to-schedule-a-task-that-runs-every-other-week-on-friday"></a>金曜日に隔週で実行するタスクをスケジュールするのには

次のコマンドは、その他の毎週金曜日に実行するタスクをスケジュールします。 使用して、 **/mo** 2 週間の間隔を指定するパラメーター、および **/d** 週の曜日を指定するパラメーターです。 実行するタスクをスケジュールする毎週金曜日省略、 **/mo** パラメーターまたは 1 に設定します。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc weekly /mo 2 /d FRI
```

### <a name="BKMK_months"></a>N か月ごとに実行するタスクをスケジュールするには

#### <a name="syntax"></a>構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly [/mo {1 - 12}] [/d {1 - 31}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

このスケジュールの種類で、 **/sc 毎月** パラメーターは必須です。 **/Mo** タスクのそれぞれの実行の間の月数を指定する (修飾子) パラメーターは省略可能で、既定値は 1 (毎月)。 このスケジュールの種類も省略可能な **/d** 月の指定した日に実行するタスクをスケジュールするパラメーターです。 既定では 1 (月の最初の日です)。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-on-the-first-day-of-every-month"></a>毎月の最初の日に実行するタスクのスケジュールを設定する

次のコマンドは、毎月の最初の日に実行する MyApp プログラムをスケジュールします。 値 1 が両方の既定値であるため、 **/mo** (修飾子) パラメーターと **/d** (日) のパラメーターからのコマンドは、これらのパラメーターを省略しています。
```
schtasks /create /tn "My App" /tr myapp.exe /sc monthly
```

#### <a name="to-schedule-a-task-that-runs-every-three-months"></a>3 か月ごとに実行するタスクをスケジュールするのには

次のコマンドは、MyApp プログラムを 3 か月ごとの実行をスケジュールします。 使用して、 **/mo** パラメーター間隔を指定します。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo 3
```

#### <a name="to-schedule-a-task-that-runs-at-midnight-on-the-21st-day-of-every-other-month"></a>その他の毎月の 21 日の午前 0 時に実行されるタスクをスケジュールするには

次のコマンドは、21 日の午前 0 時に、1 か月で隔月を実行する MyApp プログラムをスケジュールします。 コマンドは、2002 年 7 月 2 日に 2003 年 6 月 30 日から 1 年間に対してこのタスクを実行する必要があることを指定します。

コマンドを使用して、 **/mo** (2 か月ごと)、月単位の間隔を指定するパラメーター、 **/d** 日付を指定するパラメーター、および **/st** の時間を指定します。 使用して、 **/sd** と **/ed** パラメーターを指定します。 を日と終了、それぞれします。 ローカル コンピューターに設定されているため、 **英語 (南アフリカ)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、日付形式で指定された、ローカル、ローカル形式 YYYY/
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo 2 /d 21 /st 00:00 /sd 2002/07/01 /ed 2003/06/30 
```

### <a name="BKMK_spec_day"></a>特定の曜日に実行されるタスクをスケジュールするには

#### <a name="weekly-schedule-syntax"></a>週単位スケジュールの構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc weekly [/d {<MON - SUN>[,MON - SUN...] | *}] [/mo {1 - 52}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

"週の day"のスケジュールは、週単位のスケジュールの一種です。 毎週のスケジュールで、 **/sc 毎週** パラメーターは必須です。 **/Mo** (修飾子) パラメーターを省略して、タスクのそれぞれの実行までの週の数を指定します。 既定値 **/mo** は 1 (毎週) です。 **/D** は省略可能で、パラメーターが指定した曜日、またはすべての日に実行するタスクをスケジュール (\*)。 既定値は、MON (月曜日です)。 すべての日のオプション ( **/d \*** ) は、毎日のタスクをスケジュール設定に相当します。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-every-wednesday"></a>実行するタスクをスケジュールする毎週水曜日

次のコマンドは、MyApp プログラムを毎週を水曜日に実行をスケジュールします。 このコマンドは、 **/d** 週の曜日を指定するパラメーターです。 コマンドを省略しているため、 **/mo** パラメーター、タスクは毎週実行されます。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc weekly /d WED
```

#### <a name="to-schedule-a-task-that-runs-every-eight-weeks-on-monday-and-friday"></a>月曜日と金曜日 8 週間ごとに実行されるタスクのスケジュールを設定する

次のコマンドは、月曜日と 8 番目、毎週の金曜日に実行するタスクをスケジュールします。 使用して、 **/d** 、曜日を指定するパラメーター、および **/mo** 8 週間の間隔を指定するパラメーターです。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc weekly /mo 8 /d MON,FRI
```

### <a name="BKMK_spec_week"></a>月の特定の週に実行されるタスクをスケジュールするには

#### <a name="specific-week-syntax"></a>特定の週の構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly /mo {FIRST | SECOND | THIRD | FOURTH | LAST} /d MON - SUN [/m {JAN - DEC[,JAN - DEC...] | *}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

このスケジュールの種類で、 **/sc 毎月** 、パラメーター、 **/mo** (修飾子) パラメーターと **/d** (日) のパラメーターが必要です。 **/Mo** (修飾子) パラメーターは、タスクを実行する曜日を指定します。 **/D** パラメーターは週の曜日を指定します。 (このスケジュールの種類の週の 1 日だけを指定することができます)。このスケジュールはまた、省略可能なが **/m** することができます (月) パラメーターは、特定の月または毎月のタスクをスケジュール (\*)。 **/M**パラメーターの既定値は、毎月 (\*) です。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-for-the-second-sunday-of-every-month"></a>毎月の第 2 日曜日にタスクをスケジュールするには

次のコマンドは、MyApp プログラムを毎月第 2 日曜日に実行をスケジュールします。 使用して、 **/mo** 月の第 2 週を指定するパラメーター、および **/d** 、日を指定するパラメーターです。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo SECOND /d SUN
```

#### <a name="to-schedule-a-task-for-the-first-monday-in-march-and-september"></a>3 月と年 9 月の最初の月曜日にタスクをスケジュールするには

次のコマンドは、3 月と年 9 月の最初の月曜日に実行する MyApp プログラムをスケジュールします。 使用して、 **/mo** 、月の最初の週を指定するパラメーター、および **/d** 、日を指定するパラメーターです。 使用して **/m** 月引数を区切るコンマを 1 か月を指定するパラメーターです。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo FIRST /d MON /m MAR,SEP
```

### <a name="BKMK_spec_date"></a>毎月特定の日付に実行されるタスクをスケジュールするには

#### <a name="specific-date-syntax"></a>特定の日付の構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly /d {1 - 31} [/m {JAN - DEC[,JAN - DEC...] | *}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

特定の日時のスケジュールの種類で、 **/sc 毎月** パラメーターおよび **/d** (日) のパラメーターが必要です。 **/D** 週の曜日ではない、月 (1 ~ 31) の日付を指定します。 スケジュールでは、1 日だけを指定できます。 **/Mo** (修飾子) のパラメーターがこのスケジュールの種類では無効です。

**/M** (month) パラメーターは、このスケジュールの種類では省略可能であり、既定値は毎月 (<em>) です。 **Schtasks</em>* では、 **/m**パラメーターで指定された月に発生しない日付のタスクをスケジュールすることはできません。 ただし場合、省略、 **/m** パラメーター、およびスケジュール月 31 日、タスクなどのすべての月の間に表示されていない日付のタスクが実行されません。 月の最後の日のタスクをスケジュールするには、最後の日のスケジュールの種類を使用します。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-for-the-first-day-of-every-month"></a>毎月の最初の日にタスクをスケジュールするには

次のコマンドは、毎月の最初の日に実行する MyApp プログラムをスケジュールします。 既定の修飾子は、[なし]\(修飾子なし) であるため、既定の日は、1 日と既定の月は毎月、コマンドでは、その他のパラメーターは必要はありません。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly
```

#### <a name="to-schedule-a-task-for-the-15th-days-of-may-and-june"></a>月と年 6 月 15 日間のタスクをスケジュールするには

次のコマンドは、5 月 15 日と年 6 月 15 日午後 3 時に実行する MyApp プログラムをスケジュールします。 (15:00)。 使用して、 **/m** 、日付を指定するパラメーター、および **/m** 月を指定するパラメーターです。 使用して、 **/st** 開始時刻を指定するパラメーターです。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /d 15 /m MAY,JUN /st 15:00
```

### <a name="BKMK_last_day"></a>月の最終日に実行するタスクをスケジュールするには

#### <a name="last-day-syntax"></a>最後の日の構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly /mo LASTDAY /m {JAN - DEC[,JAN - DEC...] | *} [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

最後の日のスケジュールの種類で、 **/sc 毎月** パラメーター、 **/mo 月末を指定する** (修飾子) パラメーターと **/m** (月) のパラメーターが必要です。 **/D** (日) のパラメーターが無効です。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-for-the-last-day-of-every-month"></a>毎月の最終日にタスクをスケジュールするには

次のコマンドは、すべての月の最終日に実行する MyApp プログラムをスケジュールします。 使用して、 **/mo** 最後の日を指定するパラメーター、および **/m** パラメーターにワイルドカード文字 (*)、プログラムがすべての月を実行するように指定します。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo lastday /m *
```

#### <a name="to-schedule-a-task-at-600-pm-on-the-last-days-of-february-and-march"></a>午後 6 時にタスクをスケジュールするには 2 月と年 3 月の最後の日

次のコマンドは、午後 6時 00分時年 2 月の最後の日と 3 月の最後の日に実行する MyApp プログラムをスケジュールします。 使用して、 **/mo** 最後の日を指定するパラメーター、 **/m** 月を指定するパラメーター、および **/st** 開始時刻を指定するパラメーターです。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo lastday /m FEB,MAR /st 18:00
```

### <a name="BKMK_once"></a>1回実行するタスクをスケジュールするには

#### <a name="syntax"></a>構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc once /st <HH:MM> [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

一度だけ実行スケジュールの種類で、 **/sc 回** パラメーターは必須です。 **/St** タスクを実行する時間を指定するパラメーターが必要です。 **/Sd** タスクを実行する日付を指定するパラメーターは省略可能です。 **/Mo** (修飾子) と **/ed** (終了日) のパラメーターがこのスケジュールの種類に対して無効です。

**Schtasks** に指定された日時が、過去にある場合、1 回実行するタスクをスケジュールすることはできません、ローカル コンピューターの時間に基づいています。 別のタイム ゾーンにあるリモート コンピューターに 1 回実行するタスクをスケジュールする必要がありますスケジュールを設定する日付より前にし、時間が、ローカル コンピューターで発生します。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-one-time"></a>1 回実行するタスクをスケジュールするには

次のコマンドは、2003 年 1 月 1 日の午前 0 時に実行する MyApp プログラムをスケジュールします。 使用して、 **/sc** スケジュールの種類を指定するパラメーター、および **/sd** と **st** 日付と時刻を指定します。

ローカル コンピューターを使用するため、 **英語 (米国)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、開始日の形式は、年/月/日です。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc once /sd 01/01/2003 /st 00:00
```

### <a name="BKMK_startup"></a>システムが起動するたびに実行されるタスクをスケジュールするには

#### <a name="syntax"></a>構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc onstart [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

開始のスケジュールの種類で、 **/sc onstart** パラメーターは必須です。 **/Sd** (開始日) パラメーターは省略可能で、既定値は、現在の日付です。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-when-the-system-starts"></a>システムの起動時に実行されるタスクをスケジュールするには

次のコマンドは、2001年3月15日以降、システムが起動するたびに実行する MyApp プログラムをスケジュールします。

ローカル コンピューターが使用しているため、 **英語 (米国)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、開始日の形式は、年/月/日です。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc onstart /sd 03/15/2001
```

### <a name="BKMK_logon"></a>ユーザーがログオンしたときに実行されるタスクをスケジュールするには

#### <a name="syntax"></a>構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc onlogon [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

「ログオン」スケジュールの種類は、すべてのユーザーがコンピューターにログオンするたびに実行されるタスクをスケジュールします。 「ログオン」スケジュールの種類で、 **/sc ログオン時にトリガー** パラメーターは必須です。 **/Sd** (開始日) パラメーターは省略可能で、既定値は、現在の日付です。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-when-a-user-logs-on-to-a-remote-computer"></a>ユーザーのときに実行されるタスクをスケジュールするにはリモート コンピューターにログオンします。

次のコマンドは、ユーザー (すべてのユーザー) がリモート コンピューターにログオンするたびに実行するバッチ ファイルをスケジュールします。 使用して、 **/s** パラメーターをリモート コンピューターを指定します。 コマンドは、リモートであるため、コマンドをバッチ ファイルへのパスなどのすべてのパスをリモート コンピューター上のパスを参照してください。
```
schtasks /create /tn "Start Web Site" /tr c:\myiis\webstart.bat /sc onlogon /s Server23
```

### <a name="BKMK_idle"></a>システムがアイドル状態のときに実行されるタスクをスケジュールするには

#### <a name="syntax"></a>構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc onidle /i {1 - 999} [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>コメント

「アイドル時」スケジュールの種類で指定された期間中にユーザーのアクティビティがないときに実行されるタスクをスケジュールする、 **/i** パラメーター。 「アイドル時」スケジュールでの種類、 **/sc onidle** パラメーターおよび **/i** パラメーターが必要です。 **/Sd** (開始日) は省略可能で、既定値は、現在の日付です。

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-whenever-the-computer-is-idle"></a>コンピューターがアイドル状態のときに実行されるタスクのスケジュールを設定する

次のコマンドは、MyApp プログラムをコンピューターがアイドル状態のときの実行をスケジュールします。 使用して、必要な **/i** パラメーターをコンピューターをタスクが開始される前に 10 分間アイドル状態維持する必要がありますを指定します。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc onidle /i 10
```

### <a name="BKMK_now"></a>今すぐ実行するタスクをスケジュールするには

**Schtasks** はありませんが、「実行したようになりました」オプションを 1 回実行し、数分後に開始するタスクを作成することでそのオプションをシミュレートすることができます。

#### <a name="syntax"></a>構文

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc once [/st <HH:MM>] /sd <MM/DD/YYYY> [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="examples"></a>使用例

#### <a name="to-schedule-a-task-that-runs-a-few-minutes-from-now"></a>タスクのスケジュールは、今から数分間を実行します。

次のコマンドは、2002 年 11 月 13 日午後 2時 18分で 1 回実行するタスクをスケジュールします。 現地時間。

ローカル コンピューターが使用しているため、 **英語 (米国)** オプション **地域と言語のオプション** で **コントロール パネルの** , 、開始日の形式は、年/月/日です。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc once /st 14:18 /sd 11/13/2002
```

### <a name="BKMK_diff_perms"></a>別のアクセス許可で実行するタスクをスケジュールするには

ローカルとリモート コンピューターの両方で、別のアカウントの権限で実行するあらゆる種類のタスクをスケジュールすることができます。 特定のスケジュールの種類に必要なパラメーターだけでなく、 **/ru** パラメーターは必須、 **/rp** パラメーターは省略可能です。

#### <a name="examples"></a>使用例

#### <a name="to-run-a-task-with-administrator-permissions-on-the-local-computer"></a>ローカル コンピューターの管理者権限を持つタスクを実行するには

次のコマンドは、ローカル コンピューター上で実行する MyApp プログラムをスケジュールします。 使用して、 **/ru** をユーザーの管理者アカウント (Admin06) のアクセス許可でタスクを実行しないことを指定します。 この例では、毎週火曜日に実行するタスクがスケジュールされているが、代替アクセス許可で実行するタスクについて、スケジュールの種類を使用することができます。
```
schtasks /create /tn "My App" /tr myapp.exe /sc weekly /d TUE /ru Admin06
```
これに対して、 **SchTasks.exe** Admin06 アカウント「実行」パスワードの入力を要求し、成功メッセージを表示します。
```
Please enter the run as password for Admin06: ********
SUCCESS: The scheduled task "My App" has successfully been created.
```

#### <a name="to-run-a-task-with-alternate-permissions-on-a-remote-computer"></a>リモート コンピューター上の別のアクセス許可を持つタスクを実行するには

次のコマンドは、4 日ごと Marketing コンピューター上で実行する MyApp プログラムをスケジュールします。

コマンドを使用して、 **/sc** 毎日のスケジュールを指定するパラメーターと **/mo** パラメーター 4 日間の間隔を指定します。

コマンドを使用して、 **/s** リモート コンピューターの名前を指定するパラメーター、および **/u** をリモート コンピューター上でタスクをスケジュールするアクセス許可を持つアカウントを指定するパラメーター (マーケティング コンピューター上の Admin01)。 使用して、 **/ru** ユーザーの管理者以外のアカウントのアクセス許可でタスクを実行しないことを指定するパラメーター (User01 Reskits ドメイン)。 なし、 **/ru** パラメーターで指定されたアカウントのアクセス許可でタスクが実行は **/u**します。
```
schtasks /create /tn "My App" /tr myapp.exe /sc daily /mo 4 /s Marketing /u Marketing\Admin01 /ru Reskits\User01
```
**Schtasks** 最初でという名前のユーザーのパスワードを要求、 **/u** パラメーター (コマンドを実行) をによってという名前のユーザーのパスワードを要求し、 **/ru** (タスクの実行) するパラメーターです。 パスワードを認証した後 **schtasks** タスクをスケジュールすることを示すメッセージが表示されます。
```
Type the password for Marketing\Admin01:********

Please enter the run as password for Reskits\User01: ********

SUCCESS: The scheduled task "My App" has successfully been created.
```

#### <a name="to-run-a-task-only-when-a-particular-user-is-logged-on"></a>ログオンする場合のみ、特定のユーザー タスクの実行

次のコマンドは、コンピューターの管理者がログオンした場合、毎週金曜日の午前 4時 00分、だけを公共のコンピューターで実行する AdminCheck.exe プログラムをスケジュールします。

コマンドを使用して、 **/sc** 毎週のスケジュールを指定するパラメーター、 **/d** 、日を指定するパラメーター、および **/st** 開始時刻を指定するパラメーターです。

コマンドを使用して、 **/s** リモート コンピューターの名前を指定するパラメーターと **/u** パラメーターをリモート コンピューター上でタスクのスケジュールを設定する権限を持つアカウントを指定します。 使用して、 **/ru** 公共のコンピューター (Public\Admin01) の管理者の権限で実行するタスクを構成するためパラメーターおよび **/it** Public\Admin01 アカウントがログオンしているときにのみ、タスクを実行するように指定するパラメーターです。
```
schtasks /create /tn "Check Admin" /tr AdminCheck.exe /sc weekly /d FRI /st 04:00 /s Public /u Domain3\Admin06 /ru Public\Admin01 /it
```
**注:**
-   対話型専用のタスクを識別するために ( **/it**) プロパティには、詳細なクエリを使用して **(/v クエリ/** )。 タスクの詳細なクエリ画面上で **/it**, 、 **ログオン モード** フィールドの値を持つ **対話型のみ**します。

### <a name="BKMK_sys_perms"></a>システムのアクセス許可で実行するタスクをスケジュールするには

あらゆる種類のタスクは、システム アカウントのアクセス許可を持つ、ローカルとリモート コンピューターの両方で実行できます。 特定のスケジュールの種類に必要なパラメーターだけでなく、 **/ru システム** (または **/ru""** ) パラメーターは必須、 **/rp** パラメーターが無効です。

**重要**
-   システム アカウントには、対話型ログオン権限がありません。 ユーザーできませんを参照してくださいプログラムとの対話またはシステム権限を持つタスクを実行します。
-   **/Ru** パラメーターは、タスクが実行するタスクをスケジュールするためのアクセス許可しないアクセス許可を決定します。 管理者の値に関係なく、タスクをスケジュールしてのみ、 **/ru** パラメーター。

**注:**

システムのアクセス許可で実行するタスクを特定するには、詳細クエリ ( **/query** **/v**) を使用します。 システムの実行タスクの詳細なクエリ画面では、 **ユーザーとして実行** フィールドの値を持つ **NT authority \system** と **ログオン モード** フィールドの値を持つ **だけバック グラウンド**します。

#### <a name="examples"></a>使用例

#### <a name="to-run-a-task-with-system-permissions"></a>システムのアクセス許可を持つタスクを実行するには

次のコマンドは、システム アカウントのアクセス許可を持つローカル コンピューター上で実行する MyApp プログラムをスケジュールします。 この例では、毎月の第 15 日に実行するタスクがスケジュールされているが、システムのアクセス許可で実行するタスクにどの種類のスケジュールを使用することができます。

このコマンドは、 **/ru システム** システムのセキュリティ コンテキストを指定するパラメーターです。 システム タスクは、パスワードを使用しないため、 **/rp** パラメーターを省略するとします。
```
schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /d 15 /ru System
```
これに対して、 **SchTasks.exe** 情報メッセージと、成功メッセージが表示されます。 パスワードのプロンプトは表示されません。
```
INFO: The task will be created under user name ("NT AUTHORITY\SYSTEM").
SUCCESS: The Scheduled task "My App" has successfully been created.
```

#### <a name="to-run-a-task-with-system-permissions-on-a-remote-computer"></a>リモート コンピューター上のシステム権限を持つタスクを実行するには

次のコマンドは、午前 4 時に毎朝 Finance01 コンピューター上で実行する MyApp プログラムをスケジュールします。 システムのアクセス許可。

コマンドを使用して、 **/tn** タスクに名前をパラメーターと **/tr** MyApp プログラムのリモート コピーを指定するパラメーターです。 使用して、 **/sc** いますが、毎日のスケジュールを指定するパラメーター、 **/mo** パラメーター 1 (毎日) が既定値であるためです。 使用して、 **/st** タスクは毎日実行するときにも、された開始時刻を指定するパラメーターです。

コマンドを使用して、 **/s** リモート コンピューターの名前を指定するパラメーターと **/u** パラメーターをリモート コンピューター上でタスクのスケジュールを設定する権限を持つアカウントを指定します。 使用して、 **/ru** パラメーターをタスクをシステム アカウントで実行されていることを指定します。 なし、 **/ru** パラメーターで指定されたアカウントのアクセス許可でタスクが実行は **/u**します。
```
schtasks /create /tn "My App" /tr myapp.exe /sc daily /st 04:00 /s Finance01 /u Admin01 /ru System
```
**Schtasks** によってという名前のユーザーのパスワードを要求、 **/u** パラメーターと、パスワードを認証した後、タスクが作成されることで、システム アカウントのアクセス許可で実行されることを示すメッセージが表示されます。
```
Type the password for Admin01:**********

INFO: The Schedule Task "My App" will be created under user name ("NT AUTHORITY\
SYSTEM").
SUCCESS: The scheduled task "My App" has successfully been created.
```

### <a name="BKMK_multi_progs"></a>複数のプログラムを実行するタスクをスケジュールするには

各タスクは、1 つだけのプログラムを実行します。 ただし、複数のプログラムを実行するバッチ ファイルを作成して、バッチ ファイルを実行するタスクをスケジュールすることができます。 次の手順では、この方法を示します。
1. 実行するプログラムを起動するバッチ ファイルを作成します。

   この例では、イベント ビューアー (Eventvwr.exe) とシステム モニター (Perfmon.exe) を起動するバッチ ファイルを作成します。  
   - メモ帳などのテキスト エディターを開きます。
   - 各プログラムの実行可能ファイルの完全修飾パスと名前を入力します。 この場合、ファイルには、次のステートメントが含まれます。  
     ```
     C:\Windows\System32\Eventvwr.exe 
     C:\Windows\System32\Perfmon.exe
     ```  
   - MyApps.bat として保存します。
2. 使用 **Schtasks.exe** MyApps.bat を実行するタスクを作成します。

   次のコマンドでは、すべてのユーザーがログオンするたびに実行されるモニターのタスクを作成します。 使用して、 **/tn** タスクには、名前のパラメーターと **/tr** MyApps.bat を実行するパラメーターです。 使用して、 **/sc** ログオン時にトリガー スケジュールの種類を示すためにパラメーターおよび **/ru** ユーザーの管理者アカウントのアクセス許可を持つタスクを実行するパラメーターです。  
   ```
   schtasks /create /tn Monitor /tr C:\MyApps.bat /sc onlogon /ru Reskit\Administrator
   ```  
   このコマンドの結果としてユーザーが、コンピューターにログオンするたびにすると、タスクはイベント ビューアーとシステム モニターを起動します。

### <a name="BKMK_remote"></a>リモートコンピューターで実行されるタスクをスケジュールするには

リモート コンピューター上で実行するタスクをスケジュールするには、リモート コンピューターのスケジュールをタスクを追加する必要があります。 リモート コンピューターには、あらゆる種類のタスクをスケジュールすることができますが、次の条件を満たす必要があります。
-   タスクをスケジュールするアクセス許可が必要です。 そのため、リモート コンピューターの Administrators グループのメンバーであるアカウントを使用してローカル コンピューターにログオンする必要がありますか、使用する必要があります、 **/u** パラメーターをリモート コンピューターの管理者の資格情報を提供します。
-   使用することができます、 **/u** パラメーターは、ローカルおよびリモート コンピューターが同じドメインまたはローカル コンピューターがリモート コンピューターのドメインが信頼しているドメインにしている場合にのみです。 それ以外の場合、リモート コンピューターは、指定したユーザー アカウントを認証できないし、アカウントが Administrators グループのメンバーであることを確認できません。
-   タスクをリモート コンピューターで実行するための十分なアクセス許可が必要です。 必要なアクセス許可は、タスクによって異なります。 既定では、タスクの実行、ローカル コンピューターの現在のユーザーのアクセス許可を持つ場合は、 **/u** パラメーターを使用すると、タスクの実行で指定されたアカウントのアクセス許可を持つ、 **/u** パラメーター。 ただし、使用することができます、 **/ru** またはシステム権限を持つ別のユーザー アカウントのアクセス許可を持つタスクを実行するパラメーターです。

#### <a name="examples"></a>使用例

#### <a name="an-administrator-schedules-a-task-on-a-remote-computer"></a>管理者がリモート コンピューター上でタスクをスケジュール設定します。

次のコマンドは、すぐに開始 10 日ごと、SRV01 リモート コンピューター上で実行する MyApp プログラムをスケジュールします。 コマンドを使用して、 **/s** パラメーターをリモート コンピューターの名前を指定します。 ローカルの現在のユーザーがリモート コンピューターの管理者であるため、 **/u** タスクをスケジュールするための代替アクセス許可を提供するパラメーターは必要ありません。

リモート コンピューター上でタスクをスケジュールする場合にすべてのパラメーターを参照しているリモート コンピューターに注意してください。 指定された結果、実行可能ファイル、 **/tr** パラメーターは、リモート コンピューター上の MyApp.exe のコピーを指します。
```
schtasks /create /s SRV01 /tn "My App" /tr "c:\program files\corpapps\myapp.exe" /sc daily /mo 10
```
これに対して、 **schtasks** タスクをスケジュールすることを示す成功メッセージが表示されます。

#### <a name="a-user-schedules-a-command-on-a-remote-computer-case-1"></a>ユーザーがリモート コンピューター (ケース 1) でのコマンドをスケジュールします。

次のコマンドは、MyApp プログラムごとに SRV06 リモート コンピューターで 3 時間ごとに実行するようにスケジュールします。 コマンドを使用してタスクをスケジュールする、管理者のアクセス許可が必要なため、 **/u** と **/p** アカウント (Reskits ドメイン内の Admin01) のユーザーの管理者の資格情報を提供するパラメーターです。 既定では、これらのアクセス許可は、タスクの実行にも使用します。 ただし、タスクに実行する管理者のアクセス許可が必要がないので、このコマンドは、 **/u** と **/rp** パラメーターを既定値をオーバーライドし、ユーザーの管理者以外のアカウントのアクセス許可を持つリモート コンピューターでタスクを実行します。
```
schtasks /create /s SRV06 /tn "My App" /tr "c:\program files\corpapps\myapp.exe" /sc hourly /mo 3 /u reskits\admin01 /p R43253@4$ /ru SRV06\user03 /rp MyFav!!Pswd
```
これに対して、 **schtasks** タスクをスケジュールすることを示す成功メッセージが表示されます。

#### <a name="a-user-schedules-a-command-on-a-remote-computer-case-2"></a>ユーザーがリモート コンピューター (ケース 2) でのコマンドをスケジュールします。

次のコマンドは、すべての月の最終日に SRV02 のリモート コンピューターで実行する MyApp プログラムをスケジュールします。 ローカル (user03) 現在のユーザーがリモート コンピューターの管理者でないため、コマンドを使用して、 **/u** アカウント (Reskits ドメイン内の Admin01) のユーザーの管理者の資格情報を提供するパラメーターです。 タスクをスケジュールして、タスクを実行する管理者アカウントのアクセス許可が使用されます。
```
schtasks /create /s SRV02 /tn "My App" /tr "c:\program files\corpapps\myapp.exe" /sc monthly /mo LASTDAY /m * /u reskits\admin01
```
コマンドが含まれていないため、 **/p** (パスワード) パラメーター **schtasks** パスワードを入力するように求められます。 成功メッセージを表示し、この場合は、警告が表示されます。
```
Type the password for reskits\admin01:********

SUCCESS: The scheduled task "My App" has successfully been created.

WARNING: The Scheduled task "My App" has been created, but may not run because
the account information could not be set.
```
この警告は、リモート ドメインがで指定されたアカウントを認証できなかったことを示して、 **/u** パラメーター。 この場合は、ローカルのコンピューターがリモート コンピューターのドメインが信頼するドメインのメンバーではないために、リモート ドメインは、ユーザー アカウントを認証できませんでした。 この場合、タスクのジョブがスケジュールされたタスクの一覧に表示されますが、タスクが実際には空とは実行されません。

詳細なクエリから次の表示では、タスクの問題を公開します。 画面のことに注意しての値 **次回の実行時刻** は **しない** の値 **ユーザーとして実行** は **タスク スケジューラのデータベースから取得できませんでした**します。

このコンピューターは、同じドメインまたは信頼されたドメインのメンバーをされていた、タスクがスケジュールされましたし、実行した場合に指定します。
```
HostName: SRV44
TaskName: My App
Next Run Time: Never
Status:
Logon mode: Interactive/Background
Last Run Time: Never
Last Result: 0
Creator: user03
Schedule: At 3:52 PM on day 31 of every month, start
 starting 12/14/2001
Task To Run: c:\program files\corpapps\myapp.exe
Start In: myapp.exe
Comment: N/A
Scheduled Task State: Disabled
Scheduled Type: Monthly
Start Time: 3:52:00 PM
Start Date: 12/14/2001
End Date: N/A
Days: 31
Months: JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NO
V,DEC
Run As User: Could not be retrieved from the task sched
uler database
Delete Task If Not Rescheduled: Enabled
Stop Task If Runs X Hours and X Mins: 72:0
Repeat: Every: Disabled
Repeat: Until: Time: Disabled
Repeat: Until: Duration: Disabled
Repeat: Stop If Still Running: Disabled
Idle Time: Disabled
Power Management: Disabled
```

#### <a name="remarks"></a>コメント

-   実行する、 **/create** コマンドを使用して、別のユーザーのアクセス許可を持つ、 **/u** パラメーター。 **/U** パラメーターは、リモート コンピューター上のタスクのスケジューリングにのみ有効です。
-   詳細を表示する **schtasks/create** 例として、型 **schtasks/create/でしょうか。** コマンド プロンプト。
-   別のユーザーのアクセス許可で実行するタスクをスケジュールするには、使用、 **/ru** パラメーター。 **/Ru** パラメーターはローカルおよびリモート コンピューター上のタスクに対して有効です。
-   使用する、 **/u** パラメーター、ローカル コンピューターがリモート コンピューターと同じドメインに存在する必要がありますまたはリモート コンピューターのドメインが信頼しているドメインに存在する必要があります。 それ以外の場合、タスクは作成されず、またはタスクのジョブは空で、タスクが実行されません。
-   **Schtasks** 指定しない限り、現在のユーザー アカウントを使用してローカル コンピューター上でタスクをスケジュールする際にも、パスワードが常に要求します。 これは、通常の動作の **schtasks**します。
-   **Schtasks** プログラム ファイルの場所やユーザー アカウントのパスワードは検証されません。 ファイルの場所や、正しいパスワードがユーザー アカウント用に入力しない場合、タスクが作成されるは実行されません。 また、アカウントのパスワードの変更や期限切れになったタスクの保存されているパスワードを変更しない場合、タスクは実行されません。
-   システム アカウントには、対話型ログオン権限がありません。 ユーザーは、表示されないと、システムのアクセス許可で実行するプログラムとの対話ことはできません。
-   各タスクは、1 つだけのプログラムを実行します。 ただし、複数のタスクを開始するバッチ ファイルを作成して、その後、バッチ ファイルを実行するタスクをスケジュールします。
-   作成するとすぐにタスクをテストすることができます。 使用して、 **実行** タスクをテストし、その SchedLgU.txt ファイルをチェックインする操作 (*SystemRoot*\SchedLgU.txt) のエラーです。

## <a name="BKMK_change"></a>schtasks の変更

1 つ以上のタスクの次のプロパティを変更します。
-   タスクを実行するプログラム ( **/tr**)。
-   タスクを実行するユーザー アカウント ( **/ru**)。
-   ユーザー アカウントのパスワード ( **/rp**)。
-   対話型のみのプロパティをタスクに追加されます ( **/it**)。

### <a name="syntax"></a>構文

```
schtasks /change /tn <TaskName> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]] [/ru {[<Domain>\]<User> | System}] [/rp <Password>] [/tr <TaskRun>] [/st <StartTime>] [/ri <Interval>] [{/et <EndTime> | /du <Duration>} [/k]] [/sd <StartDate>] [/ed <EndDate>] [/{ENABLE | DISABLE}] [/it] [/z]
```

### <a name="parameters"></a>パラメーター

|          用語           |                                                                                                                                                                                                                                                                                                                                     定義                                                                                                                                                                                                                                                                                                                                      |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     /tn \<TaskName >     |                                                                                                                                                                                                                                                                                                               変更するタスクを識別します。 タスク名を入力します。                                                                                                                                                                                                                                                                                                               |
|     /s \<コンピューター >      |                                                                                                                                                                                                                                                                               (または円記号なし) の名前またはリモート コンピューターの IP アドレスを指定します。 既定はローカル コンピュータです。                                                                                                                                                                                                                                                                               |
|  /u [\<ドメイン >\]<User>  |                                                                                                                                                                 指定したユーザー アカウントのアクセス許可を持つには、このコマンドを実行します。 既定では、ローカル コンピューターの現在のユーザーのアクセス許可です。 指定したユーザー アカウントは、リモート コンピューターの Administrators グループのメンバーである必要があります。 **/U** と **/p** パラメーターは、リモート コンピューター上でタスクを変更する場合のみ有効です ( **/s**)。                                                                                                                                                                  |
|     /p \<パスワード >      |                                                                                                                                                                                              指定されたユーザー アカウントのパスワードを指定、 **/u** パラメーター。 使用する場合、 **/u** パラメーターを省略すると、 **/p** パラメーターまたは password 引数 **schtasks** パスワードの入力を求めます。</br>**/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。                                                                                                                                                                                               |
| /ru {[\<ドメイン >\]<User> |                                                                                                                                                                                                                                                                                                                                       System                                                                                                                                                                                                                                                                                                                                       |
|     /rp \<パスワード >     |                                                                                                                                                                                                                                                 既存のユーザー アカウントまたは指定したユーザー アカウントの新しいパスワードを指定します、 **/ru** パラメーター。 このパラメーターは、ローカル システム アカウントで使用すると無視されます。                                                                                                                                                                                                                                                  |
|     /tr \<TaskRun >      |                                                                                                                                                                                  タスクを実行するプログラムを変更します。 実行可能ファイル、スクリプト ファイルまたはバッチ ファイルの完全修飾パスとファイル名を入力します。 パスを省略した場合、 **schtasks**は、ファイルが\<systemroot > \ System32 ディレクトリにあると想定します。 指定したプログラムには、タスクによって実行元のプログラムが置き換えられます。                                                                                                                                                                                  |
|    /st \<Starttime >     |                                                                                                                                                                                                                                                              24 時間形式、HH:mm を使用して、タスクの開始時刻を指定します。 たとえば、14時 30分の値は、12 時間制の午後 2 時 30 分に相当します。                                                                                                                                                                                                                                                               |
|     /ri \<Interval >     |                                                                                                                                                                                                                                                                           スケジュールされたタスクの繰り返し間隔を分単位で指定します。 有効な範囲は、1-599940 (599940 分 = 9999 時間) です。                                                                                                                                                                                                                                                                            |
|     /et \<EndTime >      |                                                                                                                                                                                                                                                               24 時間形式、HH:mm を使用して、タスクの終了時刻を指定します。 たとえば、14時 30分の値は、12 時間制の午後 2 時 30 分に相当します。                                                                                                                                                                                                                                                                |
|     /du \<継続時間 >     |                                                                                                                                                                                                                                                                                                     \<EndTime > または<Duration>(指定されている場合) でタスクを終了するように指定します。                                                                                                                                                                                                                                                                                                      |
|           /k            |                                                                                                                                                                   指定した時刻にタスクを実行するプログラムを停止 **/et** または **/du**します。 せず **/k**, 、**schtasks** プログラムが起動しない、もう一度で指定された時間に達すると **/et** または **/du**, がまだ実行されている場合、プログラムは停止しません。 このパラメーターは、オプションであり、1 分または 1 時間ごとのスケジュールでのみ有効です。                                                                                                                                                                   |
|    /sd \<StartDate >     |                                                                                                                                                                                                                                                                                              タスクを実行する最初の日付を指定します。 日付形式は、年/月/日です。                                                                                                                                                                                                                                                                                               |
|     /ed \<EndDate >      |                                                                                                                                                                                                                                                                                                 タスクを実行する最後の日付を指定します。 形式は、年/月/日です。                                                                                                                                                                                                                                                                                                  |
|         または有効にします。         |                                                                                                                                                                                                                                                                                                                       スケジュールされたタスクを有効にするように指定します。                                                                                                                                                                                                                                                                                                                       |
|        /無効にします。         |                                                                                                                                                                                                                                                                                                                      スケジュールされたタスクを無効にするように指定します。                                                                                                                                                                                                                                                                                                                       |
|           /it           | スケジュールされたタスクを実行するように指定される場合にのみ「実行」のユーザー (タスクを実行するユーザー アカウント) が、コンピューターにログオンします。</br>このパラメーターには、システムのアクセス許可で実行するタスクまたは対話型のみプロパティが設定されているタスクへの影響はありません。 変更コマンドを使用して、タスクから対話型専用のプロパティを削除できません。</br>既定では、「実行」ユーザーは、タスクがスケジュールされているときに、ローカル コンピューターの現在のユーザーで指定されたアカウント、 **/u** パラメーターでは、1 つを使用します。 ただし、コマンドが含まれている場合、 **/ru** パラメーターで指定されたアカウントは、「実行」ユーザー、 **/ru** パラメーター。 |
|           /z            |                                                                                                                                                                                                                                                                                                          スケジュールの終了時のタスクを削除するよう指定します。                                                                                                                                                                                                                                                                                                          |
|           /?            |                                                                                                                                                                                                                                                                                                                        コマンド プロンプトにヘルプを表示します。                                                                                                                                                                                                                                                                                                                         |

### <a name="remarks"></a>コメント

-   **/Tn** と **/s** パラメーターは、タスクを指定します。 **/Tr**, 、 **/ru**, 、および **/rp** 変更可能なタスクのプロパティをパラメーターで指定します。
-   **/Ru**, 、および **/rp** パラメーターは、タスクを実行するアクセス許可を指定します。 **/U** と **/p** パラメーターは、タスクを変更するためのアクセス許可を指定します。
-   リモート コンピューター上でタスクを変更するには、ユーザーをリモート コンピューターの Administrators グループのメンバーであるアカウントを使用してローカル コンピューターにログオンする必要があります。
-   実行する、 **変更/** 別のユーザーのアクセス許可を持つコマンド ( **/u**, 、 **/p**)、ローカル コンピューターがリモート コンピューターと同じドメインに存在する必要があります、またはリモート コンピューターのドメインが信頼しているドメインに存在する必要があります。
-   システム アカウントには、対話型ログオン権限がありません。 ユーザーは、表示されないと、システムのアクセス許可で実行するプログラムとの対話ことはできません。
-   使用してタスクを識別するために、 **/it** プロパティには、詳細なクエリを使用して ( **/v クエリ/** )。 タスクの詳細なクエリ画面上で **/it**, 、 **ログオン モード** フィールドの値を持つ **対話型のみ**します。

### <a name="examples"></a>使用例

### <a name="to-change-the-program-that-a-task-runs"></a>タスクを実行するプログラムを変更するには

次のコマンドは、VirusCheck2.exe に VirusCheck.exe からウイルスをチェック タスクを実行するプログラムを変更します。 このコマンドを使用して、 **/tn** タスクを識別するためにパラメーターおよび **/tr** タスク用の新しいプログラムを指定するパラメーターです。 (タスク名を変更することはできません)。
```
schtasks /change /tn "Virus Check" /tr C:\VirusCheck2.exe
```
これに対して、 **SchTasks.exe** 次の成功メッセージが表示されます。
```
SUCCESS: The parameters of the scheduled task "Virus Check" have been changed.
```
ウイルスをチェック タスクには、次のコマンドの結果として VirusCheck2.exe が実行されています。

### <a name="to-change-the-password-for-a-remote-task"></a>リモート タスクのパスワードを変更するには

次のコマンドは、リモート コンピューターの Svr01 の RemindMe タスクのユーザー アカウントのパスワードを変更します。 コマンドを使用して、 **/tn** タスクを識別するためにパラメーターおよび **/s** パラメーターをリモート コンピューターを指定します。 この例では、 **/rp**パラメーターを使用してp@ssWord3、新しいパスワードを指定しています。

ユーザー アカウントのパスワードの有効期限が切れるまたは変更されるたびに、この手順が必要です。 タスクに保存されているパスワードが有効でなくなった場合、タスクは実行されません。
```
schtasks /change /tn RemindMe /s Svr01 /rp p@ssWord3
```
これに対して、 **SchTasks.exe** 次の成功メッセージが表示されます。
```
SUCCESS: The parameters of the scheduled task "RemindMe" have been changed.
```
RemindMe タスクこのコマンドの結果として、元のユーザー アカウントでは、新しいパスワードを使用してが今すぐ実行します。

### <a name="to-change-the-program-and-user-account-for-a-task"></a>タスクのプログラムとユーザー アカウントを変更するには

次のコマンドは、タスクを実行するプログラムとユーザーがタスクを実行するアカウントを変更を変更します。 基本的には、新しいタスクを古いスケジュールを使用します。 このコマンドは、代わりに Internet Explorer を起動する午前 9 時に毎朝 Notepad.exe を起動する ChkNews タスクを変更します。

コマンドを使用して、 **/tn** パラメーターのタスクを識別します。 使用して、 **/tr** タスクを実行するプログラムを変更するパラメーター、および **/ru** にタスクを実行するユーザー アカウントを変更するパラメーターです。

**/Ru**, 、および **/rp** ユーザー アカウントのパスワードを提供するパラメーターを省略するとします。 アカウントのパスワードを指定する必要がありますが、使用することができます、 **/ru**, と **/rp** パラメーターと型は、パスワードのクリア テキストでの待機 **SchTasks.exe** 、パスワードの入力を求め、隠ぺいされたテキストでパスワードを入力しています。
```
schtasks /change /tn ChkNews /tr "c:\program files\Internet Explorer\iexplore.exe" /ru DomainX\Admin01
```
これに対して、 **SchTasks.exe** ユーザー アカウントのパスワードを要求します。 パスワードが表示されていないため、テキストを入力すると、わかりにくきます。
```
Please enter the password for DomainX\Admin01: 
```
注意してください、 **/tn** パラメーターと、タスクを識別する、 **/tr** と **/ru** パラメーターは、タスクのプロパティを変更します。 タスクを識別するために別のパラメーターを使用することはできませんし、タスク名を変更することはできません。

これに対して、 **SchTasks.exe** 次の成功メッセージが表示されます。
```
SUCCESS: The parameters of the scheduled task "ChkNews" have been changed.
```
ChkNews タスクで、このコマンドの結果として、管理者アカウントのアクセス許可を持つ Internet Explorer が実行されます。

### <a name="to-change-a-program-to-the-system-account"></a>システム アカウントにプログラムを変更するには

次のコマンドは、システム アカウントのアクセス許可で実行されるように、SecurityScript タスクを変更します。 使用して、 **/ru""** システム アカウントを示します。
```
schtasks /change /tn SecurityScript /ru ""
```
これに対して、 **SchTasks.exe** 次の成功メッセージが表示されます。
```
INFO: The run as user name for the scheduled task "SecurityScript" will be changed to "NT AUTHORITY\SYSTEM".
SUCCESS: The parameters of the scheduled task "SecurityScript" have been changed.
```
システム アカウントのアクセス許可で実行されるタスクには、パスワードが必要ないため **SchTasks.exe** 1 つのプロンプトが表示されません。

### <a name="to-run-a-program-only-when-i-am-logged-on"></a>ログオンしている場合にのみ、プログラムを実行するには

次のコマンドは、MyApp の場合は、既存のタスクに対話型専用のプロパティを追加します。 このプロパティにより、コンピューターにタスクを実行するユーザー アカウントは、「実行」ユーザーがログオンしているときにのみタスクを実行します。

コマンドを使用して、 **/tn** タスクを識別するためにパラメーターおよび **/it** タスクに対話型専用のプロパティを追加するパラメーターです。 ユーザー アカウントのアクセス許可を持つタスクが既に実行されているために、変更は必要はありません、 **/ru** タスクのパラメーターです。
```
schtasks /change /tn MyApp /it
```
これに対して、 **SchTasks.exe** 次の成功メッセージが表示されます。
```
SUCCESS: The parameters of the scheduled task "MyApp" have been changed.
```

## <a name="BKMK_run"></a>schtasks 実行

スケジュールされたタスクを直ちに開始します。 **実行** 操作は、スケジュールは無視されますが、すぐにタスクを実行するプログラム ファイルの場所、ユーザー アカウントおよびタスクに保存されているパスワードを使用します。

### <a name="syntax"></a>構文

```
schtasks /run /tn <TaskName> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

### <a name="parameters"></a>パラメーター

|         用語          |                                                                                                                                                                 定義                                                                                                                                                                  |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    /tn \<TaskName >    |                                                                                                                                                       必須。 タスクを識別します。                                                                                                                                                        |
|    /s \<コンピューター >     |                                                                                                           (または円記号なし) の名前またはリモート コンピューターの IP アドレスを指定します。 既定はローカル コンピュータです。                                                                                                           |
| /u [\<ドメイン >\]<User> | 指定したユーザー アカウントのアクセス許可を持つには、このコマンドを実行します。 既定では、コマンドは、ローカル コンピューターの現在のユーザーの権限で実行されます。</br>指定したユーザー アカウントは、リモート コンピューターの Administrators グループのメンバーである必要があります。 **/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。 |
|    /p \<パスワード >     |                          指定されたユーザー アカウントのパスワードを指定、 **/u** パラメーター。 使用する場合、 **/u** パラメーターを省略すると、 **/p** パラメーターまたは password 引数 **schtasks** パスワードの入力を求めます。</br>**/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。                           |
|          /?           |                                                                                                                                                    コマンド プロンプトにヘルプを表示します。                                                                                                                                                     |

### <a name="remarks"></a>コメント

-   この操作を使用すると、タスクをテストできます。 タスクが実行されない場合は、タスクスケジューラサービスのトランザクションログ\<Systemroot > \SchedLgU.txt にエラーがないかどうかを確認します。
-   タスクを実行するタスクのスケジュールは影響しないため、タスクのスケジュールされた次回の実行を変更することはできません。
-   リモートでのタスクを実行するには、リモート コンピューターでタスクをスケジュールする必要があります。 を実行すると、タスクは、リモート コンピューター上でのみ実行されます。 タスクがリモートコンピューター上で実行されていることを確認するには、タスクマネージャーまた\<はタスクスケジューラトランザクションログの Systemroot > \schedlgu.txt を使用します。

### <a name="examples"></a>使用例

### <a name="to-run-a-task-on-the-local-computer"></a>ローカル コンピューターでタスクを実行するには

次のコマンドは、「セキュリティ スクリプト」タスクを開始します。
```
schtasks /run /tn "Security Script"
```
これに対して、 **SchTasks.exe** は、タスクに関連付けられているスクリプトを起動し、次のメッセージが表示されます。
```
SUCCESS: Attempted to run the scheduled task "Security Script".
```
メッセージは、次のとおり、 **schtasks** 試行が、プログラムを開始することはできません非常にプログラムが実際に開始します。

### <a name="to-run-a-task-on-a-remote-computer"></a>リモート コンピューターでタスクを実行するには

次のコマンドは、リモート コンピューター Svr01 の更新タスクを起動します。
```
schtasks /run /tn Update /s Svr01
```
この場合、 **SchTasks.exe** 次のエラー メッセージが表示されます。
```
ERROR: Unable to run the scheduled task "Update".
```
エラーの原因を見つけるには、スケジュールされたタスクのトランザクション ログ、Svr01 上 C:\Windows\SchedLgU.txt ないか調べます。 ここでは、次のエントリがログに表示されます。
```
"Update.job" (update.exe) 3/26/2001 1:15:46 PM ** ERROR **
The attempt to log on to the account associated with the task failed, therefore, the task did not run.
The specific error is:
0x8007052e: Logon failure: unknown user name or bad password.
Verify that the task's Run-as name and password are valid and try again.
```
どうやらこれは、ユーザー名またはパスワード、タスクではないシステムで有効です。 次 **schtasks/change** コマンドは、ユーザー名と Svr01 の更新タスクのパスワードを更新します。
```
schtasks /change /tn Update /s Svr01 /ru Administrator /rp PassW@rd3
```
後に、 **変更** コマンドが完了、 **実行** コマンドが繰り返されます。 このとき、Update.exe プログラムが起動し、 **SchTasks.exe** 次のメッセージが表示されます。
```
SUCCESS: Attempted to run the scheduled task "Update".
```
メッセージは、次のとおり、 **schtasks** 試行が、プログラムを開始することはできません非常にプログラムが実際に開始します。

## <a name="BKMK_end"></a>schtasks 終了

タスクによって起動されたプログラムを停止します。

### <a name="syntax"></a>構文

```
schtasks /end /tn <TaskName> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

### <a name="parameters"></a>パラメーター

|         用語          |                                                                                                                                                               定義                                                                                                                                                                |
|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    /tn \<TaskName >    |                                                                                                                                         必須。 プログラムを起動したタスクを識別します。                                                                                                                                         |
|    /s \<コンピューター >     |                                                                                                                        名前またはリモート コンピューターの IP アドレスを指定します。 既定はローカル コンピュータです。                                                                                                                        |
| /u [\<ドメイン >\]<User> | 指定したユーザー アカウントのアクセス許可を持つには、このコマンドを実行します。 既定では、コマンドは、ローカル コンピューターの現在のユーザーの権限で実行されます。 指定したユーザー アカウントは、リモート コンピューターの Administrators グループのメンバーである必要があります。 **/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。 |
|    /p \<パスワード >     |                        指定されたユーザー アカウントのパスワードを指定、 **/u** パラメーター。 使用する場合、 **/u** パラメーターを省略すると、 **/p** パラメーターまたは password 引数 **schtasks** パスワードの入力を求めます。</br>**/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。                         |
|          /?           |                                                                                                                                                             ヘルプを表示します。                                                                                                                                                              |

### <a name="remarks"></a>コメント

**SchTasks.exe** 、スケジュールされたタスクによって起動されたプログラムのインスタンスのみを終了します。 その他のプロセスを停止するには、TaskKill を使用します。 詳細については、次を参照してください。 [Taskkill](taskkill.md)します。

### <a name="examples"></a>使用例

### <a name="to-end-a-task-on-a-local-computer"></a>ローカル コンピューター上でタスクを終了するには

次のコマンドは、My Notepad タスクによって開始された Notepad.exe のインスタンスを停止します。
```
schtasks /end /tn "My Notepad"
```
これに対して、 **SchTasks.exe** タスクを開始し、次の成功メッセージが表示されます、Notepad.exe のインスタンスを停止します。
```
SUCCESS: The scheduled task "My Notepad" has been terminated successfully.
```

### <a name="to-end-a-task-on-a-remote-computer"></a>リモート コンピューター上でタスクを終了するには

次のコマンドは、リモート コンピュータ、Svr01 InternetOn タスクによって開始された Internet Explorer のインスタンスを停止します。
```
schtasks /end /tn InternetOn /s Svr01
```
これに対して、 **SchTasks.exe** タスクを開始し、次の成功メッセージが表示されます、Internet Explorer のインスタンスを停止します。
```
SUCCESS: The scheduled task "InternetOn" has been terminated successfully.
```

## <a name="BKMK_delete"></a>schtasks 削除

スケジュールされたタスクを削除します。

### <a name="syntax"></a>構文

```
schtasks /delete /tn {<TaskName> | *} [/f] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

### <a name="parameters"></a>パラメーター

|         用語          |                                                                                                                                                                 定義                                                                                                                                                                  |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|   /tn {\<TaskName >    |                                                                                                                                                                     \*}                                                                                                                                                                     |
|          /f           |                                                                                                                                  確認メッセージを抑制します。 タスクは警告なしに削除されます。                                                                                                                                  |
|    /s \<コンピューター >     |                                                                                                           (または円記号なし) の名前またはリモート コンピューターの IP アドレスを指定します。 既定はローカル コンピュータです。                                                                                                           |
| /u [\<ドメイン >\]<User> | 指定したユーザー アカウントのアクセス許可を持つには、このコマンドを実行します。 既定では、コマンドは、ローカル コンピューターの現在のユーザーの権限で実行されます。</br>指定したユーザー アカウントは、リモート コンピューターの Administrators グループのメンバーである必要があります。 **/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。 |
|    /p \<パスワード >     |                          指定されたユーザー アカウントのパスワードを指定、 **/u** パラメーター。 使用する場合、 **/u** パラメーターを省略すると、 **/p** パラメーターまたは password 引数 **schtasks** パスワードの入力を求めます。</br>**/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。                           |
|          /?           |                                                                                                                                                    コマンド プロンプトにヘルプを表示します。                                                                                                                                                     |

### <a name="remarks"></a>コメント

- **削除** 操作は、スケジュールからタスクを削除します。 いないタスクを実行するプログラムを削除したり、実行中のプログラムを中断しません。
- **Delete\\** * コマンドは、現在のユーザーによってスケジュールされたタスクだけでなく、そのコンピュータに対してスケジュールされているすべてのタスクを削除します。

### <a name="examples"></a>使用例

### <a name="to-delete-a-task-from-the-schedule-of-a-remote-computer"></a>リモート コンピューターのスケジュールからタスクを削除するには

次のコマンドは、リモート コンピューターのスケジュールから"Start Mail"タスクを削除します。 使用して、 **/s** をリモート コンピューターを識別するパラメーターです。
```
schtasks /delete /tn "Start Mail" /s Svr16
```
これに対して、 **SchTasks.exe** 次の確認メッセージが表示されます。 タスクを削除するには、Y キーを押します。<strong>します。</strong>コマンドを取り消す場合に、次のように入力します **n**:。
```
WARNING: Are you sure you want to remove the task "Start Mail" (Y/N )? 
SUCCESS: The scheduled task "Start Mail" was successfully deleted.
```

### <a name="to-delete-all-tasks-scheduled-for-the-local-computer"></a>ローカル コンピューターのスケジュールされたすべてのタスクを削除するには

次のコマンドは、他のユーザーがスケジュールされたタスクを含めて、ローカル コンピューターのスケジュールからすべてのタスクを削除します。 この例では、 **/tn \\** * パラメーターを使用してコンピューター上のすべてのタスクを表し、 **/f**パラメーターを使用して確認メッセージが表示されないようにしています。
```
schtasks /delete /tn * /f
```
これに対して、 **SchTasks.exe** SecureScript、スケジュールされているタスクだけを削除することを示す次の成功メッセージが表示されます。

`SUCCESS: The scheduled task "SecureScript" was successfully deleted.`

## <a name="BKMK_query"></a>schtasks クエリ

コンピューター上で実行するスケジュールされたタスクを表示します。

### <a name="syntax"></a>構文

```
schtasks [/query] [/fo {TABLE | LIST | CSV}] [/nh] [/v] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

### <a name="parameters"></a>パラメーター

|         用語          |                                                                                                                                                                 定義                                                                                                                                                                  |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|       [/query]        |                                                                                                                        操作名は省略できます。 入力 **schtasks** せず、すべてのパラメーターがクエリを実行します。                                                                                                                         |
|      /fo {テーブル       |                                                                                                                                                                    表                                                                                                                                                                     |
|          /nh          |                                                                                                            テーブルの表示から列見出しを省略します。 このパラメーターは有効であり、 **テーブル** と **CSV** 形式を出力します。                                                                                                             |
|          /v           |                                                                                                         表示するには、タスクの高度なプロパティを追加します。</br>使用してクエリ **/v** として書式設定する必要があります **リスト** または **CSV**します。                                                                                                          |
|    /s \<コンピューター >     |                                                                                                           (または円記号なし) の名前またはリモート コンピューターの IP アドレスを指定します。 既定はローカル コンピュータです。                                                                                                           |
| /u [\<ドメイン >\]<User> | 指定したユーザー アカウントのアクセス許可を持つには、このコマンドを実行します。 既定では、コマンドは、ローカル コンピューターの現在のユーザーの権限で実行されます。</br>指定したユーザー アカウントは、リモート コンピューターの Administrators グループのメンバーである必要があります。 **/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。 |
|    /p \<パスワード >     |                                        指定されたユーザー アカウントのパスワードを指定、 **/u** パラメーター。 使用する場合 **/u**, を省略すると **/p** または password 引数 **schtasks** パスワードが求められます。</br>**/U** と **/p** パラメーターが有効に使用する場合のみ **/s**します。                                         |
|          /?           |                                                                                                                                                    コマンド プロンプトにヘルプを表示します。                                                                                                                                                     |

### <a name="remarks"></a>コメント

**SchTasks.exe** 、スケジュールされたタスクによって起動されたプログラムのインスタンスのみを終了します。 その他のプロセスを停止するには、TaskKill を使用します。 詳細については、次を参照してください。 [Taskkill](taskkill.md)します。

### <a name="examples"></a>使用例

### <a name="to-display-the-scheduled-tasks-on-the-local-computer"></a>ローカル コンピューターでスケジュールされたタスクを表示するには

次のコマンドは、ローカル コンピューターのスケジュールされたすべてのタスクを表示します。 これらのコマンドは、結果は同じされ、同じ意味で使用できます。
```
schtasks
schtasks /query
```
これに対して、 **SchTasks.exe** 既定では、単純な表形式では、次の表に示すようにタスクが表示されます。
```
TaskName Next Run Time Status
========================= ======================== ==============
Microsoft Outlook At logon time
SecureScript 14:42:00 PM , 2/4/2001
```

### <a name="to-display-advanced-properties-of-scheduled-tasks"></a>スケジュールされたタスクの高度なプロパティを表示するには

次のコマンドは、ローカル コンピューターでは、作業の詳細の表示を要求します。 使用して、 **/v** 詳細 (verbose) 表示を要求するパラメーター、および **/fo リスト** 表示を見やすくするためのリストとして書式設定するパラメーターです。 このコマンドを使用すると、作成したタスクが意図した定期的なパターンであることを確認します。

**schtasks/query/fo LIST/v**

これに対して、Schtasks.exe はすべてのタスクの詳細プロパティリストを表示し**ます**。 次の表示は、午前 4 時に実行するようにスケジュール タスクのタスクの一覧を示しています。 毎月の最終金曜日。
```
HostName: RESKIT01
TaskName: SecureScript
Next Run Time: 4:00:00 AM , 3/30/2001
Status: Not yet run
Logon mode: Interactive/Background
Last Run Time: Never
Last Result: 0
Creator: user01
Schedule: At 4:00 AM on the last Fri of every month, starting 3/24/2001
Task To Run: C:\WINDOWS\system32\notepad.exe
Start In: notepad.exe
Comment: N/A
Scheduled Task State: Enabled
Scheduled Type: Monthly
Modifier: Last FRIDAY
Start Time: 4:00:00 AM
Start Date: 3/24/2001
End Date: N/A
Days: FRIDAY
Months: JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
Run As User: RESKIT\user01
Delete Task If Not Rescheduled: Enabled
Stop Task If Runs X Hours and X Mins: 72:0
Repeat: Until Time: Disabled
Repeat: Duration: Disabled
Repeat: Stop If Still Running: Disabled
Idle: Start Time(For IDLE Scheduled Type): Disabled
Idle: Only Start If Idle for X Minutes: Disabled
Idle: If Not Idle Retry For X Minutes: Disabled
Idle: Stop Task If Idle State End: Disabled
Power Mgmt: No Start On Batteries: Disabled
Power Mgmt: Stop On Battery Mode: Disabled
```

### <a name="to-log-tasks-scheduled-for-a-remote-computer"></a>リモート コンピューターのスケジュールされたタスクを記録するには

次のコマンドは、リモート コンピューターの場合は、スケジュールされたタスクの一覧を要求し、タスクをローカル コンピューター上のコンマ区切りログ ファイルに追加します。 このコマンド形式を使用して、収集し、複数のコンピューターにスケジュールされているタスクを追跡することができます。

コマンドを使用して、 **/s** Reskit16、リモート コンピューターを識別するためにパラメーター、 **/fo** 形式を指定するパラメーター、および **/nh** 列見出しをしないようにするパラメーターです。 **>>**  タスク ログ、p0102.csv Svr01、ローカル コンピューター上にシンボルのリダイレクトの出力を追加します。 リモート コンピューターでコマンドを実行しているために、ローカル コンピューターのパスは完全修飾する必要があります。
```
schtasks /query /s Reskit16 /fo csv /nh >> \\svr01\data\tasklogs\p0102.csv
```
これに対して、 **SchTasks.exe** Reskit16 コンピューター Svr01、ローカル コンピューター上の p0102.csv ファイルへのスケジュールされたタスクを追加します。

#### <a name="additional-references"></a>その他の参照情報

[コマンド ライン構文の記号](command-line-syntax-key.md)
