---
title: at
description: At コマンドのリファレンストピックでは、指定された日時にコンピューター上で実行するコマンドとプログラムをスケジュールします。
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: ff18fd16-9437-4c53-8794-bfc67f5256b3
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 3aafcf4cbc4a6626a3390fe5ad6a305b90dfaec0
ms.sourcegitcommit: ab64dc83fca28039416c26226815502d0193500c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/01/2020
ms.locfileid: "82718930"
---
# <a name="at"></a>at

> 適用対象: Windows Server (半期チャネル)、Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

指定した日時にコンピューター上で実行するコマンドとプログラムをスケジュールします。 は、Schedule サービスが実行されている場合**にのみ使用**できます。 パラメーターを指定せ**ずに使用**します。スケジュールされたコマンドを一覧表示します。 このコマンドを実行するには、ローカルの Administrators グループのメンバーである必要があります。

## <a name="syntax"></a>構文

```
at [\computername] [[id] [/delete] | /delete [/yes]]
at [\computername] <time> [/interactive] [/every:date[,...] | /next:date[,...]] <command>
```

### <a name="parameters"></a>パラメーター

| パラメーター | [説明] |
| --------- | ----------- |
| `\<computername\>` | リモート コンピューターを指定します。 このパラメーターを省略すると、 **at**はローカルコンピューター上のコマンドとプログラムをスケジュールします。 |
| `<id>` | スケジュールされたコマンドに割り当てられた識別番号を指定します。 |
| /delete | スケジュールされたコマンドをキャンセルします。 *ID*を省略すると、コンピューター上のスケジュールされたすべてのコマンドが取り消されます。 |
| /yes | スケジュールされたイベントを削除するときに、システムからのすべてのクエリに対して [はい] を回答します。 |
| `<time>` | コマンドを実行する時刻を指定します。 時間は、時間: 分で24時間表記 (つまり、00:00 (午前0時) から 23:59) で表されます。 |
| 対話型 | *コマンドの実行時*にログオンしたユーザーのデスクトップとの対話を*コマンド*に許可します。 |
| 1 | 指定したすべての曜日または曜日 (たとえば、毎週の木曜日、3日目など) に対して*コマンド*を実行します。 |
| `<date>` | コマンドを実行する日付を指定します。 1つまたは複数の曜日を指定できます (つまり、「 **M**」、「**T****」、「****Th**」、「**F****」、「****Su**」、または「1 ~ 31」と入力します)。 複数の日付エントリをコンマで区切ります。 *日付*を省略した場合、 **at**は月の現在の日付を使用します。 |
| 次に： | 次の日の発生時に*コマンド*を実行します (次の木曜日など)。 |
| `<command>` | 実行する Windows コマンド、プログラム (.exe または .com ファイル)、またはバッチプログラム (つまり、.bat または .cmd ファイル) を指定してください。 コマンドが引数としてパスを必要とする場合は、絶対パス (つまり、ドライブ文字で始まるパス全体) を使用します。 コマンドがリモートコンピューター上にある場合は、リモートドライブ文字ではなく、サーバーと共有名に汎用名前付け規則 (UNC) 表記を指定します。 |
| /? | コマンド プロンプトにヘルプを表示します。 |

### <a name="remarks"></a>Remarks

- このコマンドでは、コマンドを実行する前に cmd.exe が自動的に読み込まれません。 実行可能ファイル (.exe) を実行していない場合は、次のように、コマンドの先頭に cmd.exe を明示的に読み込む必要があります。

    ```
    cmd /c dir > c:\test.out
    ```

- コマンドラインオプションを指定せずにこのコマンドを使用すると、スケジュールされたタスクは次のように書式設定されたテーブルに表示されます。

    ```
    Status  ID   Day        time        Command Line
    OK      1    Each F     4:30 PM     net send group leads status due
    OK      2    Each M     12:00 AM    chkstor > check.file
    OK      3    Each F     11:59 PM    backup2.bat
    ```

- このコマンドに識別番号 (*id*) を含めると、1つのエントリの情報だけが次のような形式で表示されます。  

    ```
    Task ID: 1
    Status: OK
    Schedule: Each  F
    Time of Day: 4:30 PM
    Command: net send group leads status due
    ```

- コマンドのスケジュールを設定した後、コマンドラインオプションを含むコマンドを実行する場合は、コマンドラインオプションを指定せず**に**「」と入力して、コマンドの構文が正しいことを確認します。 [**コマンドライン]** 列の情報が間違っている場合は、コマンドを削除して再入力します。 それでも間違っている場合は、コマンドラインオプションを使用してコマンドを再入力します。

- でスケジュールさ**れたコマンドをバックグラウンド**プロセスとして実行します。 出力はコンピューター画面に表示されません。 ファイルに出力をリダイレクトするには、リダイレクトシンボル`>`を使用します。 ファイルに出力をリダイレクトする場合は、コマンドラインまたはバッチファイル`^`でを使用しているかどうかにかかわらず、リダイレクトシンボルの前にエスケープシンボル**を使用する**必要があります。 たとえば、出力を*output.txt*にリダイレクトするには、次のように入力します。

    ```
    at 14:45 c:\test.bat ^>c:\output.txt
    ```

    実行中のコマンドの現在のディレクトリは、systemroot フォルダーです。

- 実行するコマンドのスケジュールを設定した後にシステム時刻を変更する場合は、コマンドラインオプションを指定せず**に**「」と入力して、スケジューラのと変更**後のシステム**時刻を同期します。

- スケジュールされたコマンドはレジストリに格納されます。 その結果、スケジュールサービスを再起動すると、スケジュールされたタスクが失われることはありません。

- ネットワークにアクセスするスケジュールされたジョブには、リダイレクトされたドライブを使用しないでください。 スケジュールサービスは、リダイレクトされたドライブにアクセスできない可能性があります。または、スケジュールされたタスクの実行時に別のユーザーがログオンしている場合は、リダイレクトされたドライブが存在しない可能性があります。 代わりに、スケジュールされたジョブに UNC パスを使用します。 次に例を示します。  

    ```
    at 1:00pm my_backup \\server\share
    ```

    次の構文は使用しないでください。 **x:** はユーザーによって作成された接続です。  

    ```
    at 1:00pm my_backup x:
    ```

    ドライブ文字を使用して共有ディレクトリに接続する**at**コマンドをスケジュールする場合は、ドライブの使用が終了したときにドライブを切断する**at**コマンドを追加します。 ドライブが切断されていない場合、割り当てられたドライブ文字はコマンドプロンプトで使用できません。

- 既定では、このコマンドを使用してスケジュールされたタスクは、72時間後に停止します。 レジストリを変更して、この既定値を変更できます。

    **レジストリを変更するには**

    > [!Caution]
    > レジストリを正しく編集しないと、システムが正常に動作しなくなる場合があります。 レジストリを変更する前に、コンピューター上の重要なデータのバックアップを作成する必要があります。

    1. レジストリエディター (regedit.exe) を起動します。

    2. レジストリで次のキーを見つけてクリックします。`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Schedule`

    3. [**編集**] メニューの [**値の追加**] をクリックし、次のレジストリ値を追加します。

        - **値の名前。** atTaskMaxHours

        - **データ型。** reg_DWOrd 

        - **ベース.** Decimal

        - **値のデータ:** 0. 値の**データ**フィールドの値が**0**の場合は、制限がないことを示し、停止することはありません。 1 ~ 99 の値は、時間数を示します。

- [スケジュールされたタスク] フォルダーを使用して、このコマンドを使用して作成されたタスクの設定を表示または変更できます。 このコマンドを使用してタスクをスケジュールすると、タスクが [スケジュールされたタスク] フォルダーに、次のような名前で表示されます:**at3478**。 ただし、[スケジュールされたタスク] フォルダーを使用してタスクを変更すると、通常のスケジュールされたタスクにアップグレードされます。 **At**コマンドからタスクが見えなくなり、at アカウントの設定が適用されなくなりました。 タスクのユーザーアカウントとパスワードを明示的に入力する必要があります。

## <a name="examples"></a>例

マーケティングサーバーでスケジュールされているコマンドの一覧を表示するには、次のように入力します。

```
at \\marketing
```

Corp サーバーの id 番号が3のコマンドの詳細については、次のように入力してください。

```
at \\corp 3
```

Corp サーバーで実行されるように net share コマンドをスケジュールするには (午前 8:00) 次のように、リストをメンテナンスサーバー、Reports 共有ディレクトリ、および Corp .txt ファイルにリダイレクトします。

```
at \\corp 08:00 cmd /c net share reports=d:\marketing\reports >> \\maintenance\reports\corp.txt
```

マーケティングサーバーのハードドライブを5日おきに午前0時にテープドライブにバックアップするには、backup コマンドを含む Archive という名前の batch プログラムを作成し、実行するバッチプログラムをスケジュールします。次に、次のように入力します。

```
at \\marketing 00:00 /every:5,10,15,20,25,30 archive
```

現在のサーバーでスケジュールされているすべてのコマンドを取り消すには、 **at**スケジュール情報を次のようにオフにします。

```
at /delete
```

実行可能 (.exe) ファイルではないコマンドを実行するには、コマンドの前に**cmd/c**を使用して、次のように cmd.exe を読み込みます。

```
cmd /c dir > c:\test.out
```

## <a name="additional-references"></a>その他のリファレンス

- [コマンド ライン構文の記号](command-line-syntax-key.md)

- [schtasks](schtasks.md)。 別のコマンドラインスケジューリングツール。
