---
title: klist
description: Klist コマンドの参照記事。現在キャッシュされている Kerberos チケットの一覧を表示します。
ms.topic: article
ms.assetid: 4689b4a9-1740-47dd-9240-02105efca428
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 2e37946106d7c47f058fd42b9926e388ab830e47
ms.sourcegitcommit: 53d526bfeddb89d28af44210a23ba417f6ce0ecf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/06/2020
ms.locfileid: "87888186"
---
# <a name="klist"></a>klist

現在キャッシュされている Kerberos チケットの一覧を表示します。

> [!IMPORTANT]
> このコマンドのすべてのパラメーターを実行するには、少なくとも1つの**ドメイン管理者**またはそれと同等の権限を持っている必要があります。

## <a name="syntax"></a>構文

```
klist [-lh <logonID.highpart>] [-li <logonID.lowpart>] tickets | tgt | purge | sessions | kcd_cache | get | add_bind | query_bind | purge_bind
```

### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| -lh | ユーザーのローカル一意識別子 (LUID) の大部分を16進数で表したものを示します。 **– Lh**も **– li**も存在しない場合、コマンドの既定値は、現在サインインしているユーザーの LUID です。 |
| -li | ユーザーのローカル一意識別子 (LUID) の下位部分 (16 進数で表される) を表します。 **– Lh**も **– li**も存在しない場合、コマンドの既定値は、現在サインインしているユーザーの LUID です。 |
| チケット | 現在キャッシュされているチケット付与チケット (Tgt)、および指定したログオンセッションのサービスチケットが一覧表示されます。 既定のオプションです。 |
| tgt | 最初の Kerberos TGT を表示します。 |
| 削除 | 指定されたログオンセッションのすべてのチケットを削除できます。 |
| セッション | このコンピューターのログオンセッションの一覧を表示します。 |
| kcd_cache | Kerberos の制約付き委任キャッシュ情報を表示します。 |
| get | サービスプリンシパル名 (SPN) によって指定されたターゲットコンピューターにチケットを要求できます。 |
| add_bind | Kerberos 認証に優先するドメインコントローラーを指定できます。 |
| query_bind | Kerberos が接続している各ドメインについて、キャッシュされた優先ドメインコントローラーの一覧を表示します。 |
| purge_bind | 指定したドメインのキャッシュされた優先ドメインコントローラーを削除します。 |
| kdcoptions | RFC 4120 で指定されているキー配布センター (KDC) オプションを表示します。 |
| /? | このコマンドのヘルプを表示します。 |

#### <a name="remarks"></a>Remarks

- パラメーターが指定されていない場合、 **klist**は、現在ログオンしているユーザーのすべてのチケットを取得します。

- パラメーターには、次の情報が表示されます。

  - **チケット**-ログオン後に認証したサービスの現在のキャッシュチケットが一覧表示されます。 キャッシュされたすべてのチケットの次の属性を表示します。

    - **LogonID:** LUID。

    - **クライアント:** クライアント名とクライアントのドメイン名を連結したもの。

    - **サーバー:** サービス名とサービスのドメイン名を連結したもの。

    - **Kerbticket の暗号化の種類:** Kerberos チケットの暗号化に使用される暗号化の種類。

    - **チケットのフラグ:** Kerberos チケットフラグ。

    - **開始時刻:** チケットが有効になる時刻。

    - **終了時刻:** チケットが有効でなくなった時刻。 チケットがこの時間を過ぎている場合、サービスへの認証や更新に使用することはできなくなります。

    - **更新時刻:** 新しい初期認証が必要な時間。

    - **セッションキーの種類:** セッションキーに使用される暗号化アルゴリズム。

  - **tgt** -最初の Kerberos tgt と、現在キャッシュされているチケットの次の属性が一覧表示されます。

    - **LogonID:** 16進数で識別されます。

    - **ServiceName:** krbtgt

    - **TargetName `<SPN>` :** krbtgt

    - **DomainName:** TGT を発行するドメインの名前。

    - **Targetdomainname:** TGT が発行されるドメイン。

    - **Alttargetdomainname:** TGT が発行されるドメイン。

    - **チケットのフラグ:** アドレスとターゲットのアクションと種類。

    - **セッションキー:** キーの長さと暗号化アルゴリズム。

    - **StartTime:** チケットが要求されたローカルコンピューターの時刻。

    - **EndTime:** チケットが有効でなくなった時刻。 チケットがこの時間を過ぎている場合は、サービスに対する認証に使用できなくなります。

    - **Renewuntil:** チケット更新の期限。

    - **TimeSkew:** キー配布センター (KDC) との時差。

    - **エンコードチケット:** エンコードされたチケット。

  - **purge** -特定のチケットを削除できます。 チケットを削除すると、キャッシュされているすべてのチケットが破棄されるため、この属性は注意して使用してください。 リソースに対して認証できなくなる可能性があります。 この問題が発生した場合は、いったんログオフしてから再度ログオンする必要があります。

    - **LogonID:** 16進数で識別されます。

  - [**セッション**]-このコンピューター上のすべてのログオンセッションの情報を一覧表示し、表示することができます。

    - **LogonID:** 指定した場合、指定した値によってのみログオンセッションが表示されます。 指定しない場合、このコンピューターのすべてのログオンセッションが表示されます。

  - **kcd_cache** -Kerberos の制約付き委任キャッシュ情報を表示できます。

    - **LogonID:** 指定した場合は、指定された値までにログオンセッションのキャッシュ情報が表示されます。 指定しない場合、現在のユーザーのログオンセッションのキャッシュ情報が表示されます。

  - **get** -SPN によって指定されたターゲットにチケットを要求できます。

    - **LogonID:** 指定した場合、指定された値でログオンセッションを使用してチケットを要求します。 指定しない場合、現在のユーザーのログオンセッションを使用してチケットを要求します。

    - **kdcoptions:** 指定された KDC オプションでチケットを要求します

  - **add_bind** -Kerberos 認証に優先するドメインコントローラーを指定できます。

  - **query_bind** -ドメインのキャッシュされた優先ドメインコントローラーを表示できます。

  - **purge_bind** -ドメインのキャッシュされた優先ドメインコントローラーを削除できます。

  - **kdcoptions** -現在のオプションの一覧とその説明については、 [RFC 4120](http://www.ietf.org/rfc/rfc4120.txt)を参照してください。

### <a name="examples"></a>例

Kerberos チケットキャッシュを照会してチケットが不足しているかどうかを確認するには、対象サーバーまたはアカウントにエラーが発生しているか、イベント ID 27 エラーが原因で暗号化の種類がサポートされていない場合は、次のように入力します。

```
klist
```

```
klist –li 0x3e7
```

ログオンセッション用にコンピューターにキャッシュされている各チケット付与チケットの詳細については、次のように入力してください。

```
klist tgt
```

Kerberos チケットキャッシュを消去するには、いったんログオフしてから再度ログオンし、次のように入力します。

```
klist purge
```

```
klist purge –li 0x3e7
```

ログオンセッションを診断し、ユーザーまたはサービスの logonID を見つけるには、次のように入力します。

```
klist sessions
```

Kerberos の制約付き委任エラーを診断し、発生した最後のエラーを確認するには、次のように入力します。

```
klist kcd_cache
```

ユーザーまたはサービスがサーバーにチケットを取得できるかどうかを診断するには、または特定の SPN のチケットを要求するには、次のように入力します。

```
klist get host/%computername%
```

ドメインコントローラー間のレプリケーションの問題を診断するには、通常、特定のドメインコントローラーを対象とするクライアントコンピューターが必要です。 クライアントコンピューターのターゲットを特定のドメインコントローラーにするには、次のように入力します。

```
klist add_bind CONTOSO KDC.CONTOSO.COM
```

```
klist add_bind CONTOSO.COM KDC.CONTOSO.COM
```

このコンピューターによって最近接続されたドメインコントローラーを照会するには、次のように入力します。

```
klist query_bind
```

ドメインコントローラーを再検出したり、を使用して新しいドメインコントローラーバインドを作成する前にキャッシュをフラッシュしたりするには `klist add_bind` 、次のように入力します。

```
klist purge_bind
```

## <a name="additional-references"></a>その他の参照情報

- [コマンド ライン構文の記号](command-line-syntax-key.md)