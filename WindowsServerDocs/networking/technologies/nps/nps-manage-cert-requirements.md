---
title: PEAP と EAP の要件に合わせて証明書テンプレートを構成する
description: このトピックでは、Windows Server 2016 のネットワークポリシーサーバーとリモートアクセスで証明書を使用する方法について説明します。
manager: brianlic
ms.prod: windows-server
ms.technology: networking
ms.topic: article
ms.assetid: 2af0a1df-5c44-496b-ab11-5bc340dc96f0
ms.author: pashort
author: shortpatti
ms.openlocfilehash: f60e5a1da1388a6dd2432a3603f83d6ca2990a29
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/27/2019
ms.locfileid: "71405404"
---
# <a name="configure-certificate-templates-for-peap-and-eap-requirements"></a>PEAP と EAP の要件に合わせて証明書テンプレートを構成する

>適用対象:Windows Server (半期チャネル)、Windows Server 2016

拡張認証プロトコル @ no__t-0Transport Layer Security @no__t のネットワークアクセス認証に使用されるすべての証明書: 1EAP @ no__t-2TLS @ no__t-3、保護された拡張認証プロトコル @ no__t-4Transport Layer Security\(PEAP @ no__t-6TLS @ no__t-7、および PEAP @ no__t-8Microsoft チャレンジハンドシェイク認証プロトコルバージョン 2 \(MS @ no__t-10CHAP v2 @ no__t-11 は、x.509 証明書の要件を満たし、Secure Socket を使用する接続に対して機能する必要があります。レイヤー/トランスポートレベルのセキュリティ (SSL/TLS)。 クライアントとサーバーの両方の証明書に追加の要件があります。

>[!IMPORTANT]
>このトピックでは、証明書テンプレートを構成する手順について説明します。 これらの手順を使用するには、独自の公開キーインフラストラクチャ \(PKI @ no__t-1 を Active Directory 証明書サービス \(AD CS @ no__t に展開しておく必要があります。

## <a name="minimum-server-certificate-requirements"></a>サーバー証明書の最小要件

認証方法として、PEAP @ no__t-0MS @ no__t-1CHAP v2、PEAP @ no__t-2TLS、または EAP @ no__t-3TLS を使用する場合、NPS はサーバー証明書の最小要件を満たすサーバー証明書を使用する必要があります。 

クライアントコンピューターは、クライアントコンピューターまたはグループポリシーで **[サーバー証明書の検証]** オプションを使用して、サーバー証明書を検証するように構成できます。 

サーバー証明書が次の要件を満たしている場合、クライアントコンピューターはサーバーの認証試行を受け入れます。

- サブジェクト名に値が含まれています。 空のサブジェクト名を持つネットワークポリシーサーバー (NPS) を実行しているサーバーに証明書を発行する場合、その証明書を使用して NPS を認証することはできません。 サブジェクト名を使用して証明書テンプレートを構成するには

    1. 証明書テンプレートを開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、 **[プロパティ]** をクリックします。
    3. **[サブジェクト名]** タブをクリックし、 **[この Active Directory の情報から構築]** する をクリックします。
    4. **[サブジェクト名の形式]** で、 **[なし]** 以外の値を選択します。

- サーバー上のコンピューター証明書は、信頼されたルート証明機関 (CA) にチェーンされており、CryptoAPI によって実行され、リモートアクセスポリシーまたはネットワークポリシーで指定されているチェックには失敗しません。

- NPS または VPN サーバーのコンピューター証明書は、拡張キー使用法 (EKU) の拡張機能でサーバー認証の目的で構成されています。 (サーバー認証のオブジェクト識別子は1.3.6.1.5.5.7.3.1 です)。

- 必要な暗号化設定を使用して、サーバー証明書を構成します。

    1. 証明書テンプレートを開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、 **[プロパティ]** をクリックします。
    3. **[暗号化]** タブをクリックし、次の構成を行っていることを確認します。
       - **プロバイダーのカテゴリ:** キー ストレージ プロバイダー
       - **アルゴリズム名:** RSA
       - **プロバイダー**Microsoft プラットフォーム暗号化プロバイダー
       - **最小キーサイズ:** 2048
       - **ハッシュアルゴリズム:** SHA2
    4. **[次へ]** をクリックします。

- サブジェクト代替名 (SubjectAltName) 拡張機能を使用する場合は、サーバーの DNS 名が含まれている必要があります。 登録サーバーのドメインネームシステム (DNS) 名を使用して証明書テンプレートを構成するには、次のようにします。 

    1. 証明書テンプレートを開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、 **[プロパティ]** をクリックします。
    3. **[サブジェクト名]** タブをクリックし、 **[この Active Directory の情報から構築]** する をクリックします。
    4. **[代替サブジェクト名に次の情報を含める]** で、 **[DNS 名]** を選択します。

PEAP と EAP-TLS を使用する場合、NPSs には、コンピューターの証明書ストアにインストールされているすべての証明書の一覧が表示されます。ただし、次の例外があります。

- EKU 拡張にサーバー認証の目的が含まれていない証明書は表示されません。

- サブジェクト名が含まれていない証明書は表示されません。

- レジストリベースおよびスマートカードログオン証明書は表示されません。

詳細については、「 [802.1 x ワイヤード (有線) およびワイヤレス展開用のサーバー証明書の展開](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/server-certs/deploy-server-certificates-for-802.1x-wired-and-wireless-deployments)」を参照してください。

## <a name="minimum-client-certificate-requirements"></a>クライアント証明書の最小要件

EAP-TLS または PEAP-TLS では、証明書が次の要件を満たしている場合、サーバーはクライアント認証の試行を受け入れます。

- クライアント証明書は、エンタープライズ CA によって発行されているか、Active Directory Domain Services @no__t 0AD DS @ no__t-1 のユーザーまたはコンピューターアカウントにマップされています。

- クライアントが信頼されたルート CA にチェーンしているユーザーまたはコンピューターの証明書には、EKU 拡張 @no__t 機能にクライアント認証の目的が含まれています。つまり、クライアント認証のオブジェクト識別子は 1.3.6.1.5.5.7.3.2 @ no__t-1 で、CryptoAPI によって実行されます。これは、リモートアクセスポリシーまたはネットワークポリシーで指定されているか、NPS ネットワークポリシーで指定されている証明書オブジェクト識別子の確認です。

- 802.1 X クライアントは、スマートカードログオンまたはパスワードで保護された証明書のいずれかであるレジストリベースの証明書を使用しません。

- ユーザー証明書の場合、証明書のサブジェクト代替名 \(SubjectAltName @ no__t 拡張子は、ユーザープリンシパル名 \(UPN @ no__t-3 を含みます。 証明書テンプレートで UPN を構成するには、次のようにします。

    1. 証明書テンプレートを開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、 **[プロパティ]** をクリックします。
    3. **[サブジェクト名]** タブをクリックし、 **[この Active Directory の情報から構築]** する をクリックします。
    4. **[代替サブジェクト名に次の情報を含める]** で、[**ユーザープリンシパル名] \(upn @ no__t-3**を選択します。

- コンピューター証明書の場合、証明書のサブジェクトの @no__t 別名 0SubjectAltName @ no__t 拡張子には、クライアントの完全修飾ドメイン @no__t 名 ( *DNS 名*とも呼ばれます) が含まれている必要があります。 証明書テンプレートでこの名前を構成するには、次のようにします。

    1. 証明書テンプレートを開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、 **[プロパティ]** をクリックします。
    3. **[サブジェクト名]** タブをクリックし、 **[この Active Directory の情報から構築]** する をクリックします。
    4. **[代替サブジェクト名に次の情報を含める]** で、 **[DNS 名]** を選択します。

PEAP @ no__t-0TLS および EAP @ no__t-1TLS では、クライアントは証明書スナップインにインストールされているすべての証明書の一覧を表示しますが、次の例外があります。

- ワイヤレスクライアントには、レジストリベースおよびスマートカードログオンの証明書は表示されません。 

- ワイヤレスクライアントおよび VPN クライアントには、パスワードで保護された証明書は表示されません。 

- EKU 拡張にクライアント認証の目的が含まれていない証明書は表示されません。


NPS の詳細については、「[ネットワークポリシーサーバー (nps)](nps-top.md)」を参照してください。
