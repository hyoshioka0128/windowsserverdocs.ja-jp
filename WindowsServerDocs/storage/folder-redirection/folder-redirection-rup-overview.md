---
title: フォルダー リダイレクト、オフライン ファイル、移動ユーザー プロファイルの概要
description: フォルダー リダイレクト、オフライン ファイル、移動ユーザー プロファイルのテクノロジの概要。
ms.prod: windows-server
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage
ms.date: 04/05/2018
ms.localizationpriority: medium
ms.openlocfilehash: 5f2e8a0816fdd78491c18e196a57a38734e3368e
ms.sourcegitcommit: 5bc5aaf341c711113ca03d1482f933b05b146007
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/19/2020
ms.locfileid: "85094506"
---
# <a name="folder-redirection-offline-files-and-roaming-user-profiles-overview"></a>フォルダー リダイレクト、オフライン ファイル、移動ユーザー プロファイルの概要

>適用先:Windows 10、Windows 8、Windows 8.1、Windows Server 2019、Windows Server 2016、Windows Server 2012、Windows Server 2012 R2

このトピックでは、フォルダー リダイレクト、オフライン ファイル (クライアント側キャッシュ (CSC))、移動ユーザー プロファイル (RUP) の 3 つのテクノロジについて、新機能や詳細情報の参照先などを含めて説明します。

## <a name="technology-description"></a>テクノロジの説明

フォルダー リダイレクトとオフライン ファイルを同時に使うと、フォルダーの内容をローカルでキャッシュすることで速度と可用性を向上しつつ、(ドキュメント フォルダーなどの) ローカル フォルダーのパスをネットワーク上の場所にリダイレクトできます。 移動ユーザー プロファイルは、ユーザー プロファイルをネットワーク上の場所にリダイレクトするために使われます。 ここに挙げた機能は、以前は Intellimirror と呼ばれていました。

- ユーザーや管理者は、**フォルダー リダイレクト** を使用すると、手動で、またはグループ ポリシーを使用して、既知のフォルダーのパスを新しい場所にリダイレクトできます。 新しい場所は、ローカル コンピューター上のフォルダーでも、ファイル共有上のディレクトリでもかまいません。 ユーザーは、リダイレクトされたフォルダー内のファイルが依然としてローカル ドライブに存在しているかのようにファイルを操作できます。 たとえば、通常はローカル ドライブに格納されているドキュメント フォルダーを、ネットワーク上の場所にリダイレクトできます。 これによって、ユーザーがネットワーク上のどのコンピューターからでもフォルダー内のファイルを利用できるようになります。
- **オフライン ファイル** を使用すると、サーバーへのネットワーク接続が不可能または低速な場合でも、ユーザーはネットワーク ファイルを利用できます。 オンラインで作業している場合、ファイル アクセスのパフォーマンスはネットワークとサーバーの速度によって決まりますが、 オフラインで作業している場合には、ローカル アクセスの速度でオフライン ファイル フォルダーからファイルが取得されます。 次の場合には、コンピューターがオフライン モードに切り替わります。
  - **常時オフライン** モードが有効になった場合
  - サーバーが利用できない場合
  - ネットワーク接続が構成可能なしきい値より遅くなった場合
  - ユーザーは、Windows Explorer の **[オフライン作業]** ボタンを使って、手動でオフライン モードに切り替えることができます。
- **移動ユーザー プロファイル** を使用すると、ユーザー プロファイルがファイル共有にリダイレクトされ、ユーザーは複数のコンピューター上でオペレーティング システムとアプリケーションの同一の設定を利用できます。 プロファイル パスとしてファイル共有を設定したアカウントを使ってユーザーがコンピューターにサインインすると、そのユーザーのプロファイルがローカル コンピューターにダウンロードされ、(ローカル プロファイルがある場合には) ローカル プロファイルに結合されます。 ユーザーがコンピューターからサインアウトすると、ローカル プロファイルが (変更部分も含め) サーバーにあるプロファイルに結合されます。 通常、移動ユーザー プロファイルは、ネットワーク管理者がドメイン アカウントで有効にします。

## <a name="practical-applications"></a>実際の適用例

管理者がフォルダー リダイレクト、オフライン ファイル、および移動ユーザー プロファイルを使用して、ユーザーのデータと設定の記憶域を一元管理し、オフラインのときや、ネットワークまたはサーバーが停止した場合でも、ユーザーが各自のデータにアクセスできるようにします。 具体的な適用例には以下が挙げられます。

- サーバー ベースのバックアップ ツールを用いてユーザーのフォルダーと設定のバックアップを取るなどの管理タスクのために、クライアント コンピューターのデータを一元管理。
- ネットワークやサーバーが停止した場合でも、ユーザーのネットワーク ファイルへのアクセスを確保。
- 帯域幅の使用を最適化して、ブランチ オフィス ユーザーが別の場所にある社内サーバーでホストされているファイルやフォルダーにアクセスする際のユーザー エクスペリエンスを向上。
- オフラインでの作業中や低速ネットワーク下でもモバイル ユーザーのネットワーク ファイルへのアクセスを確保。

## <a name="new-and-changed-functionality"></a>新機能と変更された機能

次の表では、このリリースでフォルダー リダイレクト、オフライン ファイル、および移動ユーザー プロファイルに加えられた主な変更点について説明します。

| 機能 | 新規/更新 | 説明 |
| --- | --- | --- |
| 常時オフライン モード | 新規 | 高速ネットワーク接続によって接続している場合でも、常時オフラインで作業することによりファイルへのアクセス速度を高め、帯域幅の使用量を抑制できます。 |
| コスト意識型同期 | 新規 | 使用量に制限のある従量制課金接続を使っている場合や、別のプロバイダーのネットワーク上でローミングしている場合、ユーザーは同期によるデータ使用コストの増加を回避できます。 |
| プライマリ コンピューターのサポート | 新規 | フォルダー リダイレクトと移動ユーザー プロファイルのいずれかまたは両方の使用を、ユーザーのプライマリ コンピューターだけに制限できます。 |

## <a name="always-offline-mode"></a>常時オフライン モード

Windows 8 および Windows Server 2012 以降では、管理者は、オフライン ファイルのユーザーが、高速ネットワーク接続で接続されている場合でも、常時オフラインで作業できるようにエクスペリエンスを構成できます。 既定では、同期によって 1 時間ごとにバックグラウンドでオフライン ファイルのキャッシュ内のファイルが更新されます。

### <a name="what-value-does-always-offline-mode-add"></a>常時オフライン モードにはどのような価値がありますか?

常時オフライン モードには、次のような利点があります。

- ユーザーは、ドキュメント フォルダーなど、リダイレクトされたフォルダーにあるファイルへのアクセス速度が向上します。
- ネットワーク帯域幅を減らし、4G モバイル ネットワークなどの高価な WAN 接続または従量制課金接続にかかるコストを削減できます。

### <a name="how-has-always-offline-mode-changed-things"></a>常時オフライン モードによって何が変わりましたか?

ユーザーは、Windows 8 および Windows Server 2012 になる前は、低速リンク モード (低速接続モードとも呼ばれます) を有効にし、待ち時間のしきい値を 1 ミリ秒に設定していても、ネットワークが利用可能かどうかやネットワークの状況に応じて、オンライン モードとオフライン モードを切り替えていました。

常時オフライン モードでは、 **[低速リンク モードを構成する]** グループ ポリシーが構成されており、かつ **[待機時間]** のしきい値パラメーターが 1 ミリ秒に設定されていると、コンピューターはオンライン モードに切り替わりません。 既定では、変更はバックグラウンドで 120 分ごとに同期されますが、 **[Configure Background Sync]** グループ ポリシー設定を使えば同期を構成できます。

詳細については、「 [Enable the Always Offline Mode to Provide Faster Access to Files](enable-always-offline.md)」を参照してください。

## <a name="cost-aware-synchronization"></a>コスト意識型同期

コスト意識型同期により、ユーザーが 4G モバイル ネットワークなどの従量制課金接続を使用していて、使用中の帯域幅が加入者の上限値に近づくかそれを超えたか、別のプロバイダーのネットワークでローミングしている場合、バックグラウンド同期が無効になります。

> [!NOTE]
> 通常、Windows 8、Windows Server 2019、Windows Server 2016、Windows Server 2012 では、従量制課金接続のラウンドトリップ ネットワーク待機時間は、オフライン (低速接続) モードに移行する待機時間の既定値である 35 ミリ秒より遅くなります。 そのため、このような接続では通常、オフライン (低速接続) モードに自動的に切り替わります。

### <a name="what-value-does-cost-aware-synchronization-add"></a>コスト意識型同期にはどのような価値がありますか?

コスト意識型同期では、使用量に制限のある従量制課金接続を使っている場合や、別のプロバイダーのネットワーク上でローミングしている場合に、データ使用コストが予想以上に増加するのを防ぐことができます。

### <a name="how-has-cost-aware-synchronization-changed-things"></a>コスト意識型同期によって何が変わりましたか?

Windows 8 と Windows Server 2012 の導入以前は、ユーザーが従量制課金接続でオフライン ファイルを使って接続料金を最小限に抑えようとした場合、モバイル ネットワーク プロバイダーの提供するツールを使ってデータの使用量を追跡する必要がありました。 また、ユーザーがローミング中に帯域幅の上限値に達しそうになったり、それを超えたりした場合には、手動でオフライン モードに切り替えました。

コスト意識型同期では、従量制課金接続の使用中に Windows が自動的にローミングと帯域幅の使用量上限を追跡します。 ユーザーがローミング中に帯域幅の上限値に達しそうになったり、それを超えた場合には、Windows によってオフライン モードに切り替えられ、同期がすべて実行されなくなります。 その場合も、ユーザーは手動で同期を開始できます。また、管理者は管理職などの特定ユーザーのコスト意識型同期をオーバーライドできます。

詳細については、「 [Enable Background File Synchronization on Metered Networks](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj127408(v%3dws.11))」を参照してください。

## <a name="primary-computers-for-folder-redirection-and-roaming-user-profiles"></a>フォルダー リダイレクトと移動ユーザー プロファイル用のプライマリ コンピューター

各ドメイン ユーザーに一連のコンピューター (プライマリ コンピューターと呼ばれる) を指定することによって、どのコンピューターがフォルダー リダイレクトと移動ユーザー プロファイルのいずれかまたは両方を使用するのかを制御できます。 プライマリ コンピューターの指定は、ユーザーのデータと設定を特定のコンピューターまたはデバイスに関連付けるほか、管理作業の簡易化、データ セキュリティの向上、ユーザー プロファイルの破損の防止を実現する、単純で効果的な方法です。

### <a name="what-value-do-primary-computers-add"></a>プライマリ コンピューターにはどのような価値がありますか?

ユーザーのプライマリ コンピューターを指定する利点は主に以下の 4 つです。

- 管理者は、ユーザーがリダイレクトされたデータおよび設定にアクセスするために使用できるコンピューターを指定できます。 たとえば、管理者は、ユーザーのデスクトップとノート PC との間ではユーザー データおよび設定をローミングし、このユーザーが会議室のコンピューターなど、それ以外のコンピューターにログオンするときはローミングしないように設定できます。
- プライマリ コンピューターの指定により、ユーザーがログオンしたコンピューターに個人データや会社のデータが残ったままになるというセキュリティおよびプライバシー上のリスクが軽減されます。 たとえば、ジェネラル マネージャーが一時的に従業員のコンピューターにログオンした場合でも、個人データや会社のデータは残りません。
- プライマリ コンピューターの指定により、管理者は、x86 ベースのコンピューターと x64 ベースのコンピューターとの間など、構成の異なるシステムの間でローミングをしたことから発生するプロファイルの不適切な構成や破損のリスクを低減できます。
- ユーザーの移動ユーザー プロファイルやリダイレクトされたフォルダーがダウンロードされないため、ユーザーがサーバーのようなプライマリでないコンピューターに初めてサインインする際に必要な時間が少なくなります。 ユーザー プロファイルをファイル共有にアップロードする必要がないため、サインアウトの時間も短縮します。

### <a name="how-have-primary-computers-changed-things"></a>プライマリ コンピューターによって何が変わりましたか?

プライベート ユーザー データのダウンロードをプライマリ コンピューターだけに制限する目的から、ユーザーがコンピューターにサインインするときにはフォルダー リダイレクトと移動ユーザー プロファイルの機能によって次のロジック チェックを実行します。

1. Windows オペレーティング システムによって新しいグループ ポリシー設定 ( **[プライマリ コンピューターにのみ移動プロファイルをダウンロードする]** と **[プライマリ コンピューターでのみフォルダーをリダイレクトする]** ) がチェックされ、ユーザーのプロファイルのローミングの判定とフォルダー リダイレクトの適用の判定に Active Directory Domain Services (AD DS) の **msDS-Primary-Computer** 属性が影響を及ぼすかどうかが決定されます。
2. ポリシー設定でプライマリ コンピューターのサポートが有効な場合、AD DS スキーマで **msDS-Primary-Computer** 属性がサポートされるかどうかが確認されます。 この属性がサポートされる場合、次の手順で、ユーザーがログオンしているコンピューターがユーザーのプライマリ コンピューターとして指定されているかどうかが確認されます。
    1. コンピューターがユーザーのプライマリ コンピューターの 1 つである場合、移動ユーザー プロファイルとフォルダー リダイレクトの設定が適用されます。
    2. コンピューターがユーザーのプライマリ コンピューターの 1 つでない場合、ユーザーのキャッシュされたローカル プロファイルが読み込まれるか (存在する場合)、または新しいローカル プロファイルが作成されます。 さらに、ローカル フォルダー リダイレクト構成に格納されている、以前に適用されたグループ ポリシー設定に指定された削除動作に従って、既存のリダイレクトされたフォルダーが削除されます。

詳細については、「 [Deploy Primary Computers for Folder Redirection and Roaming User Profiles](deploy-primary-computers.md)」を参照してください。

## <a name="hardware-requirements"></a>ハードウェア要件

フォルダー リダイレクト、オフライン ファイル、移動ユーザー プロファイルには、x64 ベースまたは x86 ベースのコンピューターが必要です。ARM (WOA) ベースのコンピューターの Windows ではサポートされません。

## <a name="software-requirements"></a>ソフトウェア要件

プライマリ コンピューターを指定するには、環境が次の要件を満たす必要があります。

- Windows Server 2012 のスキーマと条件を含むように、Active Directory Domain Services (AD DS) スキーマを更新する必要があります (このスキーマは、Windows Server 2012 以降のドメイン コントローラーをインストールすると自動的に更新されます)。 AD DS スキーマのアップグレードについて詳しくは、「[Windows Server 2016 へのドメイン コントローラーのアップグレード](../../identity/ad-ds/deploy/upgrade-domain-controllers.md)」をご覧ください。
- クライアント コンピューターは、Windows 10、Windows 8.1、Windows 8、Windows Server 2019、Windows Server 2016、Wndows Server 2012 R2、または Windows Server 2012 を実行していて、管理対象の Active Directory ドメインに参加している必要があります。

## <a name="more-information"></a>説明を見る

その他の関連情報については、次の情報を参照してください。

| コンテンツ タイプ | 参考資料 |
| --- | --- |
| 製品評価 | [信頼性の高いファイル サービスと記憶域によるインフォメーション ワーカーのサポート](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831495(v%3dws.11)>)<br>[オフライン ファイルの新機能](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ff183315(v=ws.10)>) (Windows 7 および Windows Server 2008 R2)<br>[Windows Vista のオフライン ファイルの新機能](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-vista/cc749449(v=ws.10)>)<br>[Windows Vista でのオフライン ファイルの変更点](<https://technet.microsoft.com/library/2007.11.offline.aspx>) (TechNet Magazine) |
| 展開 | [フォルダー リダイレクト オフライン ファイルおよび移動ユーザー プロファイルを展開する](deploy-folder-redirection.md)<br>[エンド ユーザー データの一元管理ソリューションの実装: フォルダー リダイレクトとオフライン ファイルのテクノロジの検証と展開](https://download.microsoft.com/download/3/0/1/3019A3DA-2F41-4F2D-BBC9-A6D24C4C68C4/Implementing%20an%20End-User%20Data%20Centralization%20Solution.docx)<br>[ローミング ユーザー データ展開の管理ガイド](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-vista/cc766489(v=ws.10)>)<br>[Windows 7 コンピューターの新しいオフライン ファイル機能の構成手順ガイド](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ff633429(v=ws.10)>)<br>[フォルダー リダイレクトを使用する](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753996(v=ws.11)>)<br>[フォルダー リダイレクトの実装](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc737434(v=ws.10)>) (Windows Server 2003) |
| ツールと設定 | [MSDN でのオフライン ファイル](https://msdn.microsoft.com/library/cc296092.aspx)<br>[オフライン ファイル グループ ポリシー リファレンス](https://msdn.microsoft.com/library/ms878937.aspx) (Windows 2000) |
| コミュニティ リソース | [ファイル サービスとストレージに関するフォーラム](https://social.technet.microsoft.com/forums/windowsserver/home?forum=winserverfiles)<br>[Hey, Scripting Guy! Windows でオフライン ファイル機能を使用する方法](<https://blogs.technet.microsoft.com/heyscriptingguy/2009/06/02/hey-scripting-guy-how-can-i-enable-and-disable-offline-files/>)<br>[Hey, Scripting Guy! オフライン ファイルを有効および無効にする方法](<https://blogs.technet.microsoft.com/heyscriptingguy/2009/06/02/hey-scripting-guy-how-can-i-enable-and-disable-offline-files/>) |
| 関連テクノロジ|[Windows Server の ID およびアクセス](../../identity/identity-and-access.yml)<br>[Windows Server の記憶域](../storage.yml)<br>[リモート アクセスおよびサーバー管理](../../remote/index.md) |
