---
ms.assetid: 7013fc21-9ced-4f9d-9588-cb04d6d60924
title: フェデレーション サーバーの容量計画
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 5801196921c1f7632725dfddb2a5c8c2bf4ae2b5
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/08/2020
ms.locfileid: "80858625"
---
# <a name="planning-for-federation-server-capacity"></a>フェデレーション サーバーの容量計画

フェデレーションサーバーの容量計画では、次のことを見積もることができます。  
  
-   AD FS 構成データベースのサイズを増やす要因。  
  
-   各フェデレーションサーバーの適切なハードウェア要件。  
  
-   各組織に配置するフェデレーションサーバーの数。  
  
フェデレーションサーバーは、ユーザーにセキュリティトークンを発行します。 これらのトークンは、使用のために証明書利用者に提示されます。 フェデレーションサーバーは、ユーザーを認証した後、または以前にパートナーフェデレーションサービスによって発行されたセキュリティトークンを受信した後に、セキュリティトークンを発行します。 ユーザーがフェデレーションアプリケーションに初めてサインインしたとき、またはセキュリティトークンがフェデレーションアプリケーションにアクセスしている間に期限切れになったときに、フェデレーションサービスからセキュリティトークンが要求されます。  
  
フェデレーションサーバーは、Microsoft ネットワーク負荷分散 \(NLB\) テクノロジを使用する高\-の可用性サーバーファーム構成に対応するように設計されています。 ファーム構成のフェデレーションサーバーは、要求ごとに共通のファームコンポーネントにアクセスすることなく、個別に要求を処理できます。 そのため、フェデレーションサーバーの展開をスケールアウトする際には、オーバーヘッドがほとんど発生しません。  
  
**推奨事項**  
  
-   ミッション\-重大または高\-の可用性の展開では、フォールトトレランスを提供するために、各パートナー組織に小規模のフェデレーションサーバーファームを作成し、ファームごとに少なくとも2つのフェデレーションサーバーを作成することをお勧めします。  
  
-   高可用性を必要とし、フェデレーションサーバーを簡単にスケールアウトできるようにするために、特定のフェデレーションサービスに対して1秒あたりの要求の数が多い場合は、スケールアウトを使用することをお勧めします。 このガイドで基本構成を超えてスケールアップすると、容量の処理能力が大幅に向上することはほとんどありません。  
  
## <a name="ad-fs-configuration-database-size-and-growth"></a>構成データベースのサイズと拡張の AD FS  
AD FS 構成データベースのサイズは、通常は小さいと見なされ、AD FS の配置ではデータベースのサイズが大きな考慮事項になるとは限りません。  AD FS 構成データベースの正確なサイズは、信頼関係の数と、関連するメタデータ\-関連するメタデータ (信頼性に関する要求、要求規則、監視設定など) によって大きく左右されます。 構成データベース内の信頼エントリの数が増えるにつれて、より多くのディスク領域が必要になります。  
  
AD FS 構成データベースのその他の展開情報については、「 [AD FS 展開トポロジに関する考慮事項](AD-FS-Deployment-Topology-Considerations.md)」を参照してください。  
  
## <a name="memory-cpu-and-disk-space-requirements"></a>メモリ、CPU、およびディスク領域の要件  
幸いにも、フェデレーションサーバーのメモリ、CPU、およびディスク領域の要件は適度であり、ハードウェアの決定に推進要因となることはほとんどありません。 ハードウェア要件の詳細については、「[付録 a: AD FS の要件の確認](Appendix-A--Reviewing-AD-FS-Requirements.md)」を参照してください。  
  
> [!NOTE]  
> AD FS 構成データベースを格納するために専用の SQL Server で構成されたフェデレーションサーバーファームを使用して AD FS 製品チームによって実行されたテストでは、SQL Server の全体的な負荷は低くなります。 1つの SQL Server を使用するように構成されていた4つの\-フェデレーション\-サーバーファームを使用しているテストでは、1つのテストでは、フェデレーションサーバーをターゲットの使用率にするテストがあっても、CPU 使用率が10% を超えません。  
  
## <a name="estimate-the-number-of-federation-servers-for-your-organization"></a><a name="bk_estimatefs"></a>組織のフェデレーションサーバーの数を推定する  
フェデレーションサーバーのハードウェア計画プロセスを効率化するための取り組みとして、AD FS 製品チームは、AD FS 容量計画のサイジングスプレッドシートを開発しました。 この Excel スプレッドシートには、組織内のユーザーについて提供する予想される使用状況データを取得し、AD FS 運用環境で推奨される最適なフェデレーションサーバーの数を返す、電卓\-のような機能が含まれています。  
  
> [!NOTE]  
> このスプレッドシートで推奨されるフェデレーションサーバーの数は、AD FS 製品チームがテスト時に使用したハードウェアとネットワークの仕様に基づいています。 そのため、このコンテキストでは、スプレッドシートで推奨されるフェデレーションサーバーの数を理解する必要があります。  テスト中に使用される仕様の詳細については、「 [Planning for AD FS Server Capacity](Planning-for-AD-FS-Server-Capacity.md)」を参照してください。  
  
### <a name="using-the-ad-fs-capacity-planning-sizing-spreadsheet"></a>AD FS 容量計画のサイジングスプレッドシートの使用  
このスプレッドシートを使用する場合、 **40%** 、 **60%** 、 **80%** \) のいずれか \(値を選択する必要があります。これは、ピーク時にフェデレーションサーバーに認証要求を送信するユーザーの総数の割合を表します。  
  
次に、 **1 分**、 **15 分**、または**1\) 時間**のいずれか \(値を選択する必要があります。これは、ピーク時の使用期間が最後に予想される時間の長さを表します。 たとえば、15分間にログインするユーザーの総数の値として40% を推定する場合や、ユーザーの60% が1時間以内にログインする場合があります。 これらの値を一緒に使用して、サイズ設定の推奨を計算するピーク時の読み込みプロファイルを定義します。  
  
次に、ユーザーが次のいずれであるかに基づいて、ターゲットの要求\-対応アプリケーションへのアクセス時にシングルサイン\-を必要とするユーザーの合計数を指定する必要があります。  
  
-   Windows 統合認証によって \(物理的に企業ネットワークに接続されているローカルコンピューターから Active Directory にログイン\)  
  
-   Windows 統合認証またはユーザー名とパスワードを使用して、企業 \(ネットワークに物理的に接続されていないコンピューターからリモートで Active Directory にログインでき\)  
  
-   別の組織から、信頼されたパートナーから対象の要求\-対応アプリケーションにアクセスしようとしています  
  
-   SAML 2.0 id プロバイダーから、対象の要求\-対応アプリケーションにアクセスしようとしています  
  
#### <a name="how-to-use-this-spreadsheet"></a>このスプレッドシートの使用方法  
展開を計画しているフェデレーションサーバーファームインスタンスごとに、次の手順を使用して、推奨されるフェデレーションサーバーの数を決定できます。  
  
1.  [Windows server 2012 R2 の AD FS 容量計画のサイジングスプレッドシート](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacityPlanning.xlsx)をダウンロードして開き、 [Windows server 2016 用の AD FS 容量計画のサイジングスプレッドシート](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx)を開きます。
  
2.  [システムのピーク] の使用期間中にの右側のセルで、**この割合のユーザーが**セルを認証し、セルをクリックし、\-ドロップダウン矢印を使用して、展開の**40%** 、 **60%** 、 **80%** のいずれかのシステム使用率の推定レベルを選択します。  
  
3.  **次の期間内**のの右側のセルで、セルをクリックし、\-ドロップダウン矢印を使用して**1 分**、 **15 分**、または**1 時間**のいずれかを選択して、ピーク時の負荷の期間を選択します。  
  
4.  [ **SharePoint \(2007 または 2010\) または要求に対応する web アプリケーション\)] セルに、[\(の内部アプリケーションの推定値を入力**してください] の右側のセルに、組織で使用する内部アプリケーションの数を入力します。  
  
5.  **Office 365 Exchange online、SharePoint online、Lync online\) などの オンラインアプリケーションの推定数を入力してください \(** の右側のセルに、組織で使用するオンラインアプリケーションまたはサービスの数を入力します。  
  
6.  **[Number Of Users]** というタイトルのセルに、ユーザーがアクセスするときにシングルサイン\-が必要になるサンプルアプリケーションシナリオに適用される行ごとに数字を入力します。 この列には、1秒あたりのピークユーザーではなく、定義されたユーザーの数が含まれている必要があります。 アプリケーションへのアクセスの試行を最初に [ホーム領域検出] ページで行う必要がある場合は、「 **Y**」と入力します。この選択がわからない場合は、「 **Y**」と入力します。  
  
7.  次の推奨値を確認してください。  
  
    1.  推奨されるフェデレーションサーバーの合計数については、灰色で強調表示されている右下のセルを参照してください。  
  
    2.  各サンプルアプリケーションシナリオで推奨されるサーバー数については、灰色で強調表示されている行のセルを参照してください。  
  
> [!NOTE]  
> スプレッドシートの下部に表示される **フェデレーションサーバーの合計数 (推奨されるフェデレーションサーバーの総数**)」というセルの右側にあるセルで自動的に計算される値には、その前にある各行のすべての値の合計に20% のバッファーが追加される数式が含まれています。 このバッファーには、ファームの全体的な負荷が飽和状態になることがほとんどないようにするために、このバッファーで推奨されるフェデレーションサーバーの合計数に対して、推奨されるセルの合計**数**に対して、推奨される合計数のセルが追加されます。  
  
## <a name="see-also"></a>参照
[Windows Server 2012 での AD FS 設計ガイド](AD-FS-Design-Guide-in-Windows-Server-2012.md)
