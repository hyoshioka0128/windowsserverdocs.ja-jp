---
ms.assetid: 98c5ef45-2bcb-4f87-86c8-5ac6c16a6097
title: トークン署名証明書
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: 9ed6a6a509547ee5c97e3647177a7f23795f10bb
ms.sourcegitcommit: dfa48f77b751dbc34409aced628eb2f17c912f08
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2020
ms.locfileid: "87970929"
---
# <a name="token-signing-certificates"></a>トークン署名証明書

フェデレーションサーバー \- では、攻撃者によるフェデレーションリソースへの不正アクセスを防ぐために、トークン署名証明書が必要です。 \/トークン署名証明書で使用される秘密の公開キーの組み合わせ \- は、フェデレーションパートナーシップの最も重要な検証メカニズムです。これらのキーは、有効なパートナーフェデレーションサーバーによってセキュリティトークンが発行されたこと、およびトークンが転送中に変更されていないことを確認するためです。

## <a name="token-signing-certificate-requirements"></a>トークン \- 署名証明書の要件
\-AD FS を操作するには、トークン署名証明書が次の要件を満たしている必要があります。

-   トークン \- 署名証明書がセキュリティトークンに正常に署名するには、トークン \- 署名証明書に秘密キーが含まれている必要があります。

-   AD FS サービスアカウントは、 \- ローカルコンピューターの個人用ストアにあるトークン署名証明書の秘密キーにアクセスできる必要があります。 この処理は、セットアップによって行われます。 また、AD FS 管理スナップインを使用し \- て、後でトークン署名証明書を変更した場合にこのアクセスを確認することもでき \- ます。

> [!NOTE]
> これは、 \( \) 秘密キーを複数の目的で共有しないようにするための公開キー基盤 PKI のベストプラクティスです。 そのため、トークン署名証明書としてフェデレーションサーバーにインストールしたサービス通信証明書は使用しないでください \- 。

## <a name="how-token-signing-certificates-are-used-across-partners"></a>\-パートナー間でトークン署名証明書を使用する方法
すべて \- のトークン署名証明書には、秘密キーによるデジタル署名に使用される暗号化秘密キーと公開キーが含まれてい \( \) ます。セキュリティトークンです。 後で、パートナーフェデレーションサーバーによって受信された後、これらのキーは、 \( 暗号化されたセキュリティトークンの公開キーを使って信頼性を検証し \) ます。

各セキュリティ トークンにはアカウント パートナーによってデジタル署名が付加されるため、リソース パートナーはセキュリティ トークンが実際にアカウント パートナーによって発行され、変更されていないことを確認できます。 デジタル署名は、パートナーのトークン署名証明書の公開キー部分によって検証され \- ます。 署名が検証されると、リソースフェデレーションサーバーはその組織に対して独自のセキュリティトークンを生成し、独自のトークン署名証明書を使用してセキュリティトークンに署名し \- ます。

フェデレーションパートナー環境では、トークン \- 署名証明書が CA によって発行されている場合は、次のことを確認してください。

1.  証明書失効リストには、 \( \) 証明書利用者と、フェデレーションサーバーを信頼する Web サーバーが証明書の crl が表示されます。

2.  ルート CA 証明書は、フェデレーションサーバーを信頼する証明書利用者と Web サーバーによって信頼されています。

リソースパートナーの Web サーバーは、トークン署名証明書の公開キーを使用し \- て、セキュリティトークンがリソースフェデレーションサーバーによって署名されていることを確認します。 その後、Web サーバーがクライアントに適切にアクセスできるようになります。

## <a name="deployment-considerations-for-token-signing-certificates"></a>トークン署名証明書の展開に関する考慮事項 \-
新しい AD FS のインストールで最初のフェデレーションサーバーを展開する場合は、トークン \- 署名証明書を取得し、そのフェデレーションサーバーのローカルコンピューターの個人証明書ストアにインストールする必要があります。 トークン署名証明書を取得するには、 \- エンタープライズ ca またはパブリック ca から要求するか、自己 \- 署名証明書を作成します。

AD FS ファームを展開するときに、 \- サーバーファームの作成方法に応じて、トークン署名証明書のインストール方法が異なります。

デプロイのトークン署名証明書を取得するときに考慮できるサーバーファームオプションは2つあり \- ます。

-   1つのトークン \- 署名証明書の秘密キーは、ファーム内のすべてのフェデレーションサーバー間で共有されます。

    フェデレーションサーバーファーム環境では、すべてのフェデレーションサーバーが \( \) 同じトークン署名証明書を共有または再利用することをお勧めし \- ます。 発行された証明書がエクスポート可能としてマークされている限り、1つのトークン \- 署名証明書をフェデレーションサーバーの CA からインストールし、秘密キーをエクスポートすることができます。

    次の図に示すように、1つのトークン署名証明書の秘密キーを \- ファーム内のすべてのフェデレーションサーバーに共有できます。 このオプションは、次の [一意のトークン \- 署名証明書] オプションと比較して、パブリック CA からトークン署名証明書を取得する予定の場合にコストを削減 \- します。

![トークン署名](media/adfs2_fedserver_certstory_3.gif)

-   \-ファーム内のフェデレーションサーバーごとに一意のトークン署名証明書があります。

    ファーム全体で一意の証明書を複数使用する場合、ファーム内の各サーバーは独自の一意の秘密キーを使用してトークンに署名します。

    次の図に示すように、 \- ファーム内の1つのフェデレーションサーバーごとに個別のトークン署名証明書を取得できます。 パブリック CA からトークン署名証明書を取得する場合は、このオプションの方がコストが高くなり \- ます。

![トークン署名](media/adfs2_fedserver_certstory_4.gif)

Microsoft 証明書サービスをエンタープライズ CA として使用する場合の証明書のインストールの詳細については、「iis [7.0: iis 7.0 でドメインサーバー証明書を作成](https://go.microsoft.com/fwlink/?LinkId=108548)する」を参照してください。

公的な CA から証明書をインストールする方法については、「[インターネット サーバー証明書を要求する (IIS 7)](https://go.microsoft.com/fwlink/?LinkId=108549)」を参照してください。

自己署名証明書のインストールの詳細については \- 、「 [iis 7.0: \- Iis 7.0 で自己署名サーバー証明書を作成する](https://go.microsoft.com/fwlink/?LinkID=108271)」を参照してください。

## <a name="see-also"></a>参照
[Windows Server 2012 での AD FS 設計ガイド](AD-FS-Design-Guide-in-Windows-Server-2012.md)
