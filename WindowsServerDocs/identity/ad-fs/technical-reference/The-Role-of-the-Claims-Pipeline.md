---
ms.assetid: ffb9d63c-ba7c-4ad1-b814-6db67f98c943
title: 要求パイプラインの役割
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: ab5cfba579313cbe6aa56c84fb59a87e06101f15
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/08/2020
ms.locfileid: "80853845"
---
# <a name="the-role-of-the-claims-pipeline"></a>要求パイプラインの役割
Active Directory フェデレーションサービス (AD FS) \(AD FS\) の要求パイプラインは、要求が発行される前にフェデレーションサービスを通過する必要があるパスを表します。 フェデレーション サービス全体の最後で管理される\-に\-もクレーム ルール エンジンによって要求規則の処理を含む要求パイプラインのさまざまな段階でフローの要求のプロセスを終了します。  
  
要求規則の詳細については、次を参照してください。 [要求規則の役割](The-Role-of-Claim-Rules.md)します。 要求規則エンジンが規則をどのように処理するかについては、「 [The Role of the Claims Engine](The-Role-of-the-Claims-Engine.md)」を参照してください。  
  
次のセクションでは、フェデレーション サービスが管理するプロセスについてさらに詳しく説明します。  
  
## <a name="claims-pipeline-process"></a>要求パイプライン プロセス  
要求パイプライン プロセスでは、3 つの高\-レベルの段階です。 このプロセスの各ステージでは、そのステージに固有の要求規則を処理するために、要求規則エンジンが初期化されます。 これらのステージを含める \(出現する順序で\):  
  
1.  入力方向の要求の受け入れ — 要求パイプラインのこのステージでは、トークンからの入力方向の要求を抽出し、想定または信頼されていない要求を排除します。 要求が抽出されると、要求プロバイダー信頼の受け付け変換規則セットを構成する承認規則が実行されます。 これらの規則は、要求を次の処理に渡したり、新しい要求を追加するために使用されます。これにより、要求パイプラインの後続のステージでそれらの要求を使用できるようになります。 このステージの出力は、2 番目と 3 番目のステージへの入力として使用されます。  
  
2.  要求元の承認 — このステージでは、トークンの要求元が指定された証明書利用者のトークンの取得を許可されているかどうかに基づいて、要求エンジンが許可を発行するか、または要求を拒否します。 ただし、その前に、証明書利用者信頼の発行承認規則セットか委任承認規則セットのいずれかを構成する承認規則が実行されます。  
  
3.  出力方向の要求の発行 — このステージでは、出力方向の要求を発行し、それらをパイプラインに送ります。送られた要求は、セキュリティ トークンにパッケージ化されます。 ただし、その前に、証明書利用者信頼の発行変換規則セットを構成する発行規則が実行されます。これにより、どの要求が出力方向の要求として発行されるかが決定されます。  
  
上記の 3 つのステージでは、それぞれ要求規則の処理が実行されますが、使用される規則セットが異なります。 各ステージに関連する入力方向の要求の発行元に基づくルール セットは前述のように、 \(受け入れ規則\) 、claimincludes が発行される対象となるサービスまたは \(承認と発行ルール\)します。  
  
クレームはトークン\-ですが変わっても常には、セキュリティ トークンにカプセル化されたネットワーク経由で送信します。 要求規則は、入力方向や出力方向のセキュリティ トークンの形式に関係なく要求に適用されます。  
  
要求規則には、管理者\-定義されたロジックが含まれています。このロジックでは、要求エンジンは入力方向の要求を受け入れ、要求元の id に基づいて要求を承認し、証明書利用者が必要とする要求を発行します。 最終的に、要求が要求パイプラインを通過した後で発行されるセキュリティ トークンにどの要求が送られるかは、要求エンジンによって決定されます。  
  
全体の最後の要求パイプラインは、次の図に示すように、\-に\-の証明書利用者信頼を介して送信される発行済みの請求終了するためにさまざまなパイプライン ステージのクレームをフローさせるプロセスを終了します。 この図にある出力方向の要求は、発行された要求を表しています。  
  
![AD FS の役割](media/adfs2_pipeline.gif)  
  
図には示されていませんが、各ステージで規則を実際に処理するのは要求エンジンです。 詳細については、「 [The Role of the Claims Engine](The-Role-of-the-Claims-Engine.md)」を参照してください。  
  

