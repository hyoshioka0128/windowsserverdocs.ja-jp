---
ms.assetid: a7ef2fba-b05c-4be2-93b2-b9456244c3ad
title: Active Directory の侵害の兆候を監視する
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: 8b28d412411336062187a842912b6f4a41957eba
ms.sourcegitcommit: 68444968565667f86ee0586ed4c43da4ab24aaed
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2020
ms.locfileid: "87994344"
---
# <a name="monitoring-active-directory-for-signs-of-compromise"></a>Active Directory の侵害の兆候を監視する

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

*法 5: 永続的の警戒は、セキュリティの価格です。* - [セキュリティ管理に関する10の不変法](/previous-versions/cc722488(v=technet.10))

監視システム ソリッド イベント ログとは、どのようなセキュリティで保護された Active Directory 設計の重要な部分です。 多くのコンピューター セキュリティ侵害だった場合は、検出早期イベント被害者が該当するイベント ログ監視とアラートを施行します。 独立したレポートは、この結論を長い間サポートができます。 たとえば、 [2009 Verizon データ侵害レポート](http://www.verizonbusiness.com/resources/security/reports/2009_databreach_rp.pdf) 状態。

"イベントの監視とログ分析の明らかな ineffectiveness は引き続きで若干異なります。 検出するための機会があります。調査メモ被害者の 66% をされていたこのようなリソースを分析の違反を検出するには、そのログ内で使用できる十分な証拠であることです。"

一貫性のある弱点は、アクティブなイベント ログの監視がないことは、多くの企業のセキュリティ防御計画に残ります。 [2012 Verizon データが漏洩したレポート](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf) 見つかったこと侵害の 85% は、注意をひく数週間かかりました、被害者の 84% いた違反の証拠がイベント ログに記録します。

## <a name="windows-audit-policy"></a>Windows の監査ポリシー

Microsoft 公式のエンタープライズ サポート ブログへのリンクを次に示します。 これらのブログのコンテンツは、アドバイス、ガイダンス、および監査に関する推奨事項について、Active Directory インフラストラクチャのセキュリティの強化に役立つし、貴重なリソースの設計には、監査ポリシーを提供します。

* [マジックは、グローバル オブジェクト アクセスの監査](/archive/blogs/askds/global-object-access-auditing-is-magic) の構成と呼ばれる高度な監査ポリシーが容易に監査およびしないスクリプトや auditpol.exe を使い分ける必要データの種類を設定するには、Windows 7 および Windows Server 2008 R2 できるようにする追加されたコントロール メカニズムについて説明します。
* [Windows 2008 での変更の監査の概要](/archive/blogs/askds/introducing-auditing-changes-in-windows-2008) -Windows Server 2008 で監査の変更が導入されています。
* [Vista および 2008 でのテクニックの監査を冷却](/archive/blogs/askds/cool-auditing-tricks-in-vista-and-2008) -Windows Vista および Windows Server 2008 の問題のトラブルシューティングまたは環境内で何が起こっているかを確認に使用できるの興味深い監査機能について説明します。
* [Windows Server 2008 および Windows Vista の監査のワンストップ ショップ](/archive/blogs/askds/one-stop-shop-for-auditing-in-windows-server-2008-and-windows-vista) -監査機能、および Windows Server 2008 および Windows Vista に含まれる情報のコンパイルが含まれています。

Windows Server 2008 での監査については、Windows の Windows 8 および Windows Server 2012 では、監査の強化点については、AD DS に関する情報、次のリンクが提供されます。

* [セキュリティ監査の新](/previous-versions/orphan-topics/ws.11/hh849638(v=ws.11)) -新しいセキュリティ監査では、Windows 8 および Windows Server 2012 の機能の概要を説明します。
* [AD DS 監査ステップ バイ ステップ ガイド](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731607(v=ws.10)) -Windows Server 2008 の新しい Active Directory ドメイン サービス (AD DS) の監査機能について説明します。 また、この新しい機能を実装する手順を示します。

### <a name="windows-audit-categories"></a>Windows の監査カテゴリ

Windows Vista および Windows Server 2008 では、前に、Windows には、9 個までの監査ポリシー カテゴリのイベント ログが必要があります。

* アカウント ログオン イベント
* アカウント管理
* ディレクトリ サービスのアクセス
* ログオン イベント
* オブジェクト アクセス
* ポリシーの変更
* 特権の使用
* プロセスの追跡
* システム イベント

これら 9 つの従来の監査カテゴリには、監査ポリシーが構成されています。 各監査ポリシー カテゴリを成功、失敗または成功と失敗に有効にできるイベントです。 次のセクションでは、その説明が含まれています。

#### <a name="audit-policy-category-descriptions"></a>監査ポリシー カテゴリの説明
監査ポリシーのカテゴリには、次の種類のイベント ログ メッセージが有効にします。

##### <a name="audit-account-logon-events"></a>アカウント ログオン イベントの監査
ログオンするか、別のコンピューターが、アカウントの検証に使用されている 1 台のコンピューターからログオフするセキュリティ プリンシパル (ユーザー、コンピューター、またはサービス アカウントなど) の各インスタンスをレポートします。 ドメイン セキュリティ プリンシパルのアカウントがドメイン コント ローラーに対する認証は、[アカウント ログオン イベントが生成されます。 ローカル コンピューター上のローカル ユーザーの認証は、ローカル セキュリティ ログに記録されるログオン イベントを生成します。 アカウント ログオフ イベントは記録されません。

このカテゴリを生成「余分」なので、Windows が頻繁にログオンするアカウントを行わなくても、ローカルおよびリモート コンピューターから通常業務の過程でします。 それでも、セキュリティ計画には、成功とこのを監査するカテゴリの失敗を含める必要があります。

##### <a name="audit-account-management"></a>アカウント管理の監査
この監査設定を使うと、ユーザーとグループの管理を追跡するかどうかを決定します。 たとえば、ユーザーとグループを追跡するユーザーまたはコンピューター アカウント、セキュリティ グループ、または配布グループが作成、変更、または削除します。ユーザーまたはコンピューター アカウントが名前変更、無効になっている、または有効である場合または、ユーザーまたはコンピューターのパスワードが変更されるとします。 ユーザーまたはグループを追加またはその他のグループから削除されるは、イベントを生成できます。

##### <a name="audit-directory-service-access"></a>ディレクトリ サービス アクセスを監査します。

このポリシー設定では、Active Directory オブジェクトにセキュリティ プリンシパルのアクセスを監査する独自の指定したシステム アクセス制御リスト (SACL) がいるかどうかを決定します。 一般に、このカテゴリは、ドメイン コント ローラーでのみ使用する必要があります。 この設定が多数の「ノイズ」を生成する有効な場合、

##### <a name="audit-logon-events"></a>ログオン イベントの監査
ローカル コンピューターに対するローカルのセキュリティ プリンシパルの認証は、ログオン イベントが生成されます。 ログオン イベントは、ローカル コンピューターで実行するドメイン ログオンを記録します。 アカウント ログオフ イベントは生成されません。 ログオン イベントの有効な場合、たくさんの「ノイズ」が生成されますが、セキュリティ監査計画の既定で有効する必要があります。

##### <a name="audit-object-access"></a>オブジェクト アクセスの監査
オブジェクトへのアクセスには、監査を有効に、後で定義済みのオブジェクトにアクセスして (例、Opened、読み取り、Renamed、削除済み]、または終了) ときにイベントを生成できます。 メインの監査カテゴリが有効にした後、管理者に個別に対象のオブジェクトが持つ監査を有効を定義する必要があります。 多くの Windows システム オブジェクトの監査が有効、管理者は、いずれかが定義する前にイベントを生成する通常開始はこのカテゴリを有効にするように搭載されています。

このカテゴリは、非常に「ノイズ」オブジェクト アクセスごとに 5 ~ 10 個のイベントが生成されます。 管理者を初めて使用すると、オブジェクトの監査役に立つ情報を取得することが困難とがあります。 また必要なときにのみ有効する必要があります。

##### <a name="auditing-policy-change"></a>監査ポリシーの変更
このポリシー設定では、ユーザー権利の割り当てのポリシー、Windows ファイアウォールのポリシー、信頼ポリシーまたは監査ポリシーへの変更に対する変更がすべてのインシデントを監査するかどうかを決定します。 このカテゴリは、すべてのコンピューターで有効にする必要があります。 ごくわずかなノイズを生成します。

##### <a name="audit-privilege-use"></a>特権使用の監査

多数のユーザー権限と Windows (たとえば、オペレーティング システムの一部として動作する、バッチ ジョブとしてログオン) のアクセス許可があります。 このポリシー設定では、ユーザー権限、または特権を行使するセキュリティ プリンシパルの各インスタンスを監査するかどうかを決定します。 有効にする多数の「ノイズ」ですが、このカテゴリとは、高度な特権を使用してセキュリティ プリンシパル アカウントの追跡に役立ちます。

##### <a name="audit-process-tracking"></a>プロセス追跡の監査
このポリシー設定では、プログラムのアクティブ化、プロセスの終了、ハンドルの重複、および間接的なオブジェクトへのアクセスなどのイベントの情報を追跡する詳細なプロセスを監査するかどうかを決定します。 悪意のあるユーザーとそれらを使用してプログラムを追跡するため便利です。

設定されている通常のイベントの数が多いを生成プロセス追跡の監査を有効にする **監査しない**します。 ただし、この設定では、開始されたプロセスの詳細なログからの応答中に非常に大きな利点と、起動された時刻を指定できます。 ドメイン コント ローラーとその他の単一ロール インフラストラクチャ サーバーの場合は、このカテゴリは常に安全にすることができます。 1 つのロールのサーバーでは、多くのプロセスが通常各自の作業の実行中にトラフィックを追跡は生成されません。 そのため、発生した場合は、承認されていないイベントをキャプチャが有効にできます。

##### <a name="system-events-audit"></a>システム イベントの監査

システム イベントは、汎用のキャッチ オール カテゴリほとんどであり、コンピューター、そのシステムのセキュリティまたはセキュリティ ログに影響するさまざまなイベントを登録します。 コンピューターのシャット ダウンと再起動、電源障害が発生、システム時刻の変更、認証パッケージの初期化、監査ログ {アマゾン}、偽装問題、および他の一般的なイベントのホストのイベントが含まれています。 一般に、この監査カテゴリを有効にすると、たくさんの「ノイズ」が生成されますが有効にしない推奨する困難な非常に便利なのに十分なイベントが生成されます。

#### <a name="advanced-audit-policies"></a>高度な監査ポリシー

以降では、Windows Vista および Windows Server 2008 は、Microsoft は、各メイン監査カテゴリの下のサブカテゴリを作成することでイベント ログのカテゴリの選択を行う方法を向上します。 サブカテゴリは、はるかに細かい単位の場合よりも主なカテゴリを使用して、それ以外の場合に監査できるようにします。 サブカテゴリを使用すると、特定の主なカテゴリの部分のみを有効にしを使う必要があるない生成するイベントをスキップできます。 各監査ポリシー サブカテゴリは、"成功"、"失敗"、または "成功および失敗" イベントに対して有効にすることができます。

使用可能なすべての監査サブカテゴリの一覧を表示、グループ ポリシー オブジェクトの監査ポリシーの高度なコンテナーを確認または Windows Server 2012、Windows Server 2008 R2、または Windows Server 2008、Windows 8、Windows 7 または Windows Vista を実行している任意のコンピューターでコマンド プロンプトで、次を入力します。

`auditpol /list /subcategory:*`

Windows Server 2012、Windows Server 2008 R2、または Windows 2008 を実行するコンピューターで現在構成されている監査サブカテゴリの一覧を取得するには、次のように入力します。

`auditpol /get /category:*`

次のスクリーン ショットでは、現在の監査ポリシーの一覧を表示する auditpol.exe の例です。

![AD の監視](media/Monitoring-Active-Directory-for-Signs-of-Compromise/SAD_5.gif)

> [!NOTE]
> グループ ポリシーは、すべての有効な監査ポリシーの状態が auditpol.exe は常に正確に報告していません。 参照してください [Windows 7 および 2008 R2 で効果的な監査ポリシーの取得](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731607(v=ws.10)) 詳細です。

各主なカテゴリには、複数のサブカテゴリがあります。 カテゴリ、サブカテゴリは、その機能の説明の一覧を以下に示します。

### <a name="auditing-subcategories-descriptions"></a>監査サブカテゴリの説明
監査ポリシーのサブカテゴリには、次の種類のイベント ログ メッセージが有効にします。

#### <a name="account-logon"></a>アカウント ログオン

##### <a name="credential-validation"></a>資格情報の確認
このサブカテゴリは、ユーザー アカウントのログオン要求を送信する資格情報を検証テストの結果を報告します。 これらのイベントは資格情報の権限のあるコンピューターで発生します。 ドメイン アカウントのドメイン コント ローラーは、ローカル コンピューターでは権限を持つローカル アカウントの場合は、権限があるです。

ドメイン環境でアカウント ログオン イベントのほとんどは、ドメイン アカウントの権限を持つドメイン コント ローラーのセキュリティ ログに記録されます。 ただし、これらのイベントではローカル アカウントを使用してログオンする場合、組織内の他のコンピューターで発生します。

##### <a name="kerberos-service-ticket-operations"></a>[Kerberos サービス チケット操作]
このサブカテゴリは、ドメイン アカウントに対する権限を持つドメイン コント ローラーで Kerberos チケット要求のプロセスによって生成されたイベントを報告します。

##### <a name="kerberos-authentication-service"></a>Kerberos 認証サービス
このサブカテゴリは、Kerberos 認証サービスによって生成されたイベントを報告します。 これらのイベントは資格情報の権限のあるコンピューターで発生します。

##### <a name="other-account-logon-events"></a>その他のアカウント ログオン イベント
このサブカテゴリは、資格情報に、ユーザー アカウントのログオン要求を送信する資格情報の検証や Kerberos チケットに関係なく応答で発生するイベントを報告します。 これらのイベントは資格情報の権限のあるコンピューターで発生します。 ドメイン アカウントのドメイン コント ローラーは、ローカル コンピューターでは権限を持つローカル アカウントの場合は、権限があるです。

ドメイン環境でアカウント ログオン イベントのほとんどは、ドメイン アカウントの権限を持つドメイン コント ローラーのセキュリティ ログに記録されます。 ただし、これらのイベントではローカル アカウントを使用してログオンする場合、組織内の他のコンピューターで発生します。 例を次に含めることができます。

* リモート デスクトップ サービス セッションの切断
* 新しいリモート デスクトップ サービス セッション
* ロックとワークステーションをロック解除
* スクリーン セーバーを呼び出す
* スクリーン セーバーを閉じる
* Kerberos の検出はリプレイ攻撃を Kerberos 要求と同じ情報を 2 回受信
* ユーザーまたはコンピューター アカウントに付与されたワイヤレス ネットワークへのアクセス
* ワイヤード (有線) 802.1 x ネットワーク ユーザーまたはコンピューター アカウントに与えられます

#### <a name="account-management"></a>アカウント管理

##### <a name="user-account-management"></a>ユーザー アカウントの管理
このサブカテゴリのユーザー アカウントを作成、変更、または削除するときなどのユーザー アカウント管理の各イベントを報告します。ユーザー アカウントの名前変更、無効になっている、または有効であります。または、パスワードを設定または変更します。 この監査ポリシー設定を有効にすると、管理者ユーザー アカウントを悪意のある、偶発的なおよび承認済みの作成を検出するイベントの追跡ことができます。

##### <a name="computer-account-management"></a>コンピューター アカウントの管理
このサブカテゴリは、コンピューター アカウントの作成時、変更、削除、名前を変更、無効になっている、または有効になっているなどのコンピュータ アカウントの管理の各イベントを報告します。

##### <a name="security-group-management"></a>セキュリティ グループの管理
このサブカテゴリは、セキュリティ グループを作成、変更、または削除するとき、またはメンバーを追加またはセキュリティ グループから削除する場合など、セキュリティ グループの管理の各イベントを報告します。 この監査ポリシーの設定が有効になっている場合、管理者には、セキュリティ グループのアカウントの作成を悪意のある、偶発的なおよび承認されたを検出イベントの追跡ことができます。

##### <a name="distribution-group-management"></a>配布グループの管理
このサブカテゴリは、配布グループを作成、変更、または削除するとき、またはメンバーを追加または配布グループから削除する場合など、配布グループ管理の各イベントを報告します。 この監査ポリシーの設定が有効になっている場合、管理者には、グループ アカウントの悪意のある、偶発的なおよび承認済みの作成を検出するイベントの追跡ことができます。

##### <a name="application-group-management"></a>アプリケーション グループの管理
このサブカテゴリは、アプリケーション グループを作成、変更、または削除するとき、またはメンバーを追加またはアプリケーション グループから削除する場合など、コンピューターにアプリケーション グループの管理の各イベントを報告します。 この監査ポリシーの設定が有効になっている場合、管理者には、アプリケーション グループのアカウントの悪意のある、偶発的なおよび承認済みの作成を検出するイベントの追跡ことができます。

##### <a name="other-account-management-events"></a>その他のアカウント管理イベント
このサブカテゴリは、その他のアカウント管理イベントを報告します。

#### <a name="detailed-process-tracking"></a>詳細なプロセスの追跡

##### <a name="process-creation"></a>プロセス作成
このサブカテゴリは、プロセスの作成と、ユーザーまたは作成時に使用するプログラムの名前を報告します。

##### <a name="process-termination"></a>プロセスの終了
このサブカテゴリは、プロセスが終了するときに報告します。

##### <a name="dpapi-activity"></a>DPAPI アクティビティ
このサブカテゴリは、暗号化または復号化は、data protection アプリケーション プログラミング インターフェイス (DPAPI) を呼び出すを報告します。 DPAPI を使用して、保存されたパスワードなどの機密情報と重要な情報を保護します。

##### <a name="rpc-events"></a>RPC イベント
このサブカテゴリのレポートのリモート プロシージャは、(RPC) 接続イベントを呼び出します。

#### <a name="directory-service-access"></a>ディレクトリ サービスのアクセス

##### <a name="directory-service-access"></a>ディレクトリ サービスのアクセス
このサブカテゴリは、AD DS オブジェクトにアクセスする場合に報告します。 構成済みの Sacl のオブジェクトのみでは、SACL エントリに一致するようにアクセスすると生成、およびのみである監査イベントを発生します。 これらのイベントは、以前のバージョンの Windows Server ディレクトリ サービス アクセス イベントに似ています。 このサブカテゴリは、ドメイン コント ローラーにのみ適用されます。

##### <a name="directory-service-changes"></a>ディレクトリ サービスを変更します。
このサブカテゴリは、AD DS 内のオブジェクトへの変更を報告します。 報告される変更の種類を作成、変更、移動、およびオブジェクトに対して実行される操作の削除を取り消します。 ディレクトリ サービスの変更の監査、必要に応じて、変更されたオブジェクトの変更されたプロパティの新旧の値を示します。 Sacl を持つオブジェクトだけでは、的に、生成された唯一の SACL エントリに一致するようにアクセスすると、監査イベントを発生します。 一部のオブジェクトとプロパティでは、スキーマ内のオブジェクト クラスに対する設定のために生成される監査イベントは発生しません。 このサブカテゴリは、ドメイン コント ローラーにのみ適用されます。

##### <a name="directory-service-replication"></a>ディレクトリ サービスのレプリケーション
このサブカテゴリは、2 つのドメイン コント ローラー間のレプリケーションの開始し、終了を報告します。

##### <a name="detailed-directory-service-replication"></a>詳細なディレクトリ サービスのレプリケーション
このサブカテゴリは、詳細な情報については、ドメイン コント ローラー間でレプリケートを報告します。 これらのイベントは、ボリュームで非常に高くなることができます。

#### <a name="logonlogoff"></a>ログオン/ログオフ

##### <a name="logon"></a>ログオン
このサブカテゴリは、ユーザーがシステムにログオンしようとしたときに報告します。 これらのイベントは、アクセスされるコンピューターで発生します。 対話型ログオンにこれらのイベントの生成は、ログオンしているコンピューターで発生します。 ネットワーク ログオンでは、共有にアクセスする場所を受け取り、これらのイベントは、アクセスされるリソースをホストするコンピューターで生成します。 この設定が構成した場合、 **監査しない**, が困難またはどのユーザーがアクセスまたは組織のコンピューターにアクセスしようとしたのか判定できなくします。

##### <a name="network-policy-server"></a>ネットワーク ポリシー サーバー
このサブカテゴリは、RADIUS (IAS) とネットワーク アクセス保護 (NAP) のユーザー アクセスの要求によって生成されたイベントを報告します。 これらの要求を指定できます **Grant**, 、**Deny**, 、**破棄**, 、**検疫**, 、**ロック**, 、および **ロックの解除**します。 この設定を監査すると、NPS および IAS サーバー上のレコードが中程度または高いボリュームが発生します。

##### <a name="ipsec-main-mode"></a>IPsec メイン モード
このサブカテゴリは、メイン モード ネゴシエーション中に、インターネット キー交換 (IKE) プロトコルと認証済みインターネット プロトコル (AuthIP) の結果を報告します。

##### <a name="ipsec-extended-mode"></a>IPsec の拡張モード
このサブカテゴリは、拡張モードのネゴシエーション中に、AuthIP の結果を報告します。

##### <a name="other-logonlogoff-events"></a>その他のログオンとログオフ イベント
このサブカテゴリは、その他のログオンとログオフ関連のイベントをリモート デスクトップ サービス セッションの接続が切断し、再接続するには、RunAs を使用して、別のアカウントでプロセスを実行してロックとワークステーションをロック解除などを報告します。

##### <a name="logoff"></a>ログオフ
このサブカテゴリは、ユーザーが、システムをログオフするときに報告します。 これらのイベントは、アクセスされるコンピューターで発生します。 対話型ログオンにこれらのイベントの生成は、ログオンしているコンピューターで発生します。 ネットワーク ログオンでは、共有にアクセスする場所を受け取り、これらのイベントは、アクセスされるリソースをホストするコンピューターで生成します。 この設定が構成した場合、 **監査しない**, が困難またはどのユーザーがアクセスまたは組織のコンピューターにアクセスしようとしたのか判定できなくします。

##### <a name="account-lockout"></a>アカウントのロックアウト
このサブカテゴリは、多数の失敗したログオン試行の結果として、ユーザーのアカウントがロックアウトされた場合に報告します。

##### <a name="ipsec-quick-mode"></a>IPsec クイック モード
このサブカテゴリは、クイック モード ネゴシエーション中に、IKE プロトコルと AuthIP の結果を報告します。

##### <a name="special-logon"></a>特別なログオン
このサブカテゴリは、特別なログオンを使用する場合に報告します。 特別なログオンは、権限を持つ管理者と同じプロセスをより高いレベルに昇格するために使用するログオンです。

#### <a name="policy-change"></a>ポリシーの変更

##### <a name="audit-policy-change"></a>監査ポリシーの変更
このサブカテゴリは、SACL の変更を含む監査ポリシーの変更を報告します。

##### <a name="authentication-policy-change"></a>認証ポリシーの変更
このサブカテゴリは、認証ポリシーの変更を報告します。

##### <a name="authorization-policy-change"></a>承認ポリシーの変更
このサブカテゴリは、(DACL) のアクセス許可の変更を含む承認ポリシーの変更を報告します。

##### <a name="mpssvc-rule-level-policy-change"></a>ルール レベル ポリシーの変更は MPSSVC
このサブカテゴリは、Microsoft Protection Service (MPSSVC.exe) で使用されるポリシー規則の変更を報告します。 このサービスは、Windows ファイアウォールが使用されます。

##### <a name="filtering-platform-policy-change"></a>フィルタ リング プラットフォームのポリシーの変更
このサブカテゴリは、追加および wfp を基盤としてスタートアップ フィルターなどのオブジェクトの削除を報告します。 これらのイベントは、ボリュームで非常に高くなることができます。

##### <a name="other-policy-change-events"></a>その他のポリシーの変更イベント
このサブカテゴリは、他の種類のトラステッド プラットフォーム モジュール (TPM) または暗号化サービス プロバイダーの構成などのセキュリティ ポリシーの変更を報告します。

#### <a name="privilege-use"></a>特権の使用

##### <a name="sensitive-privilege-use"></a>機密性の高い特権の使用
このサブカテゴリの報告時にユーザー アカウントまたはサービスは、機密性の高い特権を使用します。 機密性の高い特権には、次のユーザー権利が含まれていますオペレーティング システムの一部として動作する、ファイルとディレクトリをバックアップ、トークン オブジェクトの作成、プログラムのデバッグ、を委任に対して信頼される、セキュリティ監査の生成、認証後にクライアントを偽装、読み込むデバイス ドライバーをアンロード、監査を管理するコンピューターとユーザーのアカウントとセキュリティ ログを有効にする、ファームウェアの環境値を変更、プロセス レベル トークンを置き換える。、ファイルとディレクトリを復元し、ファイルやその他のオブジェクトの所有権を取得します。 このサブカテゴリを監査すると、大量のイベントが作成されます。

##### <a name="nonsensitive-privilege-use"></a>機密の特権の使用
このサブカテゴリの報告時にユーザー アカウントまたはサービスが機密の特権を使用します。 機密の特権には、次のユーザー権利が含まれています信頼された呼び出し元と資格情報マネージャーにアクセス、ネットワークからこのコンピューターへのアクセス、ドメインにワークステーションを追加、プロセスに対してメモリ クォータを調整する、ローカル ログオンを許可する、リモート デスクトップ サービス経由のログオンを許可する、走査チェックのバイパス、システム時刻の変更、ページファイルの作成、グローバル オブジェクトの作成、永続的な共有オブジェクトの作成、シンボリック リンクを作成。、、ネットワーク経由でコンピューターのアクセスを拒否、バッチ ジョブとしてログオンを拒否する、サービスとしてログオンを拒否する、ローカル ログオンを拒否する、リモート デスクトップ サービス経由のログオンを拒否、リモート システムからシャット ダウンを強制実行、プロセスのワーキング セットの増加、スケジューリング優先順位の繰り上げ、メモリ内のページをロック、バッチ ジョブとしてログオン、サービスとしてログオン、オブジェクト ラベルの変更、ボリュームの保守タスク、単一プロセスのプロファイル、システム パフォーマンスのプロファイルの実行、ドッキング ステーションからコンピューターを削除、シャット ダウン、システムおよびディレクトリ サービスのデータを同期します。 このサブカテゴリを監査すると、非常に大量のイベントが作成されます。

##### <a name="other-privilege-use-events"></a>その他の特権の使用イベント
このセキュリティ ポリシーの設定は現在は使用されません。

#### <a name="object-access"></a>オブジェクト アクセス

##### <a name="file-system"></a>ファイル システム
このサブカテゴリは、ファイル システム オブジェクトがアクセスしたときに報告します。 Sacl でファイル システム オブジェクトのみ的に、生成された唯一の SACL エントリに一致するようにアクセスすると、監査イベントが発生します。 自体は、このポリシー設定のすべてのイベントの監査はされません。 指定したシステム アクセス制御リスト (SACL) をファイル システム オブジェクトにアクセスするユーザーのイベントを監査するかどうかを決定して効果的に監査の有効化を実行します。

オブジェクト アクセスの監査設定が構成した場合、 **成功**, 、監査エントリが生成するたびに、ユーザーは、独自の sacl が指定したオブジェクトを正常にアクセスします。 このポリシー設定が構成した場合、 **エラー**, 、監査エントリをユーザーが独自の sacl が指定したオブジェクトにアクセスするために失敗するたびに生成します。

##### <a name="registry"></a>Registry
このサブカテゴリは、レジストリ オブジェクトがアクセスしたときに報告します。 Sacl を持つレジストリ オブジェクトだけでは、SACL エントリに一致するようにアクセスすると生成、およびのみである監査イベントを発生します。 自体は、このポリシー設定のすべてのイベントの監査はされません。

##### <a name="kernel-object"></a>カーネル オブジェクト
このサブカテゴリは、プロセスとミュー テックスなどのカーネル オブジェクトがアクセスしたときに報告します。 Sacl でカーネル オブジェクトのみ的に、生成された唯一の SACL エントリに一致するようにアクセスすると、監査イベントが発生します。 通常カーネル オブジェクトがのみ与えられます Sacl AuditBaseObjects または AuditBaseDirectories 監査オプションが有効になっている場合。

##### <a name="sam"></a>SAM
このサブカテゴリは、ローカル セキュリティ アカウント マネージャー (SAM) 認証のデータベース オブジェクトがアクセスしたときに報告します。

##### <a name="certification-services"></a>証明書サービス
このサブカテゴリは、証明書サービスの操作が実行されるときに報告します。

##### <a name="application-generated"></a>生成されたアプリケーション
このサブカテゴリは、アプリケーションが Windows のアプリケーション プログラミング インターフェイス (Api) の監査を使用して、監査イベントを生成しようとした場合に報告します。

##### <a name="handle-manipulation"></a>操作を処理します。
このサブカテゴリは、オブジェクトへのハンドルを開くまたは閉じるときに報告します。 Sacl を持つオブジェクトだけを生成し、実行しようとしたハンドルの操作には、SACL のエントリと一致する場合にのみにこれらのイベントが発生します。 操作イベントの処理は (ファイル システムやレジストリなど) に対応するオブジェクトのアクセス サブカテゴリが有効になっているオブジェクトの種類に対してのみ生成されます。

##### <a name="file-share"></a>ファイル共有
このサブカテゴリは、ファイル共有にアクセスする場合に報告します。 自体は、このポリシー設定のすべてのイベントの監査はされません。 指定したシステム アクセス制御リスト (SACL) を持つファイル共有のオブジェクトにアクセスするユーザーのイベントを監査するかどうかを決定して効果的に監査の有効化を実行します。

##### <a name="filtering-platform-packet-drop"></a>フィルタ リング プラットフォームのパケットのドロップ
このサブカテゴリは、Windows フィルタ リング プラットフォーム (WFP) でパケットをドロップしたときに報告します。 これらのイベントは、ボリュームで非常に高くなることができます。

##### <a name="filtering-platform-connection"></a>プラットフォームの接続をフィルター処理
このサブカテゴリは、接続を許可または WFP によってブロックされているときに報告します。 これらのイベントがボリュームに多くなります。

##### <a name="other-object-access-events"></a>その他のオブジェクト アクセス イベント
このサブカテゴリは、他のタスク スケジューラ ジョブ、COM + オブジェクトなどのオブジェクトのアクセスに関連するイベントを報告します。

#### <a name="system"></a>システム

##### <a name="security-state-change"></a>セキュリティ状態の変更
このサブカテゴリは、セキュリティ サブシステムが開始および停止など、システムのセキュリティの状態の変更を報告します。

##### <a name="security-system-extension"></a>システムのセキュリティ拡張機能
このサブカテゴリは、セキュリティ サブシステムによって認証パッケージなどの拡張機能のコードの読み込みを報告します。

##### <a name="system-integrity"></a>システムの整合性
このサブカテゴリは、セキュリティ サブシステムの整合性の違反を報告します。

IPsec ドライバー

このサブカテゴリは、インターネット プロトコル セキュリティ (IPsec) ドライバーのアクティビティを報告します。

##### <a name="other-system-events"></a>他のシステム イベント
このサブカテゴリは、他のシステム イベントを報告します。

詳細については、サブカテゴリの説明を参照してください、 [Microsoft セキュリティ コンプライアンス マネージャー ツール](/previous-versions/tn-archive/cc677002(v=technet.10))します。

各組織は、以前の管理対象のカテゴリとサブカテゴリを確認し、最適な環境に適合するものを有効にする必要があります。 監査ポリシーに対する変更は、実稼働環境で展開する前に常にテストする必要があります。

## <a name="configuring-windows-audit-policy"></a>Windows の監査ポリシーの構成

Windows の監査ポリシーは、グループ ポリシー、auditpol.exe、Api、またはレジストリの編集を使用して設定できます。 ほとんどの企業で監査ポリシーを構成するための推奨事項は、グループ ポリシーまたは auditpol.exe です。 システムの監査ポリシーを設定するには、管理者レベルのアカウントのアクセス許可、または、適切なアクセス許可を委任する必要があります。

> [!NOTE]
> **監査とセキュリティ ログの管理** セキュリティ プリンシパルに権限を与える必要があります (管理者がある、既定では) オブジェクトへのアクセスが監査ファイル、Active Directory のオブジェクト、およびレジストリ キーなどの個々 のリソースのオプションの変更を可能にします。

### <a name="setting-windows-audit-policy-by-using-group-policy"></a>グループ ポリシーを使用して Windows 監査ポリシーの設定

グループ ポリシーを使用して監査ポリシーを設定するには、下にある適切な監査カテゴリの構成 **コンピューターの構成 \windows 設定 \ セキュリティ \ 監査ポリシー** (例から、ローカル グループ ポリシー エディター (gpedit.msc) については次のスクリーン ショットを参照してください)。 各監査ポリシー カテゴリを有効にできる **成功**, 、**エラー**, 、または **成功** や障害イベントです。

![AD の監視](media/Monitoring-Active-Directory-for-Signs-of-Compromise/SAD_6.gif)

高度な監査ポリシーは、Active Directory またはローカル グループ ポリシーを使用して設定できます。 高度な監査ポリシーを設定する構成の下にある適切なサブカテゴリ **コンピューターの構成 \windows 設定 \ セキュリティ \ 監査ポリシー** (例から、ローカル グループ ポリシー エディター (gpedit.msc) については次のスクリーン ショットを参照してください)。 各監査ポリシーサブカテゴリは、**成功**、**失敗**、または**成功**イベントと**失敗**イベントに対して有効にすることができます。

![AD の監視](media/Monitoring-Active-Directory-for-Signs-of-Compromise/SAD_7.gif)

### <a name="setting-windows-audit-policy-using-auditpolexe"></a>Auditpol.exe を使用して Windows 監査ポリシーの設定

Auditpol.exe (Windows の監査ポリシーの設定) には、Windows Server 2008 および Windows Vista で導入されました。 最初に、auditpol.exe のみを使用して、高度な監査ポリシーを設定することでしたが、グループ ポリシーは、Windows Server 2012、Windows Server 2008 R2、または Windows Server 2008、Windows 8 および Windows 7 で使用することができます。

Auditpol.exe は、コマンド ライン ユーティリティです。 構文は次のとおりです。

`auditpol /set /<Category|Subcategory>:<audit category> /<success|failure:> /<enable|disable>`

Auditpol.exe 構文例:

`auditpol /set /subcategory:"user account management" /success:enable /failure:enable`

`auditpol /set /subcategory:"logon" /success:enable /failure:enable`

`auditpol /set /subcategory:"IPSEC Main Mode" /failure:enable`

> [!NOTE]
> Auditpol.exe では、ローカルで高度な監査ポリシーを設定します。 ローカル ポリシーは、Active Directory またはローカル グループ ポリシーと競合する場合のグループ ポリシー設定は通常 auditpol.exe 設定より優先されます。 複数のグループまたはローカル ポリシーの競合が存在する場合 1 つのポリシーが優先されるので (つまりに置き換えてください)。 監査ポリシーによって結合されません。

#### <a name="scripting-auditpol"></a>Auditpol をスクリプト作成

マイクロソフトが提供、 [サンプル スクリプト](https://support.microsoft.com/kb/921469) auditpol.exe コマンドごとに手動で入力する代わりにスクリプトを使用して高度な監査ポリシーを設定する管理者のためです。

**注** グループ ポリシーは常に正確に表示されないすべての有効な監査ポリシーの状態、auditpol.exe は実行されます。 参照してください [Windows 7 および Windows 2008 R2 で効果的な監査ポリシーの取得](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731607(v=ws.10)) 詳細です。

#### <a name="other-auditpol-commands"></a>その他の Auditpol コマンド

保存し、ローカルの監査ポリシーを復元し、その他の監査関連のコマンドを表示するのには、Auditpol.exe を使用できます。 ここでは、その他の **auditpol** コマンドです。

`auditpol /clear`-ローカル監査ポリシーをクリアおよびリセットするために使用されます。

`auditpol /backup /file:<filename>`-現在のローカル監査ポリシーをバイナリファイルにバックアップするために使用されます。

`auditpol /restore /file:<filename>`-以前に保存した監査ポリシーファイルをローカル監査ポリシーにインポートする場合に使用します。

`auditpol /<get/set> /option:<CrashOnAuditFail> /<enable/disable>`-この監査ポリシー設定が有効になっていると、何らかの理由でセキュリティ監査をログに記録できない場合に、システムがすぐに停止します (STOP: C0000244 {Audit Failed} メッセージが表示されます)。 セキュリティ監査ログがいっぱいとセキュリティ ログの指定された保有期間のメソッドは、ログに記録するイベントが通常は、失敗 **イベントを上書きしない** または **日数を過ぎたら**します。 通常、セキュリティ ログのログをより高い保証を必要とされる環境では有効のみです。 有効な場合、管理者必要があります詳細にセキュリティ ログのサイズを監視して必要に応じてログを回転します。 設定することもグループ ポリシーを使用してセキュリティ オプションを変更することによって **監査: セキュリティ監査を記録できない場合にすぐにシステムをシャット ダウン** (既定 = 無効)。

`auditpol /<get/set> /option:<AuditBaseObjects> /<enable/disable>`-この監査ポリシー設定は、グローバルシステムオブジェクトへのアクセスを監査するかどうかを決定します。 このポリシーが有効にすると、ミュー テックス、イベント、セマフォ、および既定のシステム アクセス制御リスト (SACL) で作成される DOS デバイスなどのシステム オブジェクト。 ほとんどの管理者がノイズが多すぎる"、"へのグローバル システム オブジェクトの監査を検討し、それらのみ行うことは悪意のあるハッキングが疑われる場合。 名前付きのオブジェクトには、SACL が与えられます。 監査オブジェクト アクセス監査ポリシー (またはカーネル オブジェクトの監査サブカテゴリ) も有効である場合は、これらのシステム オブジェクトへのアクセスが監査されます。 このセキュリティ設定を構成するときに変更は反映されませんするには、Windows を再起動します。 グローバル システム オブジェクトのセキュリティ オプション、アクセスの監査を変更することで、このポリシーのグループ ポリシーの設定することも (既定 = 無効)。

`auditpol /<get/set> /option:<AuditBaseDirectories> /<enable/disable>`-この監査ポリシー設定は、名前付きカーネルオブジェクト (ミューテックスやセマフォなど) を作成時に Sacl として指定することを指定します。 AuditBaseDirectories は AuditBaseObjects が他のオブジェクトを含むことができないオブジェクトを適用中にコンテナー オブジェクトに影響します。

`auditpol /<get/set> /option:<FullPrivilegeAuditing> /<enable/disable>`-この監査ポリシー設定は、1つまたは複数の特権がユーザーのセキュリティトークンに割り当てられたときに、クライアントがイベントを生成するかどうかを指定します: 割り当て Primarytokenprivilege、AuditPrivilege、BackupPrivilege、CreateTokenPrivilege、DebugPrivilege、EnableDelegationPrivilege、ImpersonatePrivilege、LoadDriverPrivilege、RestorePrivilege、SecurityPrivilege、SystemTakeOwnershipPrivilege このオプションが有効になっていない場合 (既定 = 無効)、BackupPrivilege および RestorePrivilege の特権は記録されません。 このオプションを有効にすると、バックアップ操作中に (場合によって数百ものイベントを 2 回目)、セキュリティ ログを非常にノイズことができます。 セキュリティ オプションを変更することで、このポリシーのグループ ポリシーの設定することも **監査: バックアップと復元の特権の使用の監査**します。

> [!NOTE]
> ここで指定したいくつかの情報を Microsoft から取得した [監査オプションの種類](/openspecs/windows_protocols/ms-gpac/262a2bed-93d4-4c04-abec-cf06e9ec72fd) と Microsoft SCM ツールです。

## <a name="enforcing-traditional-auditing-or-advanced-auditing"></a>従来の監査または高度な監査を適用します。

Windows Server 2012、Windows Server 2008 R2、Windows Server 2008、Windows 8、Windows 7 および Windows Vista での管理者は、従来の 9 つのカテゴリを有効にするか、サブカテゴリを使用する選択できます。 各 Windows システムで作成する必要がありますバイナリを選択することをお勧めします。 主なカテゴリを有効にするか、subcategoriesit はどちらにすることはできません。

レガシ従来カテゴリ ポリシーが監査ポリシーのサブカテゴリを上書きしないように、させる必要があります、 **監査ポリシーのサブカテゴリを強制 (Windows Vista またはそれ以降) をポリシー カテゴリの監査設定をオーバーライドする** の下にあるポリシー設定 **コンピューターの構成 \windows の設定 \ セキュリティ \ セキュリティ オプション**します。

サブカテゴリが有効になっているおよび 9 つの主なカテゴリではなく構成できることをお勧めします。 これには、監査ポリシーをサポートするさまざまなサブカテゴリを構成すると共に場合は、グループ ポリシーの設定 (サブカテゴリ監査カテゴリのオーバーライドを許可する) に対応が必要です。

グループ ポリシーやコマンド ライン プログラム、auditpol.exe など、いくつかの方法では、サブカテゴリの監査を構成できます。

## <a name="next-steps"></a>次のステップ

* [監査と Windows Server 2008 でのコンプライアンス](/previous-versions/technet-magazine/cc194392(v=msdn.10))

* [グループ ポリシーを使用して、詳細なセキュリティが Windows Server 2008 ドメイン、Windows Server 2003 ドメイン、または Windows 2000 ドメインでは、Windows Vista および Windows Server 2008 ベースのコンピューターの監査設定を構成する方法](https://support.microsoft.com/kb/921469)

* [セキュリティ監査ポリシーのステップ バイ ステップ ガイドの詳細](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd408940(v=ws.10))
