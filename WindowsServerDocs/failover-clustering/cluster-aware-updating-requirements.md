---
ms.assetid: 75cc1d24-fa2f-45bd-8f3b-1bbd4a1aead0
title: クラスター対応更新の要件とベストプラクティス
ms.prod: windows-server
ms.topic: article
ms.manager: dongill
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 08/06/2018
description: クラスター対応更新を使用して、Windows Server を実行しているクラスターに更新プログラムをインストールするための要件。
ms.openlocfilehash: 501969fad2455195bca485bd8124911d6d75378e
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/27/2019
ms.locfileid: "71361323"
---
# <a name="cluster-aware-updating-requirements-and-best-practices"></a>クラスター対応更新の要件とベストプラクティス

>適用対象:Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

このセクションでは、[クラスター対応更新](cluster-aware-updating.md)(CAU) を使用して、Windows Server を実行しているフェールオーバークラスターに更新プログラムを適用するために必要な要件と依存関係について説明します。

> [!NOTE]  
> **Microsoft.windowsupdateplugin**以外のプラグ @ no__t を使用している場合は、クラスター環境で更新を適用する準備が整っているかどうかを個別に検証する必要があります。 @ No__t-0Microsoft プラグ @ no__t-1 を使用している場合、詳細については、発行元にお問い合わせください。 プラグイン @ no__t の詳細については、「[プラグ @ no__t-2ins のしくみ](cluster-aware-updating-plug-ins.md)」を参照してください。   

## <a name="BKMK_REQ_CLUS"></a>フェールオーバークラスタリング機能とフェールオーバークラスタリングツールをインストールする  
CAU を利用するには、フェールオーバー クラスタリング機能とフェールオーバー クラスタリング ツールをインストールする必要があります。 フェールオーバークラスタリングツールには、-0clusterawareupdating @ no__t、フェールオーバークラスタリングコマンドレット、CAU 操作に必要なその他のコンポーネントの CAU ツール @no__t が含まれています。 フェールオーバー クラスタリング機能のインストール手順については、「 [フェールオーバー クラスタリング機能とツールのインストール](create-failover-cluster.md#install-the-failover-clustering-feature)」をご覧ください。  

フェールオーバークラスタリングツールのインストール要件は、CAU がフェールオーバー @no__t クラスター上でクラスター化された役割として更新を調整するかどうかによって、自己 @ no__t 更新モード @ no__t-2 を使用するか、リモートコンピューターから行うかによって異なります。 CAU の self @ no__t-0updating モードでは、cau ツールを使用して、フェールオーバークラスターに CAU のクラスター化された役割をインストールする必要もあります。    

次の表は、2 つの CAU 更新モードの CAU 機能インストール要件をまとめたものです。  

|インストールされているコンポーネント|Self @ no__t-0updating モード|Remote @ no__t-0updating モード|  
|-----------------------|-----------------------|-------------------------|  
|フェールオーバー クラスタリング機能|すべてのクラスター ノードで必要|すべてのクラスター ノードで必要|  
|フェールオーバー クラスタリング ツール|すべてのクラスター ノードで必要|-リモート @ no__t でコンピューターを更新する必要があります。<br />- [Save-caudebugtrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps)コマンドレットを実行するすべてのクラスターノードで必要|  
|CAU のクラスター化された役割|必須|不要|  

## <a name="obtain-an-administrator-account"></a>管理者アカウントの取得  
CAU 機能を使用するには、次の管理者要件が必要です。  

-   CAU ユーザーインターフェイス @no__t 0UI @ no__t またはクラスター対応更新のコマンドレットを使用して更新アクションをプレビューまたは適用するには、すべてのクラスターノードに対してローカル管理者権限とアクセス許可を持つドメインアカウントを使用する必要があります。 アカウントにすべてのノードに対する十分な特権がない場合、これらの操作を実行するときに必要な資格情報を提供するために、クラスター対応更新ウィンドウでメッセージが表示されます。 [クラスター対応更新](https://docs.microsoft.com/powershell/module/clusterawareupdating/?view=win10-ps)のコマンドレットを使用するには、コマンドレットパラメーターとして必要な資格情報を指定します。  

-   クラスターノードのローカル管理者権限とアクセス許可を持たないアカウントを使用してサインインしたときに、リモートの @ no__t-0updating モードで CAU を使用する場合は、更新プログラムのローカル管理者アカウントを使用して、CAU ツールを管理者として実行する必要があります。コーディネーターコンピューター。または、 **[認証後にクライアントを偽装]** ユーザー権限を持つアカウントを使用します。 

-   CAU ベストプラクティスアナライザーを実行するには、クラスターノードで管理者特権を持ち、 [test-causetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps)コマンドレットの実行またはクラスター更新の分析に使用されるコンピューターのローカル管理者特権を持つアカウントを使用する必要があります。クラスター対応更新ウィンドウを使用した準備。 詳細については、「 [クラスター更新の準備のテスト](#BKMK_BPA)」を参照してください。  

## <a name="verify-the-cluster-configuration"></a>クラスター構成の検証  
次は、CAU による更新をサポートするためのフェールオーバー クラスターの一般要件です。 ノードのリモート管理の追加構成要件はこのトピックの後半の「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」にあります。  

-   クラスターの定足数が確保されるだけ十分な数のクラスター ノードがオンラインになっている必要があります。  

-   すべてのクラスター ノードが同じ Active Directory ドメインにある必要があります。  

-   クラスター名は DNS を利用し、ネットワーク上で解決する必要があります。  

-   CAU がリモートの @ no__t-0updating モードで使用されている場合、更新コーディネーターコンピューターは、フェールオーバークラスターノードへのネットワーク接続を保持している必要があります。また、フェールオーバークラスターと Active Directory 同じドメインにある必要があります。  

-   すべてのクラスター ノードでクラスター サービスを実行している必要があります。 既定では、このサービスはすべてのクラスター ノードにインストールされ、自動的に開始するように構成されています。  

-   CAU 更新実行中に PowerShell pre @ no__t-0update または post @ no__t-1update スクリプトを使用するには、すべてのクラスターノードにスクリプトがインストールされていること、または可用性の高いネットワークファイル共有上のすべてのノードからアクセス可能であることを確認してください。 スクリプトがネットワーク ファイル共有に保存される場合、Everyone グループの読み取りアクセスのフォルダーを構成します。  

## <a name="BKMK_NODE_CONFIG"></a>リモート管理のノードの構成  
クラスター対応更新を使用するには、クラスターのすべてのノードがリモート管理用に構成されている必要があります。 既定では、リモート管理のためにノードを構成するために実行する必要があるタスクは、[ファイアウォール規則で自動再起動を有効](#BKMK_FW)にすることだけです。 

次の表に、環境が既定値から逸脱した場合の完全なリモート管理要件を示します。

これらの要件は、「 [フェールオーバー クラスタリング機能とフェールオーバー クラスタリング ツールのインストール](#BKMK_REQ_CLUS) 」のイントール要件と本トピックの前のセクションで説明した一般的なクラスタリング要件に追加されるものです。  

|要件|既定の状態|Self @ no__t-0updating モード|Remote @ no__t-0updating モード|  
|---------------|---|-----------------------|-------------------------|  
|[自動再起動を許可するファイアウォール規則を有効にする](#BKMK_FW)|Disabled|ファイアウォールが使用される場合にすべてのクラスター ノードで必要|ファイアウォールが使用される場合にすべてのクラスター ノードで必要|  
|[Windows Management Instrumentation を有効にする](#BKMK_WMI)|有効|すべてのクラスター ノードで必要|すべてのクラスター ノードで必要|  
|[Windows PowerShell 3.0 または4.0 と Windows PowerShell リモート処理を有効にする](#BKMK_PS)|有効|すべてのクラスター ノードで必要|次を実行するすべてのクラスター ノードで必要:<br /><br />- [Save-caudebugtrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps)コマンドレット<br />-更新実行中の PowerShell pre @ no__t-0update と post @ no__t-1update スクリプト<br />-クラスター対応更新ウィンドウまたは[テスト @ no__t-1CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) Windows PowerShell コマンドレットを使用して、クラスター更新の準備のテストを行います。|  
|[.NET Framework 4.6 または4.5 のインストール](#BKMK_NET)|有効|すべてのクラスター ノードで必要|次を実行するすべてのクラスター ノードで必要:<br /><br />- [Save-caudebugtrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps)コマンドレット<br />-更新実行中の PowerShell pre @ no__t-0update と post @ no__t-1update スクリプト<br />-クラスター対応更新ウィンドウまたは[テスト @ no__t-1CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) Windows PowerShell コマンドレットを使用して、クラスター更新の準備のテストを行います。|  

### <a name="BKMK_FW"></a>自動再起動を許可するファイアウォール規則を有効にする  
更新プログラムが適用された後に自動再起動を許可するには \(: 更新プログラムのインストールで @ no__t-1 を再起動する必要がある場合は、Windows ファイアウォールまたは非 @ no__t がクラスターノードで使用されている場合は、ファイアウォール規則を各ノードで有効にする必要があります。次のトラフィック:  

-   プロトコル:TCP  

-   方向: 受信  

-   プログラム: wininit.exe  

-   ポート:RPC 動的ポート  

-   プロファイル:[ドメイン]  

Windows ファイアウォールをクラスター ノードで使用する場合、クラスター ノードごとに **[リモート シャットダウン]** Windows ファイアウォール規則グループを有効にします。 クラスター対応更新ウィンドウを使用して更新プログラムを適用し、self @ no__t-0updating オプションを構成すると、各クラスターノードで **[リモートシャットダウン]** Windows ファイアウォール規則グループが自動的に有効になります。  

> [!NOTE]  
> Windows ファイアウォールのグループ ポリシー設定と競合する場合、 **Remote Shutdown** Windows ファイアウォール規則グループは有効になりません。    

次の CAU コマンドレットを実行する場合は、 **– EnableFirewallRules**パラメーターを指定して、**リモートシャットダウン**ファイアウォール規則グループを有効にすることもできます。[Add-cauclusterrole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole?view=win10-ps)、 [Invoke-caurun](https://docs.microsoft.com/powershell/module/clusterawareupdating/Invoke-CauRun?view=win10-ps)、および[SetCauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Set-CauClusterRole?view=win10-ps)。  

次の PowerShell の例は、クラスターノードで自動再起動を有効にするための追加の方法を示しています。  

```PowerShell  
Set-NetFirewallRule -Group "@firewallapi.dll,-36751" -Profile Domain -Enabled true  
```  

### <a name="BKMK_WMI"></a>Windows Management Instrumentation を有効にする (WMI) 
Windows Management Instrumentation @no__t 0WMI @ no__t-1 を使用して、すべてのクラスターノードがリモート管理用に構成されている必要があります。 これは既定で有効になっています。  

リモート管理を手動で有効にするには、次のように操作します。  

1.  サービス コンソールで、 **[Windows リモート管理]** サービスを開始し、起動タイプを **[自動]** に設定します。  

2.  [Set-wsmanquickconfig](https://docs.microsoft.com/powershell/module/Microsoft.WsMan.Management/Set-WSManQuickConfig?view=powershell-6)コマンドレットを実行するか、管理者特権でのコマンドプロンプトから次のコマンドを実行します。  

    ```PowerShell  
    winrm quickconfig -q  
    ```  

WMI リモート処理をサポートするには、Windows ファイアウォールがクラスターノードで使用されている場合は、各ノードで**Windows リモート管理 \( http @ no__t-2in**受信ファイアウォール規則を有効にする必要があります。  既定では、この規則は有効になっています。  

### <a name="BKMK_PS"></a>Windows PowerShell と Windows PowerShell のリモート処理を有効にする  
Self @ no__t-0updating モードとリモート @ no__t 更新モードの特定の CAU 機能を有効にするには、すべてのクラスターノードでリモートコマンドを実行できるように PowerShell をインストールして有効にする必要があります。 既定では、PowerShell がインストールされており、リモート処理が有効になっています。  

PowerShell リモート処理を有効にするには、次のいずれかの方法を使用します。  

-   [Enable-psremoting](https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Core/Enable-PSRemoting)コマンドレットを実行します。  

-   Windows リモート管理 \(WinRM @ no__t のドメイン @ no__t-0level グループポリシー設定を構成します。  

PowerShell リモート処理の有効化の詳細については、「[リモート要件につい](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_remote_requirements?view=powershell-6)て」を参照してください。  

### <a name="BKMK_NET"></a>.NET Framework 4.6 または4.5 のインストール  
Self @ no__t-0updating モードと、remote @ no__t 更新モードの特定の CAU 機能 (Windows Server 2012 R2 の場合) を有効にして、すべてのクラスターノードにインストールする必要があり 4.5 .NET Framework 4.6 ます。 既定では、NET Framework がインストールされています。  

まだインストールされていない場合に PowerShell を使用して .NET Framework 4.6 (または 4.5) をインストールするには、次のコマンドを使用します。

```PowerShell
Install-WindowsFeature -Name NET-Framework-45-Core
```

## <a name="BKMK_BEST_PRAC"></a>クラスター対応更新を使用するためのベストプラクティスの推奨事項 

### <a name="BKMK_BP_WUA"></a>Microsoft 更新プログラムの適用に関する推奨事項

クラスターの既定の**microsoft.windowsupdateplugin**プラグ @ no__t に更新プログラムを適用するために CAU を使用する場合は、他の方法を使用して microsoft からのソフトウェア更新プログラムをクラスターノードにインストールすることを停止することをお勧めします。  

> [!CAUTION]  
> 個々のノードを自動的 @no__t に更新するメソッドと CAU を組み合わせることによって、固定された時間スケジュール @ no__t では、予期しない結果が発生する可能性があります。これには、サービスの中断や予定外のダウンタイムなどがあります。  

次のガイドラインに従うことをお勧めします。  

-   最適な結果を得るために、たとえば、コントロール パネルの自動更新設定やグループ ポリシーを利用して構成される設定を利用し、クラスター ノードの自動更新設定を無効にすることをお勧めします。  

    > [!CAUTION]  
    > クラスター ノードの更新の自動インストールが CAU による更新のインストールに干渉し、CAU にエラーが発生することがあります。  

    必要であれば、次の自動更新設定が CAU と共存します。管理者が更新インストールのタイミングを制御できるためです。  

    -   更新のダウンロード前に通知するための設定とインストール前に通知するための設定  

    -   更新を自動的にダウンロードするための設定とインストール前に通知するための設定  

    ただし、自動更新が CAU 更新実行と同時に更新をダウンロードする場合、更新実行の完了に時間がかかることがあります。  

-   更新プログラムを自動的に適用するように Windows Server Update Services \(WSUS @ no__t-1 などの更新システムは、固定された時間スケジュール @ no__t-3 でクラスターノードに @no__t 自動的に適用するように構成しないでください。  

-   WSUS サーバー、Windows 更新、マイクロソフト更新など、同じ更新元を利用するように、すべてのクラスター ノードを等しく構成する必要があります。  

-   構成管理システムを使用してネットワーク上のコンピューターにソフトウェア更新を適用する場合は、必要な更新または自動更新からクラスター ノードを除外してください。 構成管理システムの例として、Microsoft System Center Configuration Manager 2007 や Microsoft System Center Virtual Machine Manager 2008 があります。  

-   内部のソフトウェア配布サーバーが @no__t 場合、たとえば、WSUS サーバー @ no__t を使用して更新プログラムを格納および展開する場合は、それらのサーバーがクラスターノードに対して承認された更新プログラムを正しく識別するようにします。  

#### <a name="BKMK_PROXY"></a>ブランチオフィスシナリオでの Microsoft 更新プログラムの適用  
特定の支店シナリオで Microsoft Update または Windows Update からクラスター ノードにマイクロソフト更新をダウンロードするには、ノードごとに、ローカル システム アカウントのプロキシ設定を構成する必要があります。 たとえば、支店のクラスターがローカル プロキシ サーバーを利用し、Microsoft Update または Windows Update にアクセスして更新をダウンロードする場合にこの作業が必要になります。  

必要に応じて、各ノードの WinHTTP プロキシ設定を構成してローカルプロキシサーバーを指定し、ローカルアドレスの @no__t 例外 (ローカルアドレス @ no__t のバイパスリスト) を構成します。 その場合、管理者特権のコマンド プロンプトでクラスター ノードごとに次のコマンドを実行できます。  

```  
netsh winhttp set proxy <ProxyServerFQDN >:<port> "<local>"  
```  

ここで <*Proxyserverfqdn*> はプロキシサーバーの完全修飾ドメイン名、<*ポート*> は通信に使用するポート (通常はポート 443) です。  

たとえば、プロキシサーバー *MyProxy.CONTOSO.com*を指定するローカルシステムアカウントの WinHTTP プロキシ設定を構成するには、ポート443とローカルアドレス例外を指定し、次のコマンドを入力します。  

```  
netsh winhttp set proxy MyProxy.CONTOSO.com:443 "<local>"  
```  

### <a name="BKMK_BP_HF"></a>Microsoft.hotfixplugin を使用するための推奨事項  

-   修正プログラムのルート フォルダーと構成ファイルにアクセス許可を設定し、これらのファイルの保管に使用されるコンピューターに対してローカル管理者にのみ書き込みアクセスを許可することをお勧めします。 それにより、無許可のユーザーがこれらのファイルを改ざんし、修正プログラムの適用時にフェールオーバー クラスターの機能を損なうような事態を防止できます。  

-   修正プログラムルートフォルダーへのアクセスに使用されるサーバーメッセージブロック \(SMB @ no__t 接続のデータの整合性を確保するために、smb 共有フォルダーで SMB 暗号化を構成できる場合は、smb 暗号化を構成する必要があります。 **Microsoft.HotfixPlugin** を利用するには、SMB 接続のデータ完全性を維持するように SMB 署名または SMB 暗号化を構成する必要があります。 

    詳細については、「[修正プログラムルートフォルダーと修正プログラムの構成ファイルへのアクセスを制限する](cluster-aware-updating-plug-ins.md#BKMK_ACL)」を参照してください。

### <a name="additional-recommendations"></a>追加の推奨事項  

-   同じ時間にスケジュールされる可能性がある CAU 更新実行を邪魔しないように、スケジュールされている保守管理時間帯にクラスター名オブジェクトと仮想コンピューター オブジェクトにパスワード変更をスケジュールしないでください。  

-   許可されていないユーザーによってこれらのファイルが改ざんされるのを防ぐために、@ no__t-0update に対する適切なアクセス許可を設定し、ネットワーク共有フォルダーに保存される @ no__t-1update スクリプトを投稿する必要があります。  

-   Self @ no__t-0updating モードで CAU を構成するには、CAU のクラスター化された役割の仮想コンピューターオブジェクト \(VCO @ no__t-2 を Active Directory で作成する必要があります。 CAU は、フェールオーバー クラスターに十分なアクセス許可があれば、CAU のクラスター化された役割が追加された時点でこのオブジェクトを自動的に作成できます。 ただし、一部の組織ではセキュリティ ポリシーにより、Active Directory にオブジェクトを事前登録する必要があります。 この手順については、「 [クラスター化された役割のアカウントを事前登録するための手順](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731002\(v=ws.10\)#steps-for-prestaging-the-cluster-name-account)」をご覧ください。  

-   IT 組織内で同様に更新する必要があるフェールオーバー クラスター全体に更新実行設定を保存し、再利用するために、更新実行プロファイルを作成できます。 また、更新モードにもよりますが、すべてのリモート Update Coordinator コンピューターまたはフェールオーバー クラスターにアクセスできるファイル共有に更新実行プロファイルを保存し、管理できます。 詳細については、「 [CAU の詳細オプションと更新実行プロファイル](cluster-aware-updating-options.md)」を参照してください。  

## <a name="BKMK_BPA"></a>クラスター更新の準備のテスト  
CAU ベストプラクティスアナライザー \(BPA @ no__t モデルを実行して、フェールオーバークラスターとネットワーク環境が、CAU によってソフトウェア更新プログラムを適用するために必要な多くの要件を満たしているかどうかをテストできます。 テストの多くは、 **microsoft.windowsupdateplugin**の既定のプラグ @ no__t を使用して、microsoft 更新プログラムを適用する準備が環境にあるかどうかを確認します。  

> [!NOTE]  
> 場合によっては、 **microsoft.windowsupdateplugin**以外のプラグ @ no__t を使用して、クラスター環境でソフトウェア更新プログラムを適用する準備が整っているかどうかを個別に検証する必要があります。 ハードウェアの製造元から提供されているものなど、@ no__t ~ 0Microsoft プラグ @ no__t を使用している場合は、詳細について、発行元にお問い合わせください。  

BPA は次の 2 通りの方法で実行できます。  

1.  CAU コンソールで **[クラスター更新の準備の分析]** を選択します。 BPA が準備テストを完了すると、テストレポートが表示されます。 クラスター ノードで問題が検出された場合、是正措置をとれるように、具体的な問題と問題が発生したノードが特定されます。 テストの完了には数分かかることがあります。  

2.  [Test-causetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup)コマンドレットを実行します。 このコマンドレットは、Windows PowerShell のフェールオーバークラスタリングモジュール (フェールオーバークラスタリングツールの一部) がインストールされているローカルまたはリモートコンピューターで実行できます。 フェールオーバー クラスターのノードでもコマンドレットを実行できます。  

> [!NOTE]  
> -   クラスターノードに対する管理者特権を持ち、**テスト @ no__t**コマンドレットの実行に使用するコンピューターのローカル管理者特権を持つアカウントを使用するか、クラスター対応のを使用してクラスター更新の準備を分析する必要があります。ウィンドウを更新しています。 クラスター対応更新ウィンドウを使用してテストを実行するには、必要な資格情報を使用してコンピューターにログオンしている必要があります。  
> -   このテストでは、ソフトウェア更新をプレビューし、適用するために使用される CAU ツールは、クラスター更新の準備をテストするために使用されるコンピューターと同じコンピューターから、同じユーザー資格情報で実行するものと想定しています。  

> [!IMPORTANT]  
> 次の状況でクラスター更新の準備をテストすることをお勧めします。  
>   
> -   初めて CAU を利用してソフトウェア更新を適用する前。  
> -   クラスターにノードを追加したか、クラスターの検証ウィザードの実行を必要とする他のハードウェア変更をクラスターで実行した後。  
> -   更新プログラムのソースを変更した後、または更新プログラムの設定または構成を変更した後に、ノードの更新プログラムの適用に影響する可能性がある CAU @ no__t-1 以外の @no__t。  

### <a name="tests-for-cluster-updating-readiness"></a>クラスター更新の準備のテスト  
次の表は、クラスター更新の準備のテスト、一部の共通問題、解消手順についてまとめたものです。  


|                                                      テスト                                                      |                                                                                                                                               考えられる問題と影響                                                                                                                                               |                                                                                                                                                                                         解消手順                                                                                                                                                                                         |
|----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                     フェールオーバー クラスターを利用できる必要があります                                     |                                                                                       フェールオーバー クラスター名を解決できません。または、1 つまたは複数のノードにアクセスできません。 BPA がクラスターの準備テストを実行できません。                                                                                        |                                                                   -BPA 実行中に指定されたクラスターの名前のスペルを確認します。<br />-クラスターのすべてのノードがオンラインで実行されていることを確認します。<br />-構成の検証ウィザードがフェールオーバークラスターで正常に実行できることを確認します。                                                                    |
|                    WMI を利用し、フェールオーバー クラスター ノードのリモート管理を有効にする必要があります                    |                                                Windows Management Instrumentation @no__t 0WMI @ no__t-1 を使用して、1つまたは複数のフェールオーバークラスターノードのリモート管理が有効になっていません。 ノードのリモート管理が構成されていない場合、CAU はクラスター ノードを更新できません。                                                 |                                                                                                  WMI を利用し、すべてのフェールオーバー クラスター ノードのリモート管理を有効にします。 詳細については、「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」を参照してください。                                                                                                   |
|                      各フェールオーバークラスターノードで PowerShell リモート処理を有効にする必要があります。                       |                                                           PowerShell がインストールされていないか、1つまたは複数のフェールオーバークラスターノードでリモート処理が有効になっていません。 CAU は、自己 @ no__t-0updating モード用に構成することも、remote @ no__t 更新モードで特定の機能を使用することもできません。                                                            |                                                                                             PowerShell がすべてのクラスターノードにインストールされ、リモート処理が有効になっていることを確認してください。<br /><br />詳細については、「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」を参照してください。                                                                                             |
|                                            フェールオーバー クラスター バージョン                                            |                                                                            フェールオーバークラスターの1つまたは複数のノードで、Windows Server 2016、Windows Server 2012 R2、または Windows Server 2012 が実行されていません。 CAU がフェールオーバー クラスターを更新できません。                                                                             |                                                                   BPA 実行中に指定されたフェールオーバークラスターが、Windows Server 2016、Windows Server 2012 R2、または Windows Server 2012 を実行していることを確認します。<br /><br />詳細については、「 [クラスター構成の検証](#BKMK_REQ_CLUS) 」を参照してください。                                                                   |
| 必須バージョンの .NET Framework と Windows PowerShell をすべてのフェールオーバー クラスター ノードにインストールする必要があります |                                                                                              .NET Framework 4.6、4.5、または Windows PowerShell が1つ以上のクラスターノードにインストールされていません。 一部の CAU 機能が動作しないことがあります。                                                                                              |                                                                            必要に応じて、すべてのクラスターノードに .NET Framework 4.6、4.5、および Windows PowerShell がインストールされていることを確認します。<br /><br />詳細については、「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」を参照してください。                                                                             |
|                           クラスター サービスがすべてのクラスター ノードで実行されている必要があります                           |                                                                                                            クラスター サービスが 1 つまたは複数のノードで実行されていません。 CAU がフェールオーバー クラスターを更新できません。                                                                                                             |                        -クラスターサービス @no__t 0clussvc @ no__t がクラスター内のすべてのノードで開始されていることと、自動的に開始するように構成されていることを確認してください。<br />-構成の検証ウィザードがフェールオーバークラスターで正常に実行できることを確認します。<br /><br />詳細については、「 [クラスター構成の検証](#BKMK_REQ_CLUS) 」を参照してください。                         |
|     フェールオーバー クラスター ノードに更新を自動インストールするように自動更新を構成してはなりません     |                                           少なくとも 1 つのクラスター ノードで、そのノードにマイクロソフト更新を自動インストールするように自動更新が構成されています。 CAU とその他の更新方法を組み合わせると、予期しないダウンタイムまたは予測できない結果を招くことがあります。                                            |                                                     1 つまたは複数のクラスター ノードで Windows Update 機能の自動更新が構成されている場合、更新を自動インストールするように自動更新が構成されていないことを確認します。<br /><br />詳細については、「 [マイクロソフト更新適用の推奨事項](#BKMK_BP_WUA)」を参照してください。                                                     |
|                          フェールオーバー クラスター ノードは同じ更新元を使用する必要があります                          |                                                    1 つまたは複数のクラスター ノードで、残りのノードとは異なる更新元がマイクロソフト更新に使用されるように構成されています。 CAU では、クラスター ノードに更新が等しく適用されない可能性があります。                                                    |                                                                        WSUS サーバー、Windows Update、Microsoft Update など、同じ更新元を使用するようにすべてのクラスター ノードが構成されていることを確認します。<br /><br />詳細については、「 [マイクロソフト更新適用の推奨事項](#BKMK_BP_WUA)」を参照してください。                                                                         |
|       リモート シャットダウンを許可するファイアウォール規則をフェールオーバー クラスターの各ノードで有効にする必要があります       |                 1 つまたは複数のフェールオーバー クラスター ノードで、リモート シャットダウンを許可するファイアウォール規則が有効になっていないか、グループ ポリシー設定によりこの規則の有効化が阻止されています。 ノードの自動再起動を要求する更新を適用する更新実行が適切に完了しないことがあります。                  |                                                                    クラスターノードで Windows ファイアウォールまたは非 @ no__t-0Microsoft ファイアウォールが使用されている場合は、リモートシャットダウンを許可するファイアウォール規則を構成します。<br /><br />詳細については、「 [自動再起動を許可するファイアウォール規則の有効化](#BKMK_FW) 」を参照してください。                                                                    |
|          各フェールオーバー クラスター ノードのプロキシ サーバー設定をローカル プロキシ サーバーに設定する必要があります          |                             1 つまたは複数のフェールオーバー クラスター ノードのプロキシ サーバー構成が正しくありません。<br /><br />ローカル プロキシ サーバーが使用されている場合、クラスターが Microsoft Update または Windows Update にアクセスできるように、各ノードのプロキシ サーバー設定を適切に構成する必要があります。                              |                                            必要に応じて各クラスター ノードの WinHTTP プロキシ設定がローカル プロキシ サーバーに設定されていることを確認します。 環境内でプロキシ サーバーが使用されていない場合、この警告は無視できます。<br /><br />詳細については、「 [Apply updates in branch office scenarios](#BKMK_PROXY) 」を参照してください。                                            |
|        自己 @ no__t-0updating モードを有効にするには、CAU のクラスター化された役割をフェールオーバークラスターにインストールする必要があります        |                                                                                                   CAU のクラスター化された役割がこのフェールオーバー クラスターにインストールされていません。 このロールは、クラスターの self @ no__t 更新に必要です。                                                                                                   |      自己 @ no__t-0updating モードで CAU を使用するには、次のいずれかの方法で、フェールオーバークラスターに CAU のクラスター化された役割を追加します。<br /><br />- [Add-cauclusterrole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole) PowerShell コマンドレットを実行します。<br />-クラスター対応更新ウィンドウで、 **[クラスターの自己 @ no__t 更新オプションを構成する]** アクションを選択します。      |
|         自己 @ no__t-0updating モードを有効にするには、フェールオーバークラスターで CAU のクラスター化された役割を有効にする必要があります         | CAU のクラスター化された役割が無効になっています。 たとえば、CAU のクラスター化された役割がインストールされていないか、 [Disable @ no__t-1CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Disable-CauClusterRole) PowerShell コマンドレットを使用して無効になっています。 このロールは、クラスターの self @ no__t 更新に必要です。 | 自己 @ no__t-0updating モードで CAU を使用するには、次のいずれかの方法で、このフェールオーバークラスターで CAU のクラスター化された役割を有効にします。<br /><br />- [Add-cauclusterrole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Enable-CauClusterRole) PowerShell コマンドレットを実行します。<br />-クラスター対応更新ウィンドウで、 **[クラスターの自己 @ no__t 更新オプションを構成する]** アクションを選択します。 |
|      自己 @ no__t 更新モード用に構成された CAU プラグ @ no__t-0in、すべてのフェールオーバークラスターノードに登録する必要があります      |                                                              このフェールオーバークラスターの1つまたは複数のノードでの CAU のクラスター化された役割は、self @ no__t-1updating オプションで構成された CAU プラグ @ no__t-0in モジュールにアクセスできません。 自己 @ no__t-0updating の実行が失敗する可能性があります。                                                              |           -CAU プラグ @ no__t を提供する製品のインストール手順に従って、構成済みの CAU プラグ @ no__t-0in すべてのクラスターノードにインストールされていることを確認します。<br />- [Register @ no__t-1CauPlugin](https://docs.microsoft.com/powershell/module/clusterawareupdating/Register-CauPlugin) PowerShell コマンドレットを実行して、必要なクラスターノードにプラグイン @ no__t-2in 登録します。           |
|                すべてのフェールオーバークラスターノードには、同じ登録済み CAU プラグ @ no__t のセットが含まれている必要があります。                 |                                                                             更新実行で使用するように構成されているプラグ @ no__t が、すべてのクラスターノードで使用できないものに変更された場合、self @ no__t-0updating 実行は失敗する可能性があります。                                                                              |           -CAU プラグ @ no__t を提供する製品のインストール手順に従って、構成済みの CAU プラグ @ no__t-0in すべてのクラスターノードにインストールされていることを確認します。<br />- [Register @ no__t-1CauPlugin](https://docs.microsoft.com/powershell/module/clusterawareupdating/Register-CauPlugin) PowerShell コマンドレットを実行して、必要なクラスターノードにプラグイン @ no__t-2in 登録します。           |
|                               構成された更新実行オプションを有効にする必要があります                                |                                                                          このフェールオーバークラスター用に構成されている self @ no__t-0updating スケジュールと更新実行オプションが不完全であるか、無効です。 自己 @ no__t-0updating の実行が失敗する可能性があります。                                                                           |                                                            有効な self @ no__t 更新スケジュールと更新実行オプションのセットを構成します。 たとえば、 [Set @ no__t-1CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Set-CauClusterRole) PowerShell コマンドレットを使用して、CAU のクラスター化された役割を構成できます。                                                            |
|                  少なくとも 2 つのフェールオーバー クラスター ノードが CAU のクラスター化された役割の実行可能な所有者になる必要があります                  |                                                                                        CAU のクラスター化された役割に移動先として使用可能な所有者ノードがないため、self @ no__t-0updating モードで起動した更新実行は失敗します。                                                                                         |                                                                                                                フェールオーバー クラスタリング ツールを使用し、すべてのクラスター ノードが CAU のクラスター化された役割の実行可能な所有者として構成されていることを確認します。 これは既定の構成です。                                                                                                                |
|                  すべてのフェールオーバー クラスター ノードは Windows PowerShell スクリプトにアクセスできる必要があります                  |                                                                        CAU のクラスター化された役割のすべての実行可能な所有者ノードが、構成済みの Windows PowerShell pre @ no__t-0update および post @ no__t-1update スクリプトにアクセスできるわけではありません。 自己 @ no__t-0updating 実行は失敗します。                                                                        |                                                                                                                    CAU のクラスター化された役割のすべての実行可能な所有者ノードが、構成済みの PowerShell pre @ no__t-0update および post @ no__t-1update スクリプトにアクセスするためのアクセス許可を持っていることを確認します。                                                                                                                     |
|                   すべてのフェールオーバー クラスター ノードで同じ Windows PowerShell スクリプトを使用する必要があります                   |                                                     CAU のクラスター化された役割のすべての実行可能な所有者ノードが、指定された Windows PowerShell pre @ no__t-0update および post @ no__t-1update スクリプトの同じコピーを使用しているわけではありません。 自己 @ no__t-0updating 実行が失敗したり、予期しない動作が表示されたりすることがあります。                                                     |                                                                                                                                   CAU のクラスター化された役割のすべての実行可能な所有者ノードで、同じ PowerShell pre @ no__t-0update と post @ no__t-1update スクリプトが使用されていることを確認します。                                                                                                                                   |
|         更新実行で、WarnAfter 設定には StopAfter 設定より小さい値を指定する必要があります         |                                                                           指定されている CAU 更新実行タイムアウト値は警告タイムアウトを無効にします。 警告イベント ログが生成される前に更新実行が取り消される可能性があります。                                                                            |                                                                                                                                      更新実行オプションで、 **[WarnAfter]** オプションの値に **[StopAfter]** オプションの値よりも小さい値を指定します。                                                                                                                                       |

## <a name="see-also"></a>関連項目  

-   [クラスター対応更新の概要](cluster-aware-updating.md)