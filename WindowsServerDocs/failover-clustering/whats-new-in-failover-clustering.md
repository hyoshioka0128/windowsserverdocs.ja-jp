---
ms.assetid: 350aa5a3-5938-4921-93dc-289660f26bad
title: Windows Server でのフェールオーバークラスタリングの新機能
ms.prod: windows-server
ms.technology: storage-failover-clustering
ms.topic: get-started-article
manager: lizross
author: JasonGerend
ms.author: jgerend
ms.date: 10/18/2018
ms.openlocfilehash: 431854f2e063454124092151c6788263db57b5f2
ms.sourcegitcommit: 568b924d32421256f64abfee171304f1daf320d2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/18/2020
ms.locfileid: "85070153"
---
# <a name="whats-new-in-failover-clustering"></a>フェールオーバー クラスタリングの新機能

> 適用先:Windows Server 2019、Windows Server 2016

このトピックでは、Windows Server 2019 および Windows Server 2016 のフェールオーバークラスタリングの新機能と変更された機能について説明します。

## <a name="whats-new-in-windows-server-2019"></a>Windows Server 2019 の新機能

- **クラスター セット**

    クラスターセットを使用すると、単一のソフトウェア定義データセンター (SDDC) ソリューション内のサーバーの数を、クラスターの現在の制限を超えて増やすことができます。 これは、複数のクラスターをクラスターセットにグループ化することで実現されます。これは、複数のフェールオーバークラスター (コンピューティング、記憶域、およびハイパー収束) の疎結合グループです。
    クラスターセットを使用すると、クラスターセット内のクラスター間でオンライン仮想マシン (ライブマイグレーション) を移動できます。

    詳細については、「[クラスターセット](../storage/storage-spaces/cluster-sets.md)」を参照してください。

- **Azure 対応のクラスター**
  
    フェールオーバークラスターは、Azure IaaS 仮想マシンで実行されている時間を自動的に検出し、構成を最適化して、最高レベルの可用性を実現するために、Azure の計画済みメンテナンスイベントのプロアクティブなフェールオーバーとログ記録を実現します。 また、クラスター名の動的ネットワーク名を使用してロードバランサーを構成する必要がないため、展開も簡略化されます。

- **ドメイン間のクラスター移行**

    フェールオーバークラスターは、1つの Active Directory ドメインから別のドメインに動的に移動できるようになりました。ドメインの統合を簡略化し、後で顧客のドメインに参加させることができます。

- **USB 監視**

    ネットワークスイッチに接続されているシンプルな USB ドライブを、クラスターのクォーラムを決定するためのミラーリング監視サーバーとして使用できるようになりました。 これにより、ファイル共有監視が拡張され、SMB2 に準拠している任意のデバイスがサポートされるようになります。

- **クラスター インフラストラクチャの機能強化**

    CSV キャッシュは、仮想マシンのパフォーマンスを向上させるために既定で有効になりました。 MSDTC では、クラスター共有ボリュームがサポートされるようになりました。これにより、SQL Server の使用など、MSDTC のワークロードを記憶域スペース ダイレクトに展開できます。 ロジックが強化され、パーティション分割されたノードを検出して、自動修復でノードをクラスター メンバーシップに戻すことができるようになりました。 クラスター ネットワーク ルート検出と自動修復機能が強化されています。

- **クラスター対応更新による記憶域スペース ダイレクトのサポート**

    クラスター対応更新 (CAU) が記憶域スペース ダイレクトに対応して統合され、データ再同期の検証と確認が各ノードで完了するようになりました。 クラスター対応更新は、必要な場合にのみインテリジェントに再起動するように更新を検査します。 これにより、計画されたメンテナンスのために、クラスター内のすべてのサーバーの再起動を調整できます。

- **ファイル共有監視の強化**

    次のシナリオでは、ファイル共有監視の使用が有効になりました。
  - リモートの場所が原因でインターネットにアクセスできない、または極端に低い場合は、クラウドミラーリング監視サーバーの使用を禁止します。
  - ディスク監視用の共有ドライブが不足しています。 これは、記憶域スペースダイレクトハイパー集約型構成、SQL Server Always On 可用性グループ (AG)、または * Exchange Database 可用性グループ (DAG) であり、共有ディスクを使用していない可能性があります。
  - クラスターが DMZ の背後にあるため、ドメインコントローラー接続がありません。
  - Active Directory クラスター名オブジェクト (CNO) がないワークグループまたはクロスドメインクラスター。 これらの機能強化の詳細については、サーバー & 管理のブログの記事「フェールオーバークラスターファイル共有監視と DFS」を参照してください。

    また、DFS 名前空間の共有の使用を場所として明示的にブロックしています。 ファイル共有監視を DFS 共有に追加すると、クラスターで安定性の問題が発生し、この構成がサポートされなくなることがあります。 共有が DFS 名前空間を使用するかどうかを検出するロジックを追加しました。 DFS 名前空間が検出された場合、フェールオーバークラスターマネージャーはミラーリング監視サーバーの作成をブロックし、サポートされていないことを通知するエラーメッセージを表示します。

- **クラスターの強化**

    サーバー メッセージ ブロック (SMB) を使用した、クラスター共有ボリュームと記憶域スペース ダイレクトに対するクラスター内通信では、証明書を活用して最も安全なプラットフォームが提供されるようになりました。 これにより、フェールオーバー クラスターが依存関係なしで NTLM で動作し、セキュリティ ベースラインが有効になります。

- **フェールオーバー クラスターで使用されなくなった NTLM 認証**

    フェールオーバークラスターは、NTLM 認証を使用しなくなりました。 代わりに、Kerberos と証明書ベースの認証のみが使用されます。 このセキュリティ強化を利用するために、ユーザーまたは展開ツールで必要な変更はありません。 また、NTLM が無効になっている環境にフェールオーバークラスターを配置することもできます。

## <a name="whats-new-in-windows-server-2016"></a>Windows Server 2016 の新機能

### <a name="cluster-operating-system-rolling-upgrade"></a><a name="BKMK_RollingUpgrade"></a>Cluster Operating System Rolling Upgrade (クラスター オペレーティング システムのローリング アップグレード)

クラスターオペレーティングシステムのローリングアップグレードを使用すると、管理者は、Hyper-v またはスケールアウトファイルサーバーワークロードを停止せずに、クラスターノードのオペレーティングシステムを Windows Server 2012 R2 から新しいバージョンにアップグレードできます。 この機能を使用すると、サービス レベル アグリーメント (SLA) でのダウンタイムに対するペナルティを回避できます。

**この変更の利点**  

Hyper-v またはスケールアウトファイルサーバークラスターを Windows Server 2012 R2 から Windows Server 2016 にアップグレードすると、ダウンタイムは不要になります。 クラスターは、クラスター内のすべてのノードが Windows Server 2016 を実行している間、引き続き Windows Server 2012 R2 レベルで機能します。 クラスターの機能レベルは、windows PowerShell のコマンドレットを使用して windows Server 2016 にアップグレードされ `Update-ClusterFunctionalLevel` ます。

> [!WARNING]  
> - クラスターの機能レベルを更新した後は、Windows Server 2012 R2 クラスターの機能レベルに戻ることはできません。
>
> - `Update-ClusterFunctionalLevel`コマンドレットが実行されるまで、プロセスは元に戻せません。また、Windows server 2012 R2 ノードを追加したり、Windows server 2016 ノードを削除したりすることができます。

**動作の相違点**  

Hyper-v またはスケールアウトファイルサーバーフェールオーバークラスターは、ダウンタイムなしで簡単にアップグレードできるようになりました。また、Windows Server 2016 オペレーティングシステムを実行しているノードで新しいクラスターを構築する必要もありません。 クラスターを Windows Server 2012 R2 に移行するには、既存のクラスターをオフラインにし、各ノードの新しいオペレーティングシステムを再インストールしてから、クラスターをオンラインに戻します。 古いプロセスは煩雑であり、ダウンタイムが必要でした。 ただし、Windows Server 2016 では、クラスターはどの時点でもオフラインにする必要がありません。

フェーズでのアップグレードのクラスターオペレーティングシステムは、クラスター内の各ノードについて次のようになります。  
-   ノードが一時停止し、そのノードで実行されているすべての仮想マシンがドレインされます。 
-   仮想マシン (またはその他のクラスターワークロード) は、クラスター内の別のノードに移行されます。 
-   既存のオペレーティングシステムが削除され、ノードに Windows Server 2016 オペレーティングシステムのクリーンインストールが実行されます。 
-   Windows Server 2016 オペレーティングシステムを実行しているノードがクラスターに再び追加されます。 
-   この時点では、クラスターノードが Windows Server 2012 R2 または Windows Server 2016 を実行しているため、クラスターは混在モードで実行されていると言います。 
-   クラスターの機能レベルは、Windows Server 2012 R2 で維持されます。 この機能レベルでは、以前のバージョンのオペレーティングシステムとの互換性に影響する Windows Server 2016 の新機能は使用できなくなります。 
-   最終的には、すべてのノードが Windows Server 2016 にアップグレードされます。 
-   その後、Windows PowerShell コマンドレットを使用して、クラスターの機能レベルが Windows Server 2016 に変更され `Update-ClusterFunctionalLevel` ます。 この時点で、Windows Server 2016 の機能を利用できます。 

詳細については、「[クラスターオペレーティングシステムのローリングアップグレード](cluster-operating-system-rolling-upgrade.md)」を参照してください。 

### <a name="storage-replica"></a><a name="BKMK_SR"></a>記憶域レプリカ  
記憶域レプリカは、障害復旧のために、サーバー間またはクラスター間で記憶域に依存しないブロックレベルの同期レプリケーションを可能にする新機能であり、サイト間でフェールオーバークラスターを拡張することもできます。 同期レプリケーションは、クラッシュ前後の整合性が維持されるボリュームを使用した物理サイト内のデータのミラーリングを実現して、ファイル システム レベルでデータがまったく失われないようにします。 非同期レプリケーションでは、データが失われる可能性はありますが、大都市圏の範囲を超えてサイトを拡張できます。 

**この変更の利点**  

記憶域レプリカを使用すると、次の操作を実行できます。  

-   ミッション クリティカルなワークロードの計画的な停止および想定外の停止のために単一ベンダー障害回復ソリューションを提供する。 

-   信頼性、スケーラビリティ、パフォーマンスの点で実証済みの SMB3 トランスポートを使用する。 

-   大都市圏の距離まで Windows フェールオーバー クラスターを拡大する。 

-   Hyper-v、記憶域レプリカ、記憶域スペース、クラスター、スケールアウトファイルサーバー、SMB3、データ重複除去、ReFS/NTFS などの記憶域とクラスタリングには、Microsoft ソフトウェアエンドツーエンドを使用します。 

-   次のように、コストと複雑さの軽減に役立てる。  

    -   ハードウェアに依存せず、DAS、SAN などの特定の記憶域構成が不要です。 

    -   汎用的な記憶域やネットワーク テクノロジを使用できます。 

    -   フェールオーバー クラスター マネージャーを通じて個々のノードとクラスターをグラフィカルに簡単に管理できます。 

    -   Windows PowerShell を使った包括的な大規模なスクリプト作成オプションを組み込みます。 

-   ダウンタイムを短縮し、Windows に備わっている信頼性と生産性の向上に役立てる。 

-   サポート性、パフォーマンス メトリック、および診断機能を提供する。 

詳細については、[Windows Server 2016 での記憶域レプリカ](../storage/storage-replica/storage-replica-overview.md)に関する記事を参照してください。 

### <a name="cloud-witness"></a><a name="BKMK_CloudWitness"></a>クラウド監視

クラウド監視は、Windows Server 2016 の新しい種類のフェールオーバー クラスター クォーラム監視で、Microsoft Azure が判別ポイントとして利用されます。 クラウド監視は、他のクォーラム監視と同様、票を集めるため、クォーラム計算に参加できます。 クラウド監視をクォーラム監視として構成するには、クラスター クォーラムの構成ウィザードを使用します。 

**この変更の利点**  

クラウド監視をフェールオーバークラスタークォーラム監視として使用すると、次のような利点があります。  

-   Microsoft Azure を活用し、3番目の独立したデータセンターを必要としないようにします。 

-   では、パブリッククラウドでホストされている Vm の追加のメンテナンスオーバーヘッドを排除する、一般公開されている標準の Microsoft Azure Blob Storage を使用します。 

-   複数のクラスターに同じ Microsoft Azure Storage アカウントを使用できます (クラスターごとに1つの blob ファイル、blob ファイル名として使用されるクラスターの一意の id)。 

-   ストレージアカウントに対するコストが非常に低くなります (blob ファイルごとに書き込まれたデータは非常に小さいため、blob ファイルはクラスターノードの状態が変化したときに1回だけ更新されます)。 

詳細については、「[フェールオーバークラスターのクラウド監視をデプロイする](deploy-cloud-witness.md)」を参照してください。 

**動作の相違点**  

この機能は Windows Server 2016 での新規です。 

### <a name="virtual-machine-resiliency"></a><a name="BKMK_VMs"></a>仮想マシンの回復性

**コンピューティングの回復性**Windows Server 2016 には、次のように計算クラスターでクラスター内の通信の問題を軽減するために、仮想マシンのコンピューティングの回復性が強化されています。 

-   **仮想マシンで使用できる回復性オプション:** 一時的な障害時に仮想マシンの動作を定義する仮想マシンの回復性オプションを構成できるようになりました。  

    -   **回復性レベル:** 一時的なエラーの処理方法を定義するのに役立ちます。 

    -   **回復性の期間:** すべての仮想マシンを分離して実行できる期間を定義するのに役立ちます。 

-   **異常なノードの検疫:** 異常なノードは検疫され、クラスターへの参加は許可されなくなりました。 これにより、フラッピングノードが他のノードやクラスター全体に悪影響を及ぼすのを防ぐことができます。 

詳細については、「 [Windows Server 2016 の仮想マシンの計算](https://blogs.msdn.com/b/clustering/archive/2015/06/03/10619308.aspx)の回復性」を参照してください。仮想マシンの回復性のワークフローとノードの検疫の設定によって、ノードの配置方法が制御されます。 

**記憶域の回復性**Windows Server 2016 では、一時的な記憶域の障害に対する仮想マシンの回復性が向上しています。 仮想マシンの回復性が強化されたため、記憶域の中断が発生した場合にテナント仮想マシンのセッション状態を維持することができます。 これは、記憶域インフラストラクチャの問題に対するインテリジェントで迅速な仮想マシンの応答によって実現されます。 

仮想マシンは、基になる記憶域から切断されると、一時停止し、記憶域の回復を待機します。 一時停止中、仮想マシンは、その中で実行されているアプリケーションのコンテキストを保持します。 バーチャルマシンのストレージへの接続が復元されると、バーチャルマシンは実行中の状態に戻ります。 その結果、テナントコンピューターのセッション状態は回復時に保持されます。 

Windows Server 2016 では、仮想マシンの記憶域の回復性が認識され、ゲストクラスターに最適化されています。 

### <a name="diagnostic-improvements-in-failover-clustering"></a><a name="BKMK_Diagnostics"></a>フェールオーバークラスタリングの診断の機能強化

フェールオーバークラスターに関する問題を診断するために、Windows Server 2016 には次のものが含まれています。  

- フェールオーバークラスタリングの問題のトラブルシューティングを容易にする、クラスターログファイル (タイムゾーン情報、DiagnosticVerbose ログなど) に対するいくつかの機能強化。 詳細については、「 [Windows Server 2016 フェールオーバークラスターのトラブルシューティングの機能強化-クラスターログ](https://techcommunity.microsoft.com/t5/failover-clustering/windows-server-2016-failover-cluster-troubleshooting/ba-p/372005)」を参照してください。

- 新しいダンプの種類で、仮想マシンに割り当てられているほとんどのメモリページを**フィルターで除外**します。これにより、memory.dmp がはるかに小さく、保存やコピーが容易になります。 詳細については、「 [Windows Server 2016 フェールオーバークラスターのトラブルシューティングの機能強化-アクティブダンプ](https://techcommunity.microsoft.com/t5/failover-clustering/windows-server-2016-failover-cluster-troubleshooting/ba-p/372008)」を参照してください。

### <a name="site-aware-failover-clusters"></a><a name="BKMK_SiteAware"></a>サイト認識フェールオーバー クラスター

Windows Server 2016 には、物理的な場所 (サイト) に基づいて拡張されたクラスター内のグループノードを有効にする、サイト対応のフェールオーバークラスターが含まれています。 クラスターサイト認識は、フェールオーバーの動作、配置ポリシー、ノード間のハートビート、クォーラムの動作など、クラスターのライフサイクル中の重要な操作を強化します。 詳細については、「 [Windows Server 2016 のサイト対応フェールオーバークラスター](https://techcommunity.microsoft.com/t5/failover-clustering/site-aware-failover-clusters-in-windows-server-2016/ba-p/372060)」を参照してください。

### <a name="workgroup-and-multi-domain-clusters"></a><a name="BKMK_multidomainclusters"></a>ワークグループ クラスターとマルチドメイン クラスター

Windows Server 2012 R2 以前のバージョンでは、同じドメインに参加しているメンバーノード間にのみクラスターを作成できます。 Windows Server 2016 では、この障壁が取り除かれて、Active Directory の依存関係のないフェールオーバー クラスターを作成する機能が導入されています。 次の構成でフェールオーバークラスターを作成できるようになりました。  

-   **単一ドメインクラスター。** すべてのノードが同じドメインに参加しているクラスター。 

-   **マルチドメインクラスター。** 異なるドメインのメンバーであるノードを持つクラスター。 

-   **ワークグループクラスター。** メンバーサーバーまたはワークグループ (ドメインに参加していない) のノードを持つクラスター。 

詳細については、「 [Windows Server 2016 のワークグループおよびマルチドメインクラスター](https://techcommunity.microsoft.com/t5/failover-clustering/workgroup-and-multi-domain-clusters-in-windows-server-2016/ba-p/372059) 」を参照してください。

### <a name="virtual-machine-load-balancing"></a><a name="BKMK_VMLoadBalancing"></a>仮想マシンの負荷分散  

仮想マシンの負荷分散は、クラスター内のノード間での仮想マシンのシームレスな負荷分散を容易にする、フェールオーバークラスタリングの新機能です。 過剰コミットされたノードは、ノード上の仮想マシンのメモリと CPU 使用率に基づいて識別されます。 仮想マシンは、過剰コミットされたノードから使用可能な帯域幅を持つノード (該当する場合) に移動 (ライブマイグレーション) されます。 クラスターのパフォーマンスと使用率が最適になるように、分散の強度を調整することができます。 Windows Server 2016 Technical Preview では、負荷分散は既定で有効になっています。 ただし、SCVMM 動的最適化が有効になっている場合、負荷分散は無効になります。 

### <a name="virtual-machine-start-order"></a><a name="BKMK_VMStartOrder"></a>バーチャルマシンの開始順序

仮想マシンの開始順序は、フェールオーバークラスタリングの新機能であり、クラスター内の仮想マシン (およびすべてのグループ) の開始順序オーケストレーションが導入されています。 仮想マシンを複数の層にグループ化できるようになり、開始順序の依存関係を異なる層間で作成できるようになりました。 これにより、最も重要な仮想マシン (ドメインコントローラーやユーティリティ仮想マシンなど) が最初に起動されるようになります。 仮想マシンは、依存している仮想マシンも起動されるまで開始されません。 

### <a name="simplified-smb-multichannel-and-multi-nic-cluster-networks"></a><a name="BKMK_SMBMultiChannel"></a>簡略化された SMB マルチチャネルとマルチ NIC クラスターネットワーク

フェールオーバークラスターネットワークは、サブネット/ネットワークごとに1つの NIC に限定されなくなりました。 簡略化された SMB マルチチャネルとマルチ NIC クラスターネットワークを使用すると、ネットワーク構成が自動的に実行され、サブネット上のすべての NIC をクラスターおよびワークロードのトラフィックに使用できます。 この機能強化により、お客様は、Hyper-v、SQL Server フェールオーバークラスターインスタンス、およびその他の SMB ワークロードのネットワークスループットを最大化することができます。 

詳細については、「簡略化された[SMB マルチチャネルとマルチ NIC クラスターネットワーク](smb-multichannel.md)」を参照してください。

## <a name="see-also"></a>参照

* [ストレージ](../storage/storage.yml)  
* [Windows Server 2016 の記憶域の新機能](../storage/whats-new-in-storage.md)  
